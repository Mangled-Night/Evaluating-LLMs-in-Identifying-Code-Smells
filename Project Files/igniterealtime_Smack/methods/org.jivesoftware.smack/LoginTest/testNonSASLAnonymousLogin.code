/** 
 * Check that the server handles anonymous users correctly.
 */
public void testNonSASLAnonymousLogin(){
  if (!isTestAnonymousLogin())   return;
  try {
    ConnectionConfiguration config=new ConnectionConfiguration(getHost(),getPort());
    config.setSASLAuthenticationEnabled(false);
    XMPPTCPConnection conn1=new XMPPConnection(config);
    conn1.connect();
    config=new ConnectionConfiguration(getHost(),getPort());
    config.setSASLAuthenticationEnabled(false);
    XMPPTCPConnection conn2=new XMPPConnection(config);
    conn2.connect();
    try {
      conn1.loginAnonymously();
      conn2.loginAnonymously();
      assertNotNull("Resource is null",StringUtils.parseResource(conn1.getUser()));
      assertNotNull("Resource is null",StringUtils.parseResource(conn2.getUser()));
      assertNotNull("Username is null",StringUtils.parseName(conn1.getUser()));
      assertNotNull("Username is null",StringUtils.parseName(conn2.getUser()));
    }
 catch (    XMPPException e) {
      fail(e.getMessage());
    }
    conn1.disconnect();
    conn2.disconnect();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}
