/** 
 * Register soft input changed listener.
 * @param activity The activity.
 * @param listener The soft input changed listener.
 */
public static void registerSoftInputChangedListener(@NonNull final Activity activity,@NonNull final OnSoftInputChangedListener listener){
  registerSoftInputChangedListener(activity.getWindow(),listener);
}
/** 
 * Register soft input changed listener.
 * @param window The window.
 * @param listener The soft input changed listener.
 */
public static void registerSoftInputChangedListener(@NonNull final Window window,@NonNull final OnSoftInputChangedListener listener){
  final int flags=window.getAttributes().flags;
  if ((flags & WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS) != 0) {
    window.clearFlags(WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS);
  }
  final FrameLayout contentView=window.findViewById(android.R.id.content);
  final int[] decorViewInvisibleHeightPre={getDecorViewInvisibleHeight(window)};
  OnGlobalLayoutListener onGlobalLayoutListener=new OnGlobalLayoutListener(){
    @Override public void onGlobalLayout(){
      int height=getDecorViewInvisibleHeight(window);
      if (decorViewInvisibleHeightPre[0] != height) {
        listener.onSoftInputChanged(height);
        decorViewInvisibleHeightPre[0]=height;
      }
    }
  }
;
  contentView.getViewTreeObserver().addOnGlobalLayoutListener(onGlobalLayoutListener);
  contentView.setTag(TAG_ON_GLOBAL_LAYOUT_LISTENER,onGlobalLayoutListener);
}
