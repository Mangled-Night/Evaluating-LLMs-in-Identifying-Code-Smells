private static File[] listFilesSafely(File file) throws IOException {
  if (file.exists()) {
    File[] files=file.listFiles();
    if (files == null) {
      throw new IOException("Failed to list files for dir: " + file);
    }
    return files;
  }
 else {
    return new File[0];
  }
}
