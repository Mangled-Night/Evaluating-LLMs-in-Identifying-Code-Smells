@Test public void testSortingEmptyArrays() throws Exception {
  final UnsafeExternalSorter sorter=newSorter();
  sorter.insertRecord(null,0,0,0);
  sorter.insertRecord(null,0,0,0);
  sorter.spill();
  sorter.insertRecord(null,0,0,0);
  sorter.spill();
  sorter.insertRecord(null,0,0,0);
  sorter.insertRecord(null,0,0,0);
  UnsafeSorterIterator iter=sorter.getSortedIterator();
  for (int i=1; i <= 5; i++) {
    iter.loadNext();
    assertEquals(0,iter.getKeyPrefix());
    assertEquals(0,iter.getRecordLength());
  }
  sorter.cleanupResources();
  assertSpillFilesWereCleanedUp();
}
