/** 
 * Class that represents an OpenPGP message. The content of this elements text is an base64 encoded , OpenPGP encrypted/signed content element ( {@link SignElement}, {@link SigncryptElement},  {@link CryptElement}).
 * @see <a href="https://xmpp.org/extensions/xep-0373.html#exchange">
 *     XEP-0373: ยง3.1 Exchanging OpenPGP Encrypted and Signed Data</a>
 */
public class OpenPgpElement implements ExtensionElement {
  public static final String ELEMENT="openpgp";
  public static final String NAMESPACE="urn:xmpp:openpgp:0";
  public static final QName QNAME=new QName(NAMESPACE,ELEMENT);
  private final String base64EncodedOpenPgpMessage;
  public OpenPgpElement(  String base64EncodedOpenPgpMessage){
    this.base64EncodedOpenPgpMessage=StringUtils.requireNotNullNorEmpty(base64EncodedOpenPgpMessage,"base64 encoded message MUST NOT be null nor empty.");
  }
  public InputStream toInputStream(){
    return new ByteArrayInputStream(Base64.decode(base64EncodedOpenPgpMessage.getBytes(Util.UTF8)));
  }
  /** 
 * Return the OpenPGP encrypted payload.
 * @return OpenPGP encrypted payload.
 */
  public String getEncryptedBase64MessageContent(){
    return base64EncodedOpenPgpMessage;
  }
  @Override public String getElementName(){
    return ELEMENT;
  }
  @Override public String getNamespace(){
    return NAMESPACE;
  }
  @Override public QName getQName(){
    return QNAME;
  }
  @Override public XmlStringBuilder toXML(  org.jivesoftware.smack.packet.XmlEnvironment enclosingNamespace){
    XmlStringBuilder xml=new XmlStringBuilder(this);
    xml.rightAngleBracket().append(base64EncodedOpenPgpMessage).closeElement(this);
    return xml;
  }
  public static OpenPgpElement fromStanza(  Stanza stanza){
    return stanza.getExtension(OpenPgpElement.class);
  }
}
