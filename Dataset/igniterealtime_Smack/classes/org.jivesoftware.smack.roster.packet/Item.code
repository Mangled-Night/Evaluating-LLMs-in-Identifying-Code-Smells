/** 
 * A roster item, which consists of a JID, their name, the type of subscription, and the groups the roster item belongs to.
 */
public static final class Item implements ExtensionElement {
  /** 
 * The constant value " {@value}".
 */
  public static final String ELEMENT=Stanza.ITEM;
  public static final QName QNAME=new QName(NAMESPACE,ELEMENT);
  public static final String GROUP="group";
  private final BareJid jid;
  /** 
 * TODO describe me. With link to the RFC. Is ask= attribute.
 */
  private boolean subscriptionPending;
  private String name;
  private ItemType itemType=ItemType.none;
  private boolean approved;
  private final Set<String> groupNames;
  /** 
 * Creates a new roster item.
 * @param jid TODO javadoc me please
 * @param name TODO javadoc me please
 */
  public Item(  BareJid jid,  String name){
    this(jid,name,false);
  }
  /** 
 * Creates a new roster item.
 * @param jid the jid.
 * @param name the user's name.
 * @param subscriptionPending TODO javadoc me please
 */
  public Item(  BareJid jid,  String name,  boolean subscriptionPending){
    this.jid=Objects.requireNonNull(jid);
    this.name=name;
    this.subscriptionPending=subscriptionPending;
    groupNames=new CopyOnWriteArraySet<>();
  }
  @Override public String getElementName(){
    return QNAME.getLocalPart();
  }
  @Override public String getNamespace(){
    return QNAME.getNamespaceURI();
  }
  /** 
 * Returns the user.
 * @return the user.
 * @deprecated use {@link #getJid()} instead.
 */
  @Deprecated public String getUser(){
    return jid.toString();
  }
  /** 
 * Returns the JID of this item.
 * @return the JID.
 */
  public BareJid getJid(){
    return jid;
  }
  /** 
 * Returns the user's name.
 * @return the user's name.
 */
  public String getName(){
    return name;
  }
  /** 
 * Sets the user's name.
 * @param name the user's name.
 */
  public void setName(  String name){
    this.name=name;
  }
  /** 
 * Returns the roster item type.
 * @return the roster item type.
 */
  public ItemType getItemType(){
    return itemType;
  }
  /** 
 * Sets the roster item type.
 * @param itemType the roster item type.
 */
  public void setItemType(  ItemType itemType){
    this.itemType=Objects.requireNonNull(itemType,"itemType must not be null");
  }
  public void setSubscriptionPending(  boolean subscriptionPending){
    this.subscriptionPending=subscriptionPending;
  }
  public boolean isSubscriptionPending(){
    return subscriptionPending;
  }
  /** 
 * Returns the roster item pre-approval state.
 * @return the pre-approval state.
 */
  public boolean isApproved(){
    return approved;
  }
  /** 
 * Sets the roster item pre-approval state.
 * @param approved the pre-approval flag.
 */
  public void setApproved(  boolean approved){
    this.approved=approved;
  }
  /** 
 * Returns an unmodifiable set of the group names that the roster item belongs to.
 * @return an unmodifiable set of the group names.
 */
  public Set<String> getGroupNames(){
    return Collections.unmodifiableSet(groupNames);
  }
  /** 
 * Adds a group name.
 * @param groupName the group name.
 */
  public void addGroupName(  String groupName){
    groupNames.add(groupName);
  }
  /** 
 * Removes a group name.
 * @param groupName the group name.
 */
  public void removeGroupName(  String groupName){
    groupNames.remove(groupName);
  }
  @Override public XmlStringBuilder toXML(  org.jivesoftware.smack.packet.XmlEnvironment enclosingNamespace){
    XmlStringBuilder xml=new XmlStringBuilder(this,enclosingNamespace);
    xml.attribute("jid",jid);
    xml.optAttribute("name",name);
    xml.optAttribute("subscription",itemType);
    if (subscriptionPending) {
      xml.append(" ask='subscribe'");
    }
    xml.optBooleanAttribute("approved",approved);
    xml.rightAngleBracket();
    for (    String groupName : groupNames) {
      xml.openElement(GROUP).escape(groupName).closeElement(GROUP);
    }
    xml.closeElement(this);
    return xml;
  }
  @Override public int hashCode(){
    return HashCode.builder().append(groupNames).append(subscriptionPending).append(itemType).append(name).append(jid).append(approved).build();
  }
  @Override public boolean equals(  Object obj){
    return EqualsUtil.equals(this,obj,(e,o) -> e.append(groupNames,o.groupNames).append(subscriptionPending,o.subscriptionPending).append(itemType,o.itemType).append(name,o.name).append(jid,o.jid).append(approved,o.approved));
  }
}
