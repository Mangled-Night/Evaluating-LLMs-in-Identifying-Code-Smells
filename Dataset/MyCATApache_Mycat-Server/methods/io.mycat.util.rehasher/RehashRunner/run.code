public void run(){
  int pageSize=500;
  int page=0;
  List<Map<String,Object>> list=null;
  int total=0;
  int rehashed=0;
  String hostWithDatabase=args.getHostWithDatabase();
  PrintStream ps=null;
  try {
    ps=new PrintStream(output);
    list=JdbcUtils.executeQuery(dataSource,"select " + args.getShardingField() + " from "+ table+ " limit ?,?",page++ * pageSize,pageSize);
    while (!CollectionUtil.isEmpty(list)) {
      for (int i=0, l=list.size(); i < l; i++) {
        Map<String,Object> sf=list.get(i);
        Integer hash=alg.calculate(StringUtil.removeBackquote(sf.get(args.getShardingField()).toString()));
        String host=rehashHosts[hash];
        total++;
        if (host.equals(hostWithDatabase)) {
          rehashed++;
        }
        ps.println(sf + "=>" + host);
      }
      list=JdbcUtils.executeQuery(dataSource,"select " + args.getShardingField() + " from "+ table+ " limit ?,?",page++ * pageSize,pageSize);
    }
    ps.println("rehashed ratio:" + (((double)rehashed) / total));
  }
 catch (  Exception e) {
    throw new RehashException(e);
  }
 finally {
    if (ps != null) {
      ps.close();
    }
    latch.countDown();
  }
}
