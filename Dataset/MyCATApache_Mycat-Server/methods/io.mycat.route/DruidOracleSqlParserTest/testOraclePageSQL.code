@Test public void testOraclePageSQL() throws SQLNonTransientException {
  String sql="SELECT *\n" + "FROM (SELECT XX.*, ROWNUM AS RN \n" + " FROM (\n"+ "SELECT *   FROM offer\n"+ "                ) XX\n"+ "        WHERE ROWNUM <= 15\n"+ "        ) XXX\n"+ "WHERE RN > 5 \n";
  SchemaConfig schema=schemaMap.get("oracledb");
  RouteResultset rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(2,rrs.getNodes().length);
  Assert.assertEquals(5,rrs.getLimitStart());
  Assert.assertEquals(10,rrs.getLimitSize());
  Assert.assertEquals(0,rrs.getNodes()[0].getLimitStart());
  Assert.assertEquals(15,rrs.getNodes()[0].getLimitSize());
  Assert.assertEquals("d_oracle1",rrs.getNodes()[0].getName());
  Assert.assertEquals("d_oracle2",rrs.getNodes()[1].getName());
  sql="SELECT *\n" + "FROM (SELECT XX.*, ROWNUM AS RN \n" + " FROM (\n"+ "SELECT *   FROM offer1"+ "                ) XX\n"+ "        WHERE ROWNUM <= 15\n"+ "        ) XXX\n"+ "WHERE RN > 5 \n";
  rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(1,rrs.getNodes().length);
  Assert.assertEquals(5,rrs.getLimitStart());
  Assert.assertEquals(10,rrs.getLimitSize());
  Assert.assertEquals(5,rrs.getNodes()[0].getLimitStart());
  Assert.assertEquals(10,rrs.getNodes()[0].getLimitSize());
  Assert.assertEquals(sql,rrs.getNodes()[0].getStatement());
  Assert.assertEquals("d_oracle1",rrs.getNodes()[0].getName());
  sql="SELECT *\n" + "FROM (SELECT t.*, ROW_NUMBER() OVER (ORDER BY sid DESC) AS ROWNUM1\n" + "\tFROM offer t\n"+ "\tWHERE sts <> 'N'\n"+ "\t\t\n"+ "\t) XX\n"+ "WHERE ROWNUM1 > 5\n"+ "\tAND ROWNUM1 <= 15\n";
  rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(2,rrs.getNodes().length);
  Assert.assertEquals(5,rrs.getLimitStart());
  Assert.assertEquals(10,rrs.getLimitSize());
  Assert.assertEquals(0,rrs.getNodes()[0].getLimitStart());
  Assert.assertEquals(15,rrs.getNodes()[0].getLimitSize());
  Assert.assertEquals("d_oracle1",rrs.getNodes()[0].getName());
  Assert.assertEquals("d_oracle2",rrs.getNodes()[1].getName());
  sql="SELECT *\n" + "FROM (SELECT t.*, ROW_NUMBER() OVER (ORDER BY sid DESC) AS ROWNUM1\n" + "\tFROM offer1  t\n"+ "\tWHERE sts <> 'N'\n"+ "\t\t\n"+ "\t) XX\n"+ "WHERE ROWNUM1 > 5\n"+ "\tAND ROWNUM1 <= 15\n";
  rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(1,rrs.getNodes().length);
  Assert.assertEquals(5,rrs.getLimitStart());
  Assert.assertEquals(10,rrs.getLimitSize());
  Assert.assertEquals(5,rrs.getNodes()[0].getLimitStart());
  Assert.assertEquals(10,rrs.getNodes()[0].getLimitSize());
  Assert.assertEquals(sql,rrs.getNodes()[0].getStatement());
  Assert.assertEquals("d_oracle1",rrs.getNodes()[0].getName());
  sql="select sid from (select sid from offer ) where rownum<=10";
  rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(2,rrs.getNodes().length);
  Assert.assertEquals(0,rrs.getLimitStart());
  Assert.assertEquals(10,rrs.getLimitSize());
  Assert.assertEquals(0,rrs.getNodes()[0].getLimitStart());
  Assert.assertEquals(10,rrs.getNodes()[0].getLimitSize());
  Assert.assertEquals(sql,rrs.getNodes()[0].getStatement());
  Assert.assertEquals("d_oracle1",rrs.getNodes()[0].getName());
  Assert.assertEquals("d_oracle2",rrs.getNodes()[1].getName());
}
