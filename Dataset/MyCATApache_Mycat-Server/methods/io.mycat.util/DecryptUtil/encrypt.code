public static String encrypt(String plainText) throws Exception {
  return encrypt((String)null,plainText);
}
public static String encrypt(String key,String plainText) throws Exception {
  if (key == null) {
    key=DEFAULT_PRIVATE_KEY_STRING;
  }
  byte[] keyBytes=Base64.base64ToByteArray(key);
  return encrypt(keyBytes,plainText);
}
public static String encrypt(byte[] keyBytes,String plainText) throws Exception {
  PKCS8EncodedKeySpec spec=new PKCS8EncodedKeySpec(keyBytes);
  KeyFactory factory=KeyFactory.getInstance("RSA");
  PrivateKey privateKey=factory.generatePrivate(spec);
  Cipher cipher=Cipher.getInstance("RSA");
  try {
    cipher.init(Cipher.ENCRYPT_MODE,privateKey);
  }
 catch (  InvalidKeyException e) {
    RSAPrivateKey rsaPrivateKey=(RSAPrivateKey)privateKey;
    RSAPublicKeySpec publicKeySpec=new RSAPublicKeySpec(rsaPrivateKey.getModulus(),rsaPrivateKey.getPrivateExponent());
    Key fakePublicKey=KeyFactory.getInstance("RSA").generatePublic(publicKeySpec);
    cipher=Cipher.getInstance("RSA");
    cipher.init(Cipher.ENCRYPT_MODE,fakePublicKey);
  }
  byte[] encryptedBytes=cipher.doFinal(plainText.getBytes("UTF-8"));
  String encryptedString=Base64.byteArrayToBase64(encryptedBytes);
  return encryptedString;
}
