/** 
 * 写入数据包
 * @param field_count
 * @param fields
 * @param c
 */
private static void doWrite(int field_count,FieldPacket[] fields,ServerConnection c){
  ByteBuffer buffer=c.allocate();
  ResultSetHeaderPacket header=PacketUtil.getHeader(field_count);
  byte packetId=header.packetId;
  buffer=header.write(buffer,c,true);
  for (  FieldPacket field : fields) {
    field.packetId=++packetId;
    buffer=field.write(buffer,c,true);
  }
  EOFPacket eof=new EOFPacket();
  eof.packetId=++packetId;
  buffer=eof.write(buffer,c,true);
  EOFPacket lastEof=new EOFPacket();
  lastEof.packetId=++packetId;
  buffer=lastEof.write(buffer,c,true);
  c.write(buffer);
}
