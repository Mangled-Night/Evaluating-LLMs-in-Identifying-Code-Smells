@Override public SortedSet<Integer> localDeviceIdsOf(BareJid localUser){
  if (persistent != null) {
    return persistent.localDeviceIdsOf(localUser);
  }
 else {
    SortedSet<Integer> deviceIds=new TreeSet<>();
    for (    OmemoDevice device : caches.keySet()) {
      if (device.getJid().equals(localUser)) {
        deviceIds.add(device.getDeviceId());
      }
    }
    return deviceIds;
  }
}
