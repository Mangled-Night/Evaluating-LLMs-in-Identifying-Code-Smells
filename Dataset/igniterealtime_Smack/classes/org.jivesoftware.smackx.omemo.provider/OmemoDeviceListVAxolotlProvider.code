/** 
 * Smack ExtensionProvider that parses OMEMO device list element into OmemoDeviceListElement objects.
 * @author Paul Schaub
 */
public class OmemoDeviceListVAxolotlProvider extends ExtensionElementProvider<OmemoDeviceListElement_VAxolotl> {
  @Override public OmemoDeviceListElement_VAxolotl parse(  XmlPullParser parser,  int initialDepth,  XmlEnvironment xmlEnvironment) throws XmlPullParserException, IOException {
    Set<Integer> deviceListIds=new HashSet<>();
    outerloop:     while (true) {
      XmlPullParser.Event tag=parser.next();
switch (tag) {
case START_ELEMENT:
        String name=parser.getName();
      if (name.equals(DEVICE)) {
        for (int i=0; i < parser.getAttributeCount(); i++) {
          if (parser.getAttributeName(i).equals(ID)) {
            Integer deviceId=Integer.parseInt(parser.getAttributeValue(i));
            deviceListIds.add(deviceId);
          }
        }
      }
    break;
case END_ELEMENT:
  if (parser.getDepth() == initialDepth) {
    break outerloop;
  }
break;
default :
break;
}
}
return new OmemoDeviceListElement_VAxolotl(deviceListIds);
}
}
