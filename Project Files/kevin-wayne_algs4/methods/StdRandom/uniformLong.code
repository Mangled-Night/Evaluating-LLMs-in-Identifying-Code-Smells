/** 
 * Returns a random long integer uniformly in [0, n).
 * @param n number of possible {@code long} integers
 * @return a random long integer uniformly between 0 (inclusive) and {@code n} (exclusive)
 * @throws IllegalArgumentException if {@code n <= 0}
 */
public static long uniformLong(long n){
  if (n <= 0L)   throw new IllegalArgumentException("argument must be positive: " + n);
  long r=random.nextLong();
  long m=n - 1;
  if ((n & m) == 0L) {
    return r & m;
  }
  long u=r >>> 1;
  while (u + m - (r=u % n) < 0L) {
    u=random.nextLong() >>> 1;
  }
  return r;
}
