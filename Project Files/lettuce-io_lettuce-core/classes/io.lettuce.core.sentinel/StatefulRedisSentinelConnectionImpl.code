/** 
 * @author Mark Paluch
 */
public class StatefulRedisSentinelConnectionImpl<K,V> extends RedisChannelHandler<K,V> implements StatefulRedisSentinelConnection<K,V> {
  protected final RedisCodec<K,V> codec;
  protected final RedisSentinelCommands<K,V> sync;
  protected final RedisSentinelAsyncCommands<K,V> async;
  protected final RedisSentinelReactiveCommands<K,V> reactive;
  private final SentinelConnectionState connectionState=new SentinelConnectionState();
  public StatefulRedisSentinelConnectionImpl(  RedisChannelWriter writer,  RedisCodec<K,V> codec,  Duration timeout){
    super(writer,timeout);
    this.codec=codec;
    this.async=new RedisSentinelAsyncCommandsImpl<>(this,codec);
    this.sync=syncHandler(async,RedisSentinelCommands.class);
    this.reactive=new RedisSentinelReactiveCommandsImpl<>(this,codec);
  }
  @Override public <T>RedisCommand<K,V,T> dispatch(  RedisCommand<K,V,T> command){
    return super.dispatch(command);
  }
  @Override public Collection<RedisCommand<K,V,?>> dispatch(  Collection<? extends RedisCommand<K,V,?>> commands){
    return super.dispatch(commands);
  }
  @Override public RedisSentinelCommands<K,V> sync(){
    return sync;
  }
  @Override public RedisSentinelAsyncCommands<K,V> async(){
    return async;
  }
  @Override public RedisSentinelReactiveCommands<K,V> reactive(){
    return reactive;
  }
  /** 
 * @param clientName
 * @deprecated since 6.0, use {@link RedisSentinelAsyncCommands#clientSetname(Object)}.
 */
  @Deprecated public void setClientName(  String clientName){
    CommandArgs<String,String> args=new CommandArgs<>(StringCodec.UTF8).add(CommandKeyword.SETNAME).addValue(clientName);
    AsyncCommand<String,String,String> async=new AsyncCommand<>(new Command<>(CommandType.CLIENT,new StatusOutput<>(StringCodec.UTF8),args));
    connectionState.setClientName(clientName);
    dispatch((RedisCommand)async);
  }
  public ConnectionState getConnectionState(){
    return connectionState;
  }
static class SentinelConnectionState extends ConnectionState {
    @Override protected void setClientName(    String clientName){
      super.setClientName(clientName);
    }
  }
}
