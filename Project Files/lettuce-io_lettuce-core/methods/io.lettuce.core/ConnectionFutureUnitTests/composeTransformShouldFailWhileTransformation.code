@Test void composeTransformShouldFailWhileTransformation(){
  CompletableFuture<String> foo=new CompletableFuture<>();
  ConnectionFuture<Object> transformed=ConnectionFuture.from(null,foo).thenCompose((s,t) -> {
    throw new IllegalStateException();
  }
);
  foo.complete("foo");
  assertThat(transformed.toCompletableFuture()).isDone();
  assertThat(transformed.toCompletableFuture()).isCompletedExceptionally();
  assertThatThrownBy(transformed::join).hasRootCauseInstanceOf(IllegalStateException.class);
}
