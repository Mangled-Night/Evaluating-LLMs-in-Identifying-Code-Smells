protected boolean checkPassword(byte[] password,String user){
  String pass=source.getPrivileges().getPassword(user);
  if (pass == null || pass.length() == 0) {
    if (password == null || password.length == 0) {
      return true;
    }
 else {
      return false;
    }
  }
  if (password == null || password.length == 0) {
    return false;
  }
  byte[] encryptPass=null;
  try {
    encryptPass=SecurityUtil.scramble411(pass.getBytes(),source.getSeed());
  }
 catch (  NoSuchAlgorithmException e) {
    LOGGER.warn(source.toString(),e);
    return false;
  }
  if (encryptPass != null && (encryptPass.length == password.length)) {
    int i=encryptPass.length;
    while (i-- != 0) {
      if (encryptPass[i] != password[i]) {
        return false;
      }
    }
  }
 else {
    return false;
  }
  return true;
}
