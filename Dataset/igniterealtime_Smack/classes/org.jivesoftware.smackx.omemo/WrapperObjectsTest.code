/** 
 * Test the identityKeyWrapper.
 */
public class WrapperObjectsTest extends SmackTestSuite {
  @Test public void ciphertextTupleTest(){
    byte[] c=OmemoMessageBuilder.generateIv();
    CiphertextTuple c1=new CiphertextTuple(c,OmemoElement.TYPE_OMEMO_PREKEY_MESSAGE);
    assertTrue(c1.isPreKeyMessage());
    assertArrayEquals(c,c1.getCiphertext());
    assertEquals(OmemoElement.TYPE_OMEMO_PREKEY_MESSAGE,c1.getMessageType());
    CiphertextTuple c2=new CiphertextTuple(c,OmemoElement.TYPE_OMEMO_MESSAGE);
    assertFalse(c2.isPreKeyMessage());
    assertEquals(OmemoElement.TYPE_OMEMO_MESSAGE,c2.getMessageType());
  }
  @Test public void cipherAndAuthTagTest() throws NoSuchAlgorithmException, CryptoFailedException {
    byte[] key=OmemoMessageBuilder.generateKey(KEYTYPE,KEYLENGTH);
    byte[] iv=OmemoMessageBuilder.generateIv();
    byte[] authTag=OmemoMessageBuilder.generateIv();
    CipherAndAuthTag cat=new CipherAndAuthTag(key,iv,authTag,true);
    assertArrayEquals(key,cat.getKey());
    assertArrayEquals(iv,cat.getIv());
    assertArrayEquals(authTag,cat.getAuthTag());
    assertTrue(cat.wasPreKeyEncrypted());
  }
}
