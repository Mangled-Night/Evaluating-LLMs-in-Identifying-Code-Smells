public void copyTo(ResultConsumer consumer){
  queueLock.lock();
  try {
    for (    ResultModel result : resultQueue) {
      consumer.appendResult(result);
    }
    if (lastInputStatus != null) {
      consumer.appendResult(lastInputStatus);
    }
  }
  finally {
    if (queueLock.isHeldByCurrentThread()) {
      queueLock.unlock();
    }
  }
}
