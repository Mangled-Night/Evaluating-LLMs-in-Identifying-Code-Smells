@Override public List<Path> call() throws IOException {
  final int numFiles=uriToTargetMap.size();
  if (numFiles < 1) {
    return Collections.emptyList();
  }
  final Map<URI,Long> fileSizes=getSizes();
  final long totalBytes=sum(fileSizes.values());
  List<Path> downloadedFiles=new ArrayList<>();
  int index=0;
  long completedFilesBytes=0;
  for (  Map.Entry<URI,Path> entry : uriToTargetMap.entrySet()) {
    final int downloadedFileCount=index + 1;
    final long previousFilesBytes=completedFilesBytes;
    SingleFileTransferProgressListener singleDownloadListener=(fileDownloadedBytes,fileTotalBytes) -> progressListener.onDownloadProgress(previousFilesBytes + fileDownloadedBytes,totalBytes,downloadedFileCount,numFiles);
    URL url=entry.getKey().toURL();
    SingleFileDownloader fileDownloader=new SingleFileDownloader(url,entry.getValue(),singleDownloadListener);
    downloadedFiles.add(fileDownloader.call());
    completedFilesBytes+=fileSizes.get(entry.getKey());
    index++;
  }
  return downloadedFiles;
}
