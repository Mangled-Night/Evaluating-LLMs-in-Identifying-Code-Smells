private void processHandShakePacket(byte[] data){
  HandshakePacket packet=new HandshakePacket();
  packet.read(data);
  source.setHandshake(packet);
  source.setThreadId(packet.threadId);
  int charsetIndex=(packet.serverCharsetIndex & 0xff);
  String charset=CharsetUtil.getCharset(charsetIndex);
  if (charset != null) {
    source.setCharset(charset);
  }
 else {
    throw new RuntimeException("Unknown charsetIndex:" + charsetIndex);
  }
}
