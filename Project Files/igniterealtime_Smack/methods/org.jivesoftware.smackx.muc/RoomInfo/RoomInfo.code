RoomInfo(DiscoverInfo info){
  final Jid from=info.getFrom();
  if (from != null) {
    this.room=info.getFrom().asEntityBareJidIfPossible();
  }
 else {
    this.room=null;
  }
  this.membersOnly=info.containsFeature("muc_membersonly");
  this.moderated=info.containsFeature("muc_moderated");
  this.nonanonymous=info.containsFeature("muc_nonanonymous");
  this.passwordProtected=info.containsFeature("muc_passwordprotected");
  this.persistent=info.containsFeature("muc_persistent");
  List<DiscoverInfo.Identity> identities=info.getIdentities();
  if (!identities.isEmpty()) {
    this.name=identities.get(0).getName();
  }
 else {
    LOGGER.warning("DiscoverInfo does not contain any Identity: " + info.toXML());
    this.name="";
  }
  String subject="";
  int occupantsCount=-1;
  String description="";
  int maxhistoryfetch=-1;
  List<EntityBareJid> contactJid=null;
  String lang=null;
  String ldapgroup=null;
  Boolean subjectmod=null;
  URL logs=null;
  String pubsub=null;
  form=DataForm.from(info);
  if (form != null) {
    FormField descField=form.getField("muc#roominfo_description");
    if (descField != null && !descField.getValues().isEmpty()) {
      description=descField.getFirstValue();
    }
    FormField subjField=form.getField("muc#roominfo_subject");
    if (subjField != null && !subjField.getValues().isEmpty()) {
      subject=subjField.getFirstValue();
    }
    FormField occCountField=form.getField("muc#roominfo_occupants");
    if (occCountField != null && !occCountField.getValues().isEmpty()) {
      occupantsCount=Integer.parseInt(occCountField.getFirstValue());
    }
    FormField maxhistoryfetchField=form.getField("muc#maxhistoryfetch");
    if (maxhistoryfetchField != null && !maxhistoryfetchField.getValues().isEmpty()) {
      maxhistoryfetch=Integer.parseInt(maxhistoryfetchField.getFirstValue());
    }
    FormField contactJidField=form.getField("muc#roominfo_contactjid");
    if (contactJidField != null && !contactJidField.getValues().isEmpty()) {
      List<? extends CharSequence> contactJidValues=contactJidField.getValues();
      contactJid=JidUtil.filterEntityBareJidList(JidUtil.jidSetFrom(contactJidValues));
    }
    FormField langField=form.getField("muc#roominfo_lang");
    if (langField != null && !langField.getValues().isEmpty()) {
      lang=langField.getFirstValue();
    }
    FormField ldapgroupField=form.getField("muc#roominfo_ldapgroup");
    if (ldapgroupField != null && !ldapgroupField.getValues().isEmpty()) {
      ldapgroup=ldapgroupField.getFirstValue();
    }
    FormField subjectmodField=form.getField("muc#roominfo_subjectmod");
    if (subjectmodField != null && !subjectmodField.getValues().isEmpty()) {
      String firstValue=subjectmodField.getFirstValue();
      subjectmod="true".equals(firstValue) || "1".equals(firstValue);
    }
    FormField urlField=form.getField("muc#roominfo_logs");
    if (urlField != null && !urlField.getValues().isEmpty()) {
      String urlString=urlField.getFirstValue();
      try {
        logs=new URL(urlString);
      }
 catch (      MalformedURLException e) {
        LOGGER.log(Level.SEVERE,"Could not parse URL",e);
      }
    }
    FormField pubsubField=form.getField("muc#roominfo_pubsub");
    if (pubsubField != null && !pubsubField.getValues().isEmpty()) {
      pubsub=pubsubField.getFirstValue();
    }
  }
  this.description=description;
  this.subject=subject;
  this.occupantsCount=occupantsCount;
  this.maxhistoryfetch=maxhistoryfetch;
  this.contactJid=contactJid;
  this.lang=lang;
  this.ldapgroup=ldapgroup;
  this.subjectmod=subjectmod;
  this.logs=logs;
  this.pubsub=pubsub;
}
