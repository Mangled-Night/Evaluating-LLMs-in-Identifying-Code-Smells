public class LoginUserHandlerMethodArgumentResolver implements HandlerMethodArgumentResolver {
  public static final String LOGIN_TOKEN_KEY="X-Litemall-Token";
  @Override public boolean supportsParameter(  MethodParameter parameter){
    return parameter.getParameterType().isAssignableFrom(Integer.class) && parameter.hasParameterAnnotation(LoginUser.class);
  }
  @Override public Object resolveArgument(  MethodParameter parameter,  ModelAndViewContainer container,  NativeWebRequest request,  WebDataBinderFactory factory) throws Exception {
    String token=request.getHeader(LOGIN_TOKEN_KEY);
    if (token == null || token.isEmpty()) {
      return null;
    }
    return UserTokenManager.getUserId(token);
  }
}
