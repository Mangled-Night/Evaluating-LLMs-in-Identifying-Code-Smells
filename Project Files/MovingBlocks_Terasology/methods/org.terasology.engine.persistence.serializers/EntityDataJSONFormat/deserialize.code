@Override public EntityData.GlobalStore deserialize(JsonElement json,Type typeOfT,JsonDeserializationContext context) throws JsonParseException {
  EntityData.GlobalStore.Builder world=EntityData.GlobalStore.newBuilder();
  if (json.isJsonObject()) {
    JsonObject jsonObject=json.getAsJsonObject();
    JsonArray prefabArray=jsonObject.getAsJsonArray("prefab");
    if (prefabArray != null) {
      for (      JsonElement prefabElem : prefabArray) {
        world.addPrefab((EntityData.Prefab)context.deserialize(prefabElem,EntityData.Prefab.class));
      }
    }
    JsonArray entityArray=jsonObject.getAsJsonArray("entity");
    if (entityArray != null) {
      for (      JsonElement entityElem : entityArray) {
        world.addEntity((EntityData.Entity)context.deserialize(entityElem,EntityData.Entity.class));
      }
    }
    JsonPrimitive nextId=jsonObject.getAsJsonPrimitive("next_entity_id");
    if (nextId != null) {
      world.setNextEntityId(nextId.getAsInt());
    }
  }
  return world.build();
}
@Override public EntityData.Component.Builder deserialize(JsonElement json,Type typeOfT,JsonDeserializationContext context) throws JsonParseException {
  EntityData.Component.Builder component=EntityData.Component.newBuilder();
  JsonObject jsonObject=json.getAsJsonObject();
  for (  Map.Entry<String,JsonElement> entry : jsonObject.entrySet()) {
    EntityData.NameValue.Builder nameValue=EntityData.NameValue.newBuilder();
    nameValue.setName(entry.getKey());
    EntityData.Value value=context.deserialize(entry.getValue(),EntityData.Value.class);
    nameValue.setValue(value);
    component.addField(nameValue);
  }
  return component;
}
@Override public EntityData.Entity deserialize(JsonElement json,Type typeOfT,JsonDeserializationContext context) throws JsonParseException {
  EntityData.Entity.Builder entity=EntityData.Entity.newBuilder();
  JsonObject jsonObject=json.getAsJsonObject();
  for (  Map.Entry<String,JsonElement> entry : jsonObject.entrySet()) {
    String name=entry.getKey().toLowerCase(Locale.ENGLISH);
switch (name) {
case "parentprefab":
      if (entry.getValue().isJsonPrimitive()) {
        entity.setParentPrefab(entry.getValue().getAsString());
      }
    break;
case "id":
  if (entry.getValue().isJsonPrimitive()) {
    entity.setId(entry.getValue().getAsInt());
  }
break;
case "removedcomponent":
if (entry.getValue().isJsonArray()) {
for (JsonElement element : entry.getValue().getAsJsonArray()) {
  entity.addRemovedComponent(element.getAsString());
}
}
break;
case "owner":
if (entry.getValue().isJsonPrimitive()) {
entity.setOwner(entry.getValue().getAsInt());
}
break;
case "alwaysrelevant":
entity.setAlwaysRelevant(entry.getValue().getAsBoolean());
break;
default :
EntityData.Component.Builder component=context.deserialize(entry.getValue(),EntityData.Component.Builder.class);
component.setType(entry.getKey());
entity.addComponent(component);
}
}
return entity.build();
}
@Override public EntityData.Prefab deserialize(JsonElement json,Type typeOfT,JsonDeserializationContext context) throws JsonParseException {
  EntityData.Prefab.Builder prefab=EntityData.Prefab.newBuilder();
  JsonObject jsonObject=json.getAsJsonObject();
  for (  Map.Entry<String,JsonElement> entry : jsonObject.entrySet()) {
    String name=entry.getKey().toLowerCase(Locale.ENGLISH);
switch (name) {
case "name":
      if (entry.getValue().isJsonPrimitive()) {
        prefab.setName(entry.getValue().getAsString());
      }
    break;
case "parent":
  if (entry.getValue().isJsonPrimitive()) {
    prefab.setParentName(entry.getValue().getAsString());
  }
break;
case "removedcomponents":
if (entry.getValue().isJsonPrimitive()) {
prefab.addRemovedComponent(entry.getValue().getAsString());
}
 else if (entry.getValue().isJsonArray()) {
for (JsonElement element : entry.getValue().getAsJsonArray()) {
  prefab.addRemovedComponent(element.getAsString());
}
}
break;
case "persisted":
prefab.setPersisted(entry.getValue().getAsBoolean());
break;
case "alwaysrelevant":
prefab.setAlwaysRelevant(entry.getValue().getAsBoolean());
break;
default :
if (entry.getValue().isJsonObject()) {
EntityData.Component.Builder component=context.deserialize(entry.getValue(),EntityData.Component.Builder.class);
component.setType(entry.getKey());
prefab.addComponent(component);
}
}
}
return prefab.build();
}
@Override public EntityData.Value deserialize(JsonElement json,Type typeOfT,JsonDeserializationContext context) throws JsonParseException {
  EntityData.Value.Builder value=EntityData.Value.newBuilder();
  if (json.isJsonPrimitive()) {
    extractPrimitive(value,json);
  }
 else   if (json.isJsonObject()) {
    extractMap(json,context,value);
  }
 else   if (json.isJsonArray()) {
    JsonArray jsonArray=json.getAsJsonArray();
    TByteList byteList=new TByteArrayList();
    for (    JsonElement element : jsonArray) {
      if (element.isJsonArray()) {
        value.addValue((EntityData.Value)context.deserialize(element,EntityData.Value.class));
      }
 else       if (element.isJsonObject()) {
        value.addValue((EntityData.Value)context.deserialize(element,EntityData.Value.class));
      }
 else       if (element.isJsonPrimitive()) {
        extractPrimitive(value,element);
        if (element.getAsJsonPrimitive().isNumber()) {
          try {
            byteList.add(element.getAsByte());
          }
 catch (          NumberFormatException nfe) {
            byteList.add((byte)0);
          }
        }
      }
    }
    if (byteList.size() > 0) {
      value.setBytes(ByteString.copyFrom(byteList.toArray()));
    }
  }
  return value.build();
}
