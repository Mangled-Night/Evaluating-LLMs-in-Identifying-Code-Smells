@Override Partitions getPartitions(Partitions current,Map<RedisURI,Partitions> topologyViews){
  if (topologyViews.isEmpty()) {
    return current;
  }
  List<VotedPartitions> votedList=new ArrayList<>();
  for (  Partitions partitions : topologyViews.values()) {
    int knownNodes=0;
    for (    RedisClusterNode knownNode : current) {
      if (partitions.getPartitionByNodeId(knownNode.getNodeId()) != null) {
        knownNodes++;
      }
    }
    votedList.add(new VotedPartitions(knownNodes,partitions));
  }
  Collections.shuffle(votedList);
  Collections.sort(votedList,(o1,o2) -> Integer.compare(o2.votes,o1.votes));
  return votedList.get(0).partitions;
}
@Override Partitions getPartitions(Partitions current,Map<RedisURI,Partitions> topologyViews){
  if (topologyViews.isEmpty()) {
    return current;
  }
  List<VotedPartitions> votedList=new ArrayList<>();
  for (  Partitions partitions : topologyViews.values()) {
    int votes=0;
    for (    RedisClusterNode node : partitions) {
      if (node.is(RedisClusterNode.NodeFlag.FAIL) || node.is(RedisClusterNode.NodeFlag.EVENTUAL_FAIL) || node.is(RedisClusterNode.NodeFlag.NOADDR)) {
        continue;
      }
      votes++;
    }
    votedList.add(new VotedPartitions(votes,partitions));
  }
  Collections.shuffle(votedList);
  Collections.sort(votedList,(o1,o2) -> Integer.compare(o2.votes,o1.votes));
  return votedList.get(0).partitions;
}
