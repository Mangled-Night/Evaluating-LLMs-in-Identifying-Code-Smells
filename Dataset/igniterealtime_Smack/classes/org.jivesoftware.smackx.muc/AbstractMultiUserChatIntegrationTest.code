public class AbstractMultiUserChatIntegrationTest extends AbstractSmackIntegrationTest {
  final String randomString=StringUtils.insecureRandomString(6);
  final MultiUserChatManager mucManagerOne;
  final MultiUserChatManager mucManagerTwo;
  final MultiUserChatManager mucManagerThree;
  final DomainBareJid mucService;
  public AbstractMultiUserChatIntegrationTest(  SmackIntegrationTestEnvironment environment) throws SmackException.NoResponseException, XMPPException.XMPPErrorException, SmackException.NotConnectedException, InterruptedException, TestNotPossibleException {
    super(environment);
    mucManagerOne=MultiUserChatManager.getInstanceFor(conOne);
    mucManagerTwo=MultiUserChatManager.getInstanceFor(conTwo);
    mucManagerThree=MultiUserChatManager.getInstanceFor(conThree);
    List<DomainBareJid> services=mucManagerOne.getMucServiceDomains();
    if (services.isEmpty()) {
      throw new TestNotPossibleException("No MUC (XEP-45) service found");
    }
    mucService=services.get(0);
  }
  /** 
 * Gets a random room name.
 * @param prefix A prefix to add to the room name for descriptive purposes
 * @return the bare JID of a random room
 * @throws XmppStringprepException if the prefix isn't a valid XMPP Localpart
 */
  public EntityBareJid getRandomRoom(  String prefix) throws XmppStringprepException {
    final String roomNameLocal=String.join("-",prefix,testRunId,StringUtils.insecureRandomString(6));
    return JidCreate.entityBareFrom(Localpart.from(roomNameLocal),mucService.getDomain());
  }
  /** 
 * Destroys a MUC room, ignoring any exceptions.
 * @param muc The room to destroy (can be null).
 * @throws InterruptedException if the calling thread was interrupted.
 * @throws SmackException.NotConnectedException if the XMPP connection is not connected.
 * @throws XMPPException.XMPPErrorException if there was an XMPP error returned.
 * @throws SmackException.NoResponseException if there was no response from the remote entity.
 */
  static void tryDestroy(  final MultiUserChat muc) throws SmackException.NoResponseException, XMPPException.XMPPErrorException, SmackException.NotConnectedException, InterruptedException {
    if (muc == null) {
      return;
    }
    muc.destroy("test fixture teardown",null);
  }
  static void createMuc(  MultiUserChat muc,  Resourcepart resourceName) throws SmackException.NoResponseException, XMPPException.XMPPErrorException, InterruptedException, MultiUserChatException.MucAlreadyJoinedException, SmackException.NotConnectedException, MultiUserChatException.MissingMucCreationAcknowledgeException, MultiUserChatException.NotAMucServiceException {
    muc.create(resourceName).makeInstant();
  }
  static void createMuc(  MultiUserChat muc,  String nickname) throws XmppStringprepException, MultiUserChatException.MucAlreadyJoinedException, XMPPException.XMPPErrorException, SmackException.NotConnectedException, MultiUserChatException.MissingMucCreationAcknowledgeException, SmackException.NoResponseException, InterruptedException, MultiUserChatException.NotAMucServiceException {
    createMuc(muc,Resourcepart.from(nickname));
  }
  static void createMembersOnlyMuc(  MultiUserChat muc,  Resourcepart resourceName) throws SmackException.NoResponseException, XMPPException.XMPPErrorException, InterruptedException, MultiUserChatException.MucAlreadyJoinedException, SmackException.NotConnectedException, MultiUserChatException.MissingMucCreationAcknowledgeException, MultiUserChatException.MucConfigurationNotSupportedException, MultiUserChatException.NotAMucServiceException {
    muc.create(resourceName).getConfigFormManager().makeMembersOnly().submitConfigurationForm();
  }
  static void createModeratedMuc(  MultiUserChat muc,  Resourcepart resourceName) throws SmackException.NoResponseException, XMPPException.XMPPErrorException, InterruptedException, MultiUserChatException.MucAlreadyJoinedException, SmackException.NotConnectedException, MultiUserChatException.MissingMucCreationAcknowledgeException, MultiUserChatException.NotAMucServiceException, MultiUserChatException.MucConfigurationNotSupportedException {
    muc.create(resourceName).getConfigFormManager().makeModerated().submitConfigurationForm();
  }
  static void createHiddenMuc(  MultiUserChat muc,  Resourcepart resourceName) throws SmackException.NoResponseException, XMPPException.XMPPErrorException, InterruptedException, MultiUserChatException.MucAlreadyJoinedException, SmackException.NotConnectedException, MultiUserChatException.MissingMucCreationAcknowledgeException, MultiUserChatException.NotAMucServiceException, XmppStringprepException, MultiUserChatException.MucConfigurationNotSupportedException {
    muc.create(resourceName).getConfigFormManager().makeHidden().submitConfigurationForm();
  }
}
