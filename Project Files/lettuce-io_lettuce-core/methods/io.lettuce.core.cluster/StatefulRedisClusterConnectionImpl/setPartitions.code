public void setPartitions(Partitions partitions){
  LettuceAssert.notNull(partitions,"Partitions must not be null");
  this.partitions=partitions;
  String nodeId=connectionState.getNodeId();
  if (nodeId != null && expireStaleConnections()) {
    if (partitions.getPartitionByNodeId(nodeId) == null) {
      getClusterDistributionChannelWriter().disconnectDefaultEndpoint();
    }
  }
  getClusterDistributionChannelWriter().setPartitions(partitions);
}
