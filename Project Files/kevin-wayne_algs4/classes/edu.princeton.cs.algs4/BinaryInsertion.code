/** 
 * The  {@code BinaryInsertion} class provides a static method for sorting anarray using an optimized binary insertion sort with half exchanges. <p> In the worst case, this implementation makes ~ <em>n</em> log<sub>2</sub><em>n</em> compares to sort an array of length <em>n</em>. However, in the worst case, the running time is &Theta;(<em>n</em><sup>2</sup>) because the number of array accesses can be quadratic. As such, it is not suitable for sorting large arrays (unless the number of inversions is small). <p> This sorting algorithm is stable. It uses &Theta;(1) extra memory (not including the input array). <p> For additional documentation, see <a href="https://algs4.cs.princeton.edu/21elementary">Section 2.1</a> of <i>Algorithms, 4th Edition</i> by Robert Sedgewick and Kevin Wayne.
 * @author Ivan Pesin
 * @author Robert Sedgewick
 * @author Kevin Wayne
 */
public class BinaryInsertion {
  private BinaryInsertion(){
  }
  /** 
 * Rearranges the array in ascending order, using the natural order.
 * @param a the array to be sorted
 */
  public static void sort(  Comparable[] a){
    int n=a.length;
    for (int i=1; i < n; i++) {
      Comparable v=a[i];
      int lo=0, hi=i;
      while (lo < hi) {
        int mid=lo + (hi - lo) / 2;
        if (less(v,a[mid]))         hi=mid;
 else         lo=mid + 1;
      }
      for (int j=i; j > lo; --j)       a[j]=a[j - 1];
      a[lo]=v;
    }
    assert isSorted(a);
  }
  /** 
 * Helper sorting function.
 */
  private static boolean less(  Comparable v,  Comparable w){
    return v.compareTo(w) < 0;
  }
  /** 
 * Check if array is sorted - useful for debugging.
 */
  private static boolean isSorted(  Comparable[] a){
    return isSorted(a,0,a.length - 1);
  }
  private static boolean isSorted(  Comparable[] a,  int lo,  int hi){
    for (int i=lo + 1; i <= hi; i++)     if (less(a[i],a[i - 1]))     return false;
    return true;
  }
  private static void show(  Comparable[] a){
    for (int i=0; i < a.length; i++) {
      StdOut.println(a[i]);
    }
  }
  /** 
 * Reads in a sequence of strings from standard input; insertion sorts them; and prints them to standard output in ascending order.
 * @param args the command-line arguments
 */
  public static void main(  String[] args){
    String[] a=StdIn.readAllStrings();
    BinaryInsertion.sort(a);
    show(a);
  }
}
