private class BufferChannelReader<T> implements ChannelReader {
  private TFloatList times;
  private List<T> data;
  private Interpolator<T> interpolator;
  private TargetRetriever<T> targetRetriever;
  BufferChannelReader(  TFloatList times,  List<T> data,  Interpolator<T> interpolator,  TargetRetriever<T> targetRetriever){
    this.times=times;
    this.data=data;
    this.interpolator=interpolator;
    this.targetRetriever=targetRetriever;
  }
  public void updateFrame(  float time,  MeshAnimationFrame frame){
    int upperFrame=0;
    while (upperFrame < times.size() - 1 && times.get(upperFrame) < time) {
      upperFrame++;
    }
    int lowerFrame=Math.max(0,upperFrame - 1);
    T target=targetRetriever.getTarget(frame);
    if (upperFrame == lowerFrame) {
      interpolator.interpolate(data.get(lowerFrame),data.get(lowerFrame),0,target);
    }
 else {
      float t=(time - times.get(lowerFrame)) / (times.get(upperFrame) - times.get(lowerFrame));
      interpolator.interpolate(data.get(lowerFrame),data.get(upperFrame),t,target);
    }
  }
  public float endTime(){
    return times.get(times.size() - 1);
  }
}
