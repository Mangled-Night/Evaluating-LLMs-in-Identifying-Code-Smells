@Test public void storeLoadRemoveOmemoSignedPreKeys() throws IOException, CorruptedOmemoKeyException {
  TreeMap<Integer,T_SigPreKey> before=store.loadOmemoSignedPreKeys(alice);
  assertEquals("At this stage, there must be no signed prekeys in the store.",0,before.size());
  T_IdKeyPair idp=store.generateOmemoIdentityKeyPair();
  T_SigPreKey spk=store.generateOmemoSignedPreKey(idp,125);
  assertNotNull("SignedPreKey must not be null.",spk);
  assertEquals("ID of signedPreKey must match.",125,store.keyUtil().signedPreKeyIdFromKey(spk));
  byte[] bytes=store.keyUtil().signedPreKeyToBytes(spk);
  assertNotNull("Serialized signedPreKey must not be null",bytes);
  assertNotSame("Serialized signedPreKey must not be of length 0.",0,bytes.length);
  store.storeOmemoSignedPreKey(alice,125,spk);
  TreeMap<Integer,T_SigPreKey> after=store.loadOmemoSignedPreKeys(alice);
  assertEquals("We must have exactly 1 signedPreKey now.",1,after.size());
  T_SigPreKey spk2=after.get(after.firstKey());
  assertEquals("Id of the stored signedPreKey must match the one we stored.",125,store.keyUtil().signedPreKeyIdFromKey(spk2));
  assertTrue("Serialization of stored and loaded signed preKey must equal.",Arrays.equals(store.keyUtil().signedPreKeyToBytes(spk),store.keyUtil().signedPreKeyToBytes(spk2)));
  T_SigPreKey rspk=store.loadOmemoSignedPreKey(alice,125);
  assertTrue("Serialization of stored and randomly accessed signed preKey must equal.",Arrays.equals(store.keyUtil().signedPreKeyToBytes(spk),store.keyUtil().signedPreKeyToBytes(rspk)));
  assertNull("Non-existing signedPreKey must be returned as null.",store.loadOmemoSignedPreKey(alice,10000));
  store.removeOmemoSignedPreKey(alice,125);
  assertNull("Deleted key must be returned as null.",store.loadOmemoSignedPreKey(alice,125));
  assertEquals(0,store.loadOmemoSignedPreKeys(alice).size());
}
