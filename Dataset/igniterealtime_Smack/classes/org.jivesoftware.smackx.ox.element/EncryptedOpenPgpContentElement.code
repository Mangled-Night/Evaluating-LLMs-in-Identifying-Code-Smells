/** 
 * Abstract class that bundles functionality of encrypted OpenPGP content elements ( {@link CryptElement}, {@link SigncryptElement}) together.
 */
public abstract class EncryptedOpenPgpContentElement extends OpenPgpContentElement {
  public static final String ELEM_RPAD="rpad";
  private final String rpad;
  protected EncryptedOpenPgpContentElement(  Set<? extends Jid> to,  String rpad,  Date timestamp,  List<ExtensionElement> payload){
    super(Objects.requireNonNullNorEmpty(to,"Encrypted OpenPGP content elements must have at least one 'to' attribute."),timestamp,payload);
    this.rpad=Objects.requireNonNull(rpad);
  }
  protected EncryptedOpenPgpContentElement(  Set<? extends Jid> to,  List<ExtensionElement> payload){
    super(Objects.requireNonNullNorEmpty(to,"Encrypted OpenPGP content elements must have at least one 'to' attribute."),new Date(),payload);
    this.rpad=createRandomPadding();
  }
  private static String createRandomPadding(){
    int len=RandomUtil.nextSecureRandomInt(256);
    return StringUtils.randomString(len);
  }
  @Override protected void addCommonXml(  XmlStringBuilder xml){
    super.addCommonXml(xml);
    xml.openElement("rpad").escape(rpad).closeElement("rpad");
  }
}
