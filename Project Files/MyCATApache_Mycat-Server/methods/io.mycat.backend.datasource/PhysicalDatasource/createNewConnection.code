private void createNewConnection(final ResponseHandler handler,final Object attachment,final String schema) throws IOException {
  final AtomicBoolean hasError=new AtomicBoolean(false);
  MycatServer.getInstance().getBusinessExecutor().execute(new Runnable(){
    public void run(){
      try {
        createNewConnection(new DelegateResponseHandler(handler){
          @Override public void connectionError(          Throwable e,          BackendConnection conn){
            if (hasError.compareAndSet(false,true)) {
              handler.connectionError(e,conn);
            }
 else {
              LOGGER.info("connection connectionError ");
            }
          }
          @Override public void connectionAcquired(          BackendConnection conn){
            LOGGER.info("connection id is " + conn.getId());
            takeCon(conn,handler,attachment,schema);
          }
        }
,schema);
      }
 catch (      IOException e) {
        if (hasError.compareAndSet(false,true)) {
          handler.connectionError(e,null);
        }
 else {
          LOGGER.info("connection connectionError ");
        }
      }
    }
  }
);
}
/** 
 * 创建新连接
 */
public abstract void createNewConnection(ResponseHandler handler,String schema) throws IOException ;
