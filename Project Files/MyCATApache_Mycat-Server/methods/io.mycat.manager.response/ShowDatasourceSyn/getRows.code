private static List<RowDataPacket> getRows(String charset){
  List<RowDataPacket> list=new LinkedList<RowDataPacket>();
  MycatConfig conf=MycatServer.getInstance().getConfig();
  Map<String,PhysicalDBPool> dataHosts=conf.getDataHosts();
  for (  PhysicalDBPool pool : dataHosts.values()) {
    for (    PhysicalDatasource ds : pool.getAllDataSources()) {
      DBHeartbeat hb=ds.getHeartbeat();
      DataSourceSyncRecorder record=hb.getAsynRecorder();
      Map<String,String> states=record.getRecords();
      RowDataPacket row=new RowDataPacket(FIELD_COUNT);
      if (!states.isEmpty()) {
        row.add(StringUtil.encode(ds.getName(),charset));
        row.add(StringUtil.encode(ds.getConfig().getIp(),charset));
        row.add(LongUtil.toBytes(ds.getConfig().getPort()));
        row.add(StringUtil.encode(states.get("Master_Host"),charset));
        row.add(LongUtil.toBytes(Long.valueOf(states.get("Master_Port"))));
        row.add(StringUtil.encode(states.get("Master_Use"),charset));
        String secords=states.get("Seconds_Behind_Master");
        row.add(secords == null ? null : LongUtil.toBytes(Long.valueOf(secords)));
        row.add(StringUtil.encode(states.get("Slave_IO_Running"),charset));
        row.add(StringUtil.encode(states.get("Slave_SQL_Running"),charset));
        row.add(StringUtil.encode(states.get("Slave_IO_State"),charset));
        row.add(LongUtil.toBytes(Long.valueOf(states.get("Connect_Retry"))));
        row.add(StringUtil.encode(states.get("Last_IO_Error"),charset));
        row.add(StringUtil.encode(states.get("Last_SQL_Error"),charset));
        row.add(LongUtil.toBytes(Long.valueOf(states.get("Last_SQL_Errno"))));
        list.add(row);
      }
    }
  }
  return list;
}
