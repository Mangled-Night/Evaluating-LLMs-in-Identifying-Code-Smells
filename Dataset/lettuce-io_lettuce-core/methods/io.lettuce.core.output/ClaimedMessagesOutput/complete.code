@Override public void complete(int depth){
  if (depth == 3 && bodyReceived) {
    messages.add(new StreamMessage<>(stream,id,body == null ? Collections.emptyMap() : body));
    bodyReceived=false;
    key=null;
    body=null;
    id=null;
  }
  if (depth == 2 && justId) {
    messages.add(new StreamMessage<>(stream,id,null));
    key=null;
    body=null;
    id=null;
  }
  if (depth == 0) {
    output=new ClaimedMessages<>(startId,Collections.unmodifiableList(messages));
  }
}
