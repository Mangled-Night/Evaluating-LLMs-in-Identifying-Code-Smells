private byte[] mertFields(byte[] bs,byte[] bs2,int colType,int mergeType) throws UnsupportedEncodingException {
  if (bs2 == null || bs2.length == 0) {
    return bs;
  }
 else   if (bs == null || bs.length == 0) {
    return bs2;
  }
switch (mergeType) {
case MergeCol.MERGE_SUM:
    if (colType == ColMeta.COL_TYPE_DOUBLE || colType == ColMeta.COL_TYPE_FLOAT) {
      double value=BytesTools.getDouble(bs) + BytesTools.getDouble(bs2);
      return BytesTools.double2Bytes(value);
    }
 else     if (colType == ColMeta.COL_TYPE_NEWDECIMAL || colType == ColMeta.COL_TYPE_DECIMAL) {
      BigDecimal decimal=new BigDecimal(new String(bs));
      decimal=decimal.add(new BigDecimal(new String(bs2)));
      return decimal.toString().getBytes();
    }
case MergeCol.MERGE_COUNT:
{
    long s1=BytesTools.getLong(bs);
    long s2=BytesTools.getLong(bs2);
    long total=s1 + s2;
    return BytesTools.long2Bytes(total);
  }
case MergeCol.MERGE_MAX:
{
  int compare=ByteUtil.compareNumberByte(bs,bs2);
  return (compare > 0) ? bs : bs2;
}
case MergeCol.MERGE_MIN:
{
int compare=ByteUtil.compareNumberByte(bs,bs2);
return (compare > 0) ? bs2 : bs;
}
case MergeCol.MERGE_AVG:
{
long count=BytesTools.getLong(bs2);
if (colType == ColMeta.COL_TYPE_DOUBLE || colType == ColMeta.COL_TYPE_FLOAT) {
double sum=BytesTools.getDouble(bs);
double value=sum / count;
return BytesTools.double2Bytes(value);
}
 else if (colType == ColMeta.COL_TYPE_NEWDECIMAL || colType == ColMeta.COL_TYPE_DECIMAL) {
BigDecimal sum=new BigDecimal(new String(bs));
BigDecimal avg=sum.divide(new BigDecimal(count),sum.scale() + 4,RoundingMode.HALF_UP);
return avg.toString().getBytes();
}
}
default :
return null;
}
}
