public final class WebSocketRemoteConnectionEndpointLookup {
  public static Result lookup(  DomainBareJid domainBareJid){
    List<RemoteConnectionEndpointLookupFailure> lookupFailures=new ArrayList<>(1);
    List<URI> rcUriList=null;
    try {
      rcUriList=HttpLookupMethod.lookup(domainBareJid,LinkRelation.WEBSOCKET);
    }
 catch (    IOException|XmlPullParserException|URISyntaxException e) {
      lookupFailures.add(new RemoteConnectionEndpointLookupFailure.HttpLookupFailure(domainBareJid,e));
      return new Result(lookupFailures);
    }
    List<SecureWebSocketRemoteConnectionEndpoint> discoveredSecureEndpoints=new ArrayList<>(rcUriList.size());
    List<InsecureWebSocketRemoteConnectionEndpoint> discoveredInsecureEndpoints=new ArrayList<>(rcUriList.size());
    for (    URI webSocketUri : rcUriList) {
      WebSocketRemoteConnectionEndpoint wsRce=WebSocketRemoteConnectionEndpoint.from(webSocketUri);
      if (wsRce instanceof SecureWebSocketRemoteConnectionEndpoint) {
        SecureWebSocketRemoteConnectionEndpoint secureWsRce=(SecureWebSocketRemoteConnectionEndpoint)wsRce;
        discoveredSecureEndpoints.add(secureWsRce);
      }
 else       if (wsRce instanceof InsecureWebSocketRemoteConnectionEndpoint) {
        InsecureWebSocketRemoteConnectionEndpoint insecureWsRce=(InsecureWebSocketRemoteConnectionEndpoint)wsRce;
        discoveredInsecureEndpoints.add(insecureWsRce);
      }
 else {
        throw new AssertionError();
      }
    }
    return new Result(discoveredSecureEndpoints,discoveredInsecureEndpoints,lookupFailures);
  }
public static final class Result {
    public final List<SecureWebSocketRemoteConnectionEndpoint> discoveredSecureEndpoints;
    public final List<InsecureWebSocketRemoteConnectionEndpoint> discoveredInsecureEndpoints;
    public final List<RemoteConnectionEndpointLookupFailure> lookupFailures;
    public Result(){
      this(Collections.emptyList());
    }
    public Result(    List<RemoteConnectionEndpointLookupFailure> lookupFailures){
      this(new ArrayList<>(1),new ArrayList<>(1),lookupFailures);
    }
    public Result(    List<SecureWebSocketRemoteConnectionEndpoint> discoveredSecureEndpoints,    List<InsecureWebSocketRemoteConnectionEndpoint> discoveredInsecureEndpoints,    List<RemoteConnectionEndpointLookupFailure> lookupFailures){
      this.discoveredSecureEndpoints=discoveredSecureEndpoints;
      this.discoveredInsecureEndpoints=discoveredInsecureEndpoints;
      this.lookupFailures=lookupFailures;
    }
    public boolean isEmpty(){
      return discoveredSecureEndpoints.isEmpty() && discoveredInsecureEndpoints.isEmpty();
    }
    public int discoveredEndpointCount(){
      return discoveredSecureEndpoints.size() + discoveredInsecureEndpoints.size();
    }
    public List<SecureWebSocketRemoteConnectionEndpoint> getDiscoveredSecureRemoteConnectionEndpoints(){
      return discoveredSecureEndpoints;
    }
    public List<InsecureWebSocketRemoteConnectionEndpoint> getDiscoveredInsecureRemoteConnectionEndpoints(){
      return discoveredInsecureEndpoints;
    }
    public List<RemoteConnectionEndpointLookupFailure> getLookupFailures(){
      return lookupFailures;
    }
  }
}
