/** 
 * Reverts writes that havenâ€™t been flushed yet. Callers should invoke this function when there are runtime exceptions. This method will not throw, though it may be unsuccessful in truncating written data.
 * @return the file that this DiskRowWriter wrote to.
 */
public File revertPartialWritesAndClose() throws IOException {
  try {
    if (initialized) {
      objOut.flush();
      bs.flush();
      close();
    }
    FileOutputStream truncateStream=new FileOutputStream(file,true);
    try {
      truncateStream.getChannel().truncate(initialPosition);
      return file;
    }
  finally {
      truncateStream.close();
    }
  }
 catch (  Exception e) {
    LOG.error(e.getMessage());
    return file;
  }
}
