/** 
 * Preprocesses the pattern string.
 * @param pat the pattern string
 */
public KMP(String pat){
  this.R=256;
  this.m=pat.length();
  dfa=new int[R][m];
  dfa[pat.charAt(0)][0]=1;
  for (int x=0, j=1; j < m; j++) {
    for (int c=0; c < R; c++)     dfa[c][j]=dfa[c][x];
    dfa[pat.charAt(j)][j]=j + 1;
    x=dfa[pat.charAt(j)][x];
  }
}
/** 
 * Preprocesses the pattern string.
 * @param pattern the pattern string
 * @param R the alphabet size
 */
public KMP(char[] pattern,int R){
  this.R=R;
  this.m=pattern.length;
  int m=pattern.length;
  dfa=new int[R][m];
  dfa[pattern[0]][0]=1;
  for (int x=0, j=1; j < m; j++) {
    for (int c=0; c < R; c++)     dfa[c][j]=dfa[c][x];
    dfa[pattern[j]][j]=j + 1;
    x=dfa[pattern[j]][x];
  }
}
