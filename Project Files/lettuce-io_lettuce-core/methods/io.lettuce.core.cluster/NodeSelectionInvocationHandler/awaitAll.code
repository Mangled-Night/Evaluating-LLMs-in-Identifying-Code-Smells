@SuppressWarnings("rawtypes") private static boolean awaitAll(long timeout,TimeUnit unit,Collection<CompletionStage<?>> stages){
  CompletableFuture[] futures=new CompletableFuture[stages.size()];
  int i=0;
  for (  CompletionStage<?> completableFuture : stages) {
    futures[i++]=completableFuture.toCompletableFuture();
  }
  return Futures.awaitAll(timeout,unit,futures);
}
