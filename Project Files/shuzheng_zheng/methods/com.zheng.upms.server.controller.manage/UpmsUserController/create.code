@ApiOperation(value="新增用户") @RequiresPermissions("upms:user:create") @RequestMapping(value="/create",method=RequestMethod.GET) public String create(){
  return "/manage/user/create.jsp";
}
@ApiOperation(value="新增用户") @RequiresPermissions("upms:user:create") @ResponseBody @RequestMapping(value="/create",method=RequestMethod.POST) public Object create(UpmsUser upmsUser){
  ComplexResult result=FluentValidator.checkAll().on(upmsUser.getUsername(),new LengthValidator(1,20,"帐号")).on(upmsUser.getPassword(),new LengthValidator(5,32,"密码")).on(upmsUser.getRealname(),new NotNullValidator("姓名")).doValidate().result(ResultCollectors.toComplex());
  if (!result.isSuccess()) {
    return new UpmsResult(UpmsResultConstant.INVALID_LENGTH,result.getErrors());
  }
  long time=System.currentTimeMillis();
  String salt=UUID.randomUUID().toString().replaceAll("-","");
  upmsUser.setSalt(salt);
  upmsUser.setPassword(MD5Util.md5(upmsUser.getPassword() + upmsUser.getSalt()));
  upmsUser.setCtime(time);
  upmsUser=upmsUserService.createUser(upmsUser);
  if (null == upmsUser) {
    return new UpmsResult(UpmsResultConstant.FAILED,"帐号名已存在！");
  }
  LOGGER.info("新增用户，主键：userId={}",upmsUser.getUserId());
  return new UpmsResult(UpmsResultConstant.SUCCESS,1);
}
