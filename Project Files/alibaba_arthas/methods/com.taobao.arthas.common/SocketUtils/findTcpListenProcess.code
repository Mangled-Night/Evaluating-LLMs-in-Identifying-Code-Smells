public static long findTcpListenProcess(int port){
  try {
    if (OSUtils.isWindows()) {
      String[] command={"netstat","-ano","-p","TCP"};
      List<String> lines=ExecutingCommand.runNative(command);
      for (      String line : lines) {
        if (line.contains("LISTENING")) {
          String[] strings=line.trim().split("\\s+");
          if (strings.length == 5) {
            if (strings[1].endsWith(":" + port)) {
              return Long.parseLong(strings[4]);
            }
          }
        }
      }
    }
    if (OSUtils.isLinux() || OSUtils.isMac()) {
      String pid=ExecutingCommand.getFirstAnswer("lsof -t -s TCP:LISTEN -i TCP:" + port);
      if (!pid.trim().isEmpty()) {
        return Long.parseLong(pid);
      }
    }
  }
 catch (  Throwable e) {
  }
  return -1;
}
