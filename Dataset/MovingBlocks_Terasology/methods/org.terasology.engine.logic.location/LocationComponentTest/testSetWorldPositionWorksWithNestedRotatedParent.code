@Test public void testSetWorldPositionWorksWithNestedRotatedParent(){
  LocationComponent first=new LocationComponent();
  EntityRef firstEntity=createFakeEntityWith(first);
  LocationComponent second=new LocationComponent();
  EntityRef secondEntity=createFakeEntityWith(second);
  LocationComponent third=new LocationComponent();
  EntityRef thirdEntity=createFakeEntityWith(third);
  Location.attachChild(firstEntity,secondEntity);
  second.setLocalPosition(new Vector3f(1,0,0));
  first.setLocalRotation(yawRotation);
  assertEquals(new Vector3f(0,0,-1),second.getWorldPosition(new Vector3f()),0.000001f);
  Location.attachChild(secondEntity,thirdEntity);
  second.setLocalRotation(pitchRotation);
  third.setLocalPosition(new Vector3f(0,0,0));
  assertEquals(new Vector3f(0,0,-1),third.getWorldPosition(new Vector3f()),0.000001f);
  third.setLocalPosition(new Vector3f(0,0,1));
  assertEquals(new Vector3f(0.5f * (float)Math.sqrt(2),-0.5f * (float)Math.sqrt(2),-1),third.getWorldPosition(new Vector3f()),0.000001f);
}
