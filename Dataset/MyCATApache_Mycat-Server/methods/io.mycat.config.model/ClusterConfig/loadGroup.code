private static Map<String,List<String>> loadGroup(Element root,Map<String,MycatNodeConfig> nodes){
  Map<String,List<String>> groups=new HashMap<String,List<String>>();
  NodeList list=root.getElementsByTagName("group");
  for (int i=0, n=list.getLength(); i < n; i++) {
    Node node=list.item(i);
    if (node instanceof Element) {
      Element e=(Element)node;
      String groupName=e.getAttribute("name").trim();
      if (groups.containsKey(groupName)) {
        throw new ConfigException("group duplicated : " + groupName);
      }
      Map<String,Object> props=ConfigUtil.loadElements(e);
      String value=(String)props.get("nodeList");
      if (null == value || "".equals(value)) {
        throw new ConfigException("group should contain 'nodeList'");
      }
      String[] sList=SplitUtil.split(value,',',true);
      if (null == sList || sList.length == 0) {
        throw new ConfigException("group should contain 'nodeList'");
      }
      for (      String s : sList) {
        if (!nodes.containsKey(s)) {
          throw new ConfigException("[ node :" + s + "] in [ group:"+ groupName+ "] doesn't exist!");
        }
      }
      List<String> nodeList=Arrays.asList(sList);
      groups.put(groupName,nodeList);
    }
  }
  if (!groups.containsKey("default")) {
    List<String> nodeList=new ArrayList<String>(nodes.keySet());
    groups.put("default",nodeList);
  }
  return groups;
}
