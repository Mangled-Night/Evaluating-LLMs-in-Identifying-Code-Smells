@Override public Duration createDelay(long attempt){
  long upperTarget=targetTimeUnit.convert(upper.toNanos(),TimeUnit.NANOSECONDS);
  long upperBase=base * calculatePowerOfTwo(attempt);
  long temp=Math.min(upperTarget,0 > upperBase ? upperTarget : upperBase);
  long delay=temp / 2 + randomBetween(0,temp / 2);
  return applyBounds(Duration.ofNanos(targetTimeUnit.toNanos(delay)));
}
