/** 
 * Computes a shortest paths tree from each vertex to every other vertex in the edge-weighted digraph  {@code G}. If no such shortest path exists for some pair of vertices, it computes a negative cycle.
 * @param G the edge-weighted digraph
 */
public FloydWarshall(AdjMatrixEdgeWeightedDigraph G){
  int V=G.V();
  distTo=new double[V][V];
  edgeTo=new DirectedEdge[V][V];
  for (int v=0; v < V; v++) {
    for (int w=0; w < V; w++) {
      distTo[v][w]=Double.POSITIVE_INFINITY;
    }
  }
  for (int v=0; v < G.V(); v++) {
    for (    DirectedEdge e : G.adj(v)) {
      distTo[e.from()][e.to()]=e.weight();
      edgeTo[e.from()][e.to()]=e;
    }
    if (distTo[v][v] >= 0.0) {
      distTo[v][v]=0.0;
      edgeTo[v][v]=null;
    }
  }
  for (int i=0; i < V; i++) {
    for (int v=0; v < V; v++) {
      if (edgeTo[v][i] == null)       continue;
      for (int w=0; w < V; w++) {
        if (distTo[v][w] > distTo[v][i] + distTo[i][w]) {
          distTo[v][w]=distTo[v][i] + distTo[i][w];
          edgeTo[v][w]=edgeTo[i][w];
        }
      }
      if (distTo[v][v] < 0.0) {
        hasNegativeCycle=true;
        return;
      }
    }
  }
  assert check(G);
}
