public void testASync(final TransportCandidate transportCandidate,final String password){
  Thread thread=new Thread(new Runnable(){
    @Override public void run(){
      DatagramListener listener=new DatagramListener(){
        @Override public boolean datagramReceived(        DatagramPacket datagramPacket){
          try {
            LOGGER.fine("ECHO Received to: " + candidate.getIp() + ":"+ candidate.getPort()+ "  data: "+ new String(datagramPacket.getData(),"UTF-8"));
            String[] str=new String(datagramPacket.getData(),"UTF-8").split(";");
            String pass=str[0];
            String[] addr=str[1].split(":");
            String ip=addr[0];
            String pt=addr[1];
            if (pass.equals(password) && transportCandidate.getIp().indexOf(ip) != -1 && transportCandidate.getPort() == Integer.parseInt(pt)) {
              LOGGER.fine("ECHO OK: " + candidate.getIp() + ":"+ candidate.getPort()+ " <-> "+ transportCandidate.getIp()+ ":"+ transportCandidate.getPort());
              TestResult testResult=new TestResult();
              testResult.setResult(true);
              ended=true;
              fireTestResult(testResult,transportCandidate);
              return true;
            }
          }
 catch (          UnsupportedEncodingException e) {
            LOGGER.log(Level.WARNING,"exception",e);
          }
          LOGGER.fine("ECHO Wrong Data: " + datagramPacket.getAddress().getHostAddress() + ":"+ datagramPacket.getPort());
          return false;
        }
      }
;
      addListener(listener);
      byte[] content=null;
      try {
        content=new String(password + ";" + getIp()+ ":"+ getPort()).getBytes("UTF-8");
      }
 catch (      UnsupportedEncodingException e) {
        LOGGER.log(Level.WARNING,"exception",e);
      }
      DatagramPacket packet=new DatagramPacket(content,content.length);
      try {
        packet.setAddress(InetAddress.getByName(transportCandidate.getIp()));
      }
 catch (      UnknownHostException e) {
        LOGGER.log(Level.WARNING,"exception",e);
      }
      packet.setPort(transportCandidate.getPort());
      long delay=200;
      try {
        for (int i=0; i < tries; i++) {
          socket.send(packet);
          if (ended)           break;
          try {
            Thread.sleep(delay);
          }
 catch (          InterruptedException e) {
            LOGGER.log(Level.WARNING,"exception",e);
          }
        }
      }
 catch (      IOException e) {
      }
      try {
        Thread.sleep(2000);
      }
 catch (      InterruptedException e) {
        LOGGER.log(Level.WARNING,"exception",e);
      }
      removeListener(listener);
    }
  }
);
  thread.start();
}
