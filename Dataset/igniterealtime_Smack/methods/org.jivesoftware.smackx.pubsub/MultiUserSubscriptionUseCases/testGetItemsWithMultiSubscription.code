public void testGetItemsWithMultiSubscription() throws XMPPException {
  LeafNode node=getRandomPubnode(getManager(0),true,false);
  node.send((Item)null);
  node.send((Item)null);
  node.send((Item)null);
  node.send((Item)null);
  node.send((Item)null);
  LeafNode user2Node=(LeafNode)getManager(1).getNode(node.getId());
  Subscription sub1=user2Node.subscribe(getBareJID(1));
  Subscription sub2=user2Node.subscribe(getBareJID(1));
  try {
    user2Node.getItems();
  }
 catch (  XMPPException exc) {
    assertEquals("bad-request",exc.getStanzaError().getCondition());
    assertEquals(XMPPError.Type.MODIFY,exc.getStanzaError().getType());
  }
  List<Item> items=user2Node.getItems(sub1.getId());
  assertTrue(items.size() == 5);
}
