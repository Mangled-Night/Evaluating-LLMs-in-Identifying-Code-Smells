@Override public RedisFuture<Boolean> msetnx(Map<K,V> map){
  Map<Integer,List<K>> partitioned=SlotHash.partition(codec,map.keySet());
  if (partitioned.size() < 2) {
    return super.msetnx(map);
  }
  Map<Integer,RedisFuture<Boolean>> executions=new HashMap<>();
  for (  Map.Entry<Integer,List<K>> entry : partitioned.entrySet()) {
    Map<K,V> op=new HashMap<>();
    entry.getValue().forEach(k -> op.put(k,map.get(k)));
    RedisFuture<Boolean> msetnx=super.msetnx(op);
    executions.put(entry.getKey(),msetnx);
  }
  return new PipelinedRedisFuture<>(executions,objectPipelinedRedisFuture -> {
    for (    RedisFuture<Boolean> listRedisFuture : executions.values()) {
      Boolean b=MultiNodeExecution.execute(() -> listRedisFuture.get());
      if (b == null || !b) {
        return false;
      }
    }
    return !executions.isEmpty();
  }
);
}
