@Test void script() throws InterruptedException {
  assertThat(redis.scriptFlush()).isEqualTo("OK");
  String script1="return 1 + 1";
  String digest1=redis.digest(script1);
  String script2="return 1 + 1 == 4";
  String digest2=redis.digest(script2);
  assertThat(redis.scriptExists(digest1,digest2)).isEqualTo(list(false,false));
  assertThat(redis.scriptLoad(script1)).isEqualTo(digest1);
  assertThat((Object)redis.evalsha(digest1,INTEGER)).isEqualTo(2L);
  assertThat(redis.scriptExists(digest1,digest2)).isEqualTo(list(true,false));
  assertThat(redis.scriptFlush()).isEqualTo("OK");
  assertThat(redis.scriptExists(digest1,digest2)).isEqualTo(list(false,false));
  redis.configSet("lua-time-limit","10");
  StatefulRedisConnection<String,String> connection=client.connect();
  try {
    connection.async().eval("while true do end",STATUS,new String[0]).await(100,TimeUnit.MILLISECONDS);
    assertThat(redis.scriptKill()).isEqualTo("OK");
  }
  finally {
    connection.close();
  }
}
