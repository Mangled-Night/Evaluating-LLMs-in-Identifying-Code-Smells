private boolean shardColCanBeUpdated(SQLExpr whereClauseExpr,String column,SQLExpr value,boolean hasOR) throws SQLNonTransientException {
  boolean canUpdate=false;
  boolean parentHasOR=false;
  if (whereClauseExpr == null)   return false;
  if (whereClauseExpr instanceof SQLBinaryOpExpr) {
    SQLBinaryOpExpr nodeOpExpr=(SQLBinaryOpExpr)whereClauseExpr;
    if ((nodeOpExpr.getOperator() == SQLBinaryOperator.BooleanOr) || (nodeOpExpr.getOperator() == SQLBinaryOperator.BooleanXor)) {
      parentHasOR=true;
    }
    if (nodeOpExpr.getOperator() == SQLBinaryOperator.Equality) {
      boolean foundCol;
      SQLExpr leftExpr=nodeOpExpr.getLeft();
      SQLExpr rightExpr=nodeOpExpr.getRight();
      foundCol=columnInExpr(leftExpr,column);
      if (foundCol) {
        if (rightExpr.getClass() != value.getClass()) {
          throw new SQLNonTransientException("SQL AST nodes type mismatch!");
        }
        canUpdate=rightExpr.toString().equals(value.toString()) && (!hasOR) && (!parentHasOR);
      }
    }
 else     if (nodeOpExpr.getOperator().isLogical()) {
      if (nodeOpExpr.getLeft() != null) {
        if (nodeOpExpr.getLeft() instanceof SQLBinaryOpExpr) {
          canUpdate=shardColCanBeUpdated(nodeOpExpr.getLeft(),column,value,parentHasOR);
        }
      }
      if ((!canUpdate) && nodeOpExpr.getRight() != null) {
        if (nodeOpExpr.getRight() instanceof SQLBinaryOpExpr) {
          canUpdate=shardColCanBeUpdated(nodeOpExpr.getRight(),column,value,parentHasOR);
        }
      }
    }
 else     if (isSubQueryClause(nodeOpExpr)) {
      return false;
    }
  }
  return canUpdate;
}
