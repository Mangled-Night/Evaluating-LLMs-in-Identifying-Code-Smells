@Override protected void handleData(byte[] data){
  ByteBuffer theBuf=null;
  try {
    theBuf=source.allocate();
    theBuf.put(data);
switch (source.getState()) {
case connecting:
{
        doConnecting(source,theBuf,0,data.length);
        return;
      }
case connected:
{
      try {
        doHandleBusinessMsg(source,theBuf,0,data.length);
      }
 catch (      Exception e) {
        LOGGER.warn("caught err of con " + source,e);
      }
      return;
    }
default :
  LOGGER.warn("not handled connecton state  err " + source.getState() + " for con "+ source);
break;
}
}
 catch (Exception e) {
LOGGER.error("读取数据包出错",e);
}
 finally {
if (theBuf != null) {
source.recycle(theBuf);
}
}
}
