private void generateBucketMap(){
  hash=Hashing.murmur3_32(seed);
  for (int i=0; i < count; i++) {
    StringBuilder hashName=new StringBuilder("SHARD-").append(i);
    for (int n=0, shard=virtualBucketTimes * getWeight(i); n < shard; n++) {
      bucketMap.put(hash.hashUnencodedChars(hashName.append("-NODE-").append(n)).asInt(),i);
    }
  }
  weightMap=null;
}
