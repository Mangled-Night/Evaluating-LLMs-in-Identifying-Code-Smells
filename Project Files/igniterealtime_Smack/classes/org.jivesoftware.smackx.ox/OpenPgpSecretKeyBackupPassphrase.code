/** 
 * Represents a secret key backup passphrase whose format is described in XEP-0373 ยง5.3.
 * @see <a href="https://xmpp.org/extensions/xep-0373.html#backup-encryption">
 *      XEP-0373 ยง5.4 Encrypting the Secret Key Backup</a>
 */
public class OpenPgpSecretKeyBackupPassphrase implements CharSequence {
  private static final Pattern PASSPHRASE_PATTERN=Pattern.compile("^([" + UNAMBIGUOUS_NUMBERS_AND_LETTERS_STRING + "]{4}-){5}"+ "["+ UNAMBIGUOUS_NUMBERS_AND_LETTERS_STRING+ "]{4}$");
  private final String passphrase;
  public OpenPgpSecretKeyBackupPassphrase(  String passphrase){
    if (!PASSPHRASE_PATTERN.matcher(passphrase).matches()) {
      throw new IllegalArgumentException("Passphrase must be 24 upper case letters and numbers from the english " + "alphabet without 'O' and '0', divided into blocks of 4 and separated with dashes ('-').");
    }
    this.passphrase=passphrase;
  }
  @Override public int length(){
    return passphrase.length();
  }
  @Override public char charAt(  int i){
    return passphrase.charAt(i);
  }
  @Override public CharSequence subSequence(  int i,  int i1){
    return passphrase.subSequence(i,i1);
  }
  @Override public String toString(){
    return passphrase;
  }
}
