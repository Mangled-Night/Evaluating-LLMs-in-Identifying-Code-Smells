/** 
 * @author hengyunabc 2020-10-27
 */
@Configuration @AutoConfigureAfter(RedisAutoConfiguration.class) public class TunnelServerConfiguration {
  @Autowired ArthasProperties arthasProperties;
  @Bean(initMethod="start",destroyMethod="stop") @ConditionalOnMissingBean public TunnelServer tunnelServer(  @Autowired(required=false) TunnelClusterStore tunnelClusterStore){
    TunnelServer tunnelServer=new TunnelServer();
    tunnelServer.setHost(arthasProperties.getServer().getHost());
    tunnelServer.setPort(arthasProperties.getServer().getPort());
    tunnelServer.setSsl(arthasProperties.getServer().isSsl());
    tunnelServer.setPath(arthasProperties.getServer().getPath());
    tunnelServer.setClientConnectHost(arthasProperties.getServer().getClientConnectHost());
    if (tunnelClusterStore != null) {
      tunnelServer.setTunnelClusterStore(tunnelClusterStore);
    }
    return tunnelServer;
  }
}
