@Override public void run(){
  if (tableInfo.isError()) {
    return;
  }
  long[] count=new long[newDnSize];
  int page=0;
  List<Map<String,Object>> list=null;
  Connection con=null;
  try {
    con=DataMigratorUtil.getMysqlConnection(srcDn);
    createTempFiles();
    list=DataMigratorUtil.executeQuery(con,"select " + column + " from "+ tableName+ " limit ?,?",page++ * pageSize,pageSize);
    int total=0;
    while (!CollectionUtil.isEmpty(list)) {
      if (tableInfo.isError()) {
        return;
      }
      flushData(false);
      for (int i=0, l=list.size(); i < l; i++) {
        Map<String,Object> sf=list.get(i);
        Object objFieldVal=sf.get(column);
        String filedVal=objFieldVal.toString();
        if (objFieldVal instanceof String) {
          filedVal="'" + filedVal + "'";
        }
        Integer newIndex=alg.calculate(StringUtil.removeBackquote(objFieldVal.toString()));
        total++;
        DataNode newDn=newDnList.get(newIndex);
        if (!srcDn.equals(newDn)) {
          count[newIndex]++;
          map.get(newDn).append(filedVal + ",");
        }
      }
      list=DataMigratorUtil.executeQuery(con,"select " + column + " from "+ tableName+ " limit ?,?",page++ * pageSize,pageSize);
    }
    flushData(true);
    statisticalData(total,count);
  }
 catch (  Exception e) {
    String message="[" + tableInfo.getSchemaName() + ":"+ tableName+ "]  src dataNode: "+ srcDn.getUrl()+ " prepare temp files is failed! this table's migrator will exit! "+ e.getMessage();
    tableInfo.setError(true);
    tableInfo.setErrMessage(message);
    System.out.println(message);
    LOGGER.error(message,e);
  }
 finally {
    JdbcUtils.close(con);
  }
}
