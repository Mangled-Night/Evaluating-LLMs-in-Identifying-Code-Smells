public class FailureProviderTest {
  @Test public void simpleFailureTest() throws Exception {
    final String xml="<failure xmlns='http://jabber.org/protocol/compress'><processing-failed/></failure>";
    final XmlPullParser parser=PacketParserUtils.getParserFor(xml);
    final Failure failure=FailureProvider.INSTANCE.parse(parser);
    assertEquals(Failure.CompressFailureError.processing_failed,failure.getCompressFailureError());
  }
  @Test public void withStanzaErrrorFailureTest() throws Exception {
    final String xml="<failure xmlns='http://jabber.org/protocol/compress'>" + "<setup-failed/>" + "<error xmlns='jabber:client' type='modify'>"+ "<bad-request xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/>"+ "</error>"+ "</failure>";
    final XmlPullParser parser=PacketParserUtils.getParserFor(xml);
    final Failure failure=FailureProvider.INSTANCE.parse(parser);
    assertEquals(Failure.CompressFailureError.setup_failed,failure.getCompressFailureError());
    final StanzaError error=failure.getStanzaError();
    assertEquals(Condition.bad_request,error.getCondition());
  }
}
