/** 
 * 执行lock tables语句方法
 * @author songdabin
 * @date 2016-7-9
 * @param rrs
 */
public void lockTable(RouteResultset rrs){
  RouteResultsetNode[] nodes=rrs.getNodes();
  if (nodes == null || nodes.length == 0 || nodes[0].getName() == null || nodes[0].getName().equals("")) {
    source.writeErrMessage(ErrorCode.ER_NO_DB_ERROR,"No dataNode found ,please check tables defined in schema:" + source.getSchema());
    return;
  }
  LockTablesHandler handler=new LockTablesHandler(this,rrs);
  source.setLocked(true);
  try {
    handler.execute();
  }
 catch (  Exception e) {
    LOGGER.warn(new StringBuilder().append(source).append(rrs).toString(),e);
    source.writeErrMessage(ErrorCode.ERR_HANDLE_DATA,e.toString());
  }
}
