/** 
 * 从RowDataPacket的fieldValue的数据转化成BinaryRowDataPacket的fieldValue数据
 * @param fv
 * @param fieldPk
 */
private void convert(byte[] fv,FieldPacket fieldPk){
  int fieldType=fieldPk.type;
switch (fieldType) {
case Fields.FIELD_TYPE_STRING:
case Fields.FIELD_TYPE_VARCHAR:
case Fields.FIELD_TYPE_VAR_STRING:
case Fields.FIELD_TYPE_ENUM:
case Fields.FIELD_TYPE_SET:
case Fields.FIELD_TYPE_LONG_BLOB:
case Fields.FIELD_TYPE_MEDIUM_BLOB:
case Fields.FIELD_TYPE_BLOB:
case Fields.FIELD_TYPE_TINY_BLOB:
case Fields.FIELD_TYPE_GEOMETRY:
case Fields.FIELD_TYPE_BIT:
case Fields.FIELD_TYPE_DECIMAL:
case Fields.FIELD_TYPE_NEW_DECIMAL:
    this.fieldValues.add(fv);
  break;
case Fields.FIELD_TYPE_LONGLONG:
long longVar=ByteUtil.getLong(fv);
this.fieldValues.add(ByteUtil.getBytes(longVar));
break;
case Fields.FIELD_TYPE_LONG:
case Fields.FIELD_TYPE_INT24:
int intVar=ByteUtil.getInt(fv);
this.fieldValues.add(ByteUtil.getBytes(intVar));
break;
case Fields.FIELD_TYPE_SHORT:
case Fields.FIELD_TYPE_YEAR:
if (isUnsignedField(fieldPk)) {
this.fieldValues.add(ByteUtil.convertUnsignedShort2Binary(fv));
}
 else {
short shortVar=ByteUtil.getShort(fv);
this.fieldValues.add(ByteUtil.getBytes(shortVar));
}
break;
case Fields.FIELD_TYPE_TINY:
int tinyVar=ByteUtil.getInt(fv);
byte[] bytes=new byte[1];
bytes[0]=(byte)tinyVar;
this.fieldValues.add(bytes);
break;
case Fields.FIELD_TYPE_DOUBLE:
double doubleVar=ByteUtil.getDouble(fv);
this.fieldValues.add(ByteUtil.getBytes(doubleVar));
break;
case Fields.FIELD_TYPE_FLOAT:
float floatVar=ByteUtil.getFloat(fv);
this.fieldValues.add(ByteUtil.getBytes(floatVar));
break;
case Fields.FIELD_TYPE_DATE:
try {
Date dateVar=DateUtil.parseDate(ByteUtil.getDate(fv),DateUtil.DATE_PATTERN_ONLY_DATE);
this.fieldValues.add(ByteUtil.getBytes(dateVar,false));
}
 catch (org.joda.time.IllegalFieldValueException e1) {
this.fieldValues.add(ByteUtil.getBytes(new Date(0L),false));
}
catch (ParseException e) {
LOGGER.error("error",e);
}
break;
case Fields.FIELD_TYPE_DATETIME:
case Fields.FIELD_TYPE_TIMESTAMP:
String dateStr=ByteUtil.getDate(fv);
Date dateTimeVar=null;
try {
if (dateStr.indexOf(".") > 0) {
dateTimeVar=DateUtil.parseDate(dateStr,DateUtil.DATE_PATTERN_FULL);
this.fieldValues.add(ByteUtil.getBytes(dateTimeVar,false));
}
 else {
dateTimeVar=DateUtil.parseDate(dateStr,DateUtil.DEFAULT_DATE_PATTERN);
this.fieldValues.add(ByteUtil.getBytes(dateTimeVar,false));
}
}
 catch (org.joda.time.IllegalFieldValueException e1) {
this.fieldValues.add(ByteUtil.getBytes(new Date(0L),false));
}
catch (ParseException e) {
LOGGER.error("error",e);
}
break;
case Fields.FIELD_TYPE_TIME:
String timeStr=ByteUtil.getTime(fv);
Date timeVar=null;
try {
if (timeStr.indexOf(".") > 0) {
timeVar=DateUtil.parseDate(timeStr,DateUtil.TIME_PATTERN_FULL);
this.fieldValues.add(ByteUtil.getBytes(timeVar,true));
}
 else {
timeVar=DateUtil.parseDate(timeStr,DateUtil.DEFAULT_TIME_PATTERN);
this.fieldValues.add(ByteUtil.getBytes(timeVar,true));
}
}
 catch (org.joda.time.IllegalFieldValueException e1) {
this.fieldValues.add(ByteUtil.getBytes(new Date(0L),true));
}
catch (ParseException e) {
LOGGER.error("error",e);
}
break;
}
}
