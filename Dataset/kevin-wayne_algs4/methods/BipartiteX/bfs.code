private void bfs(Graph G,int s){
  Queue<Integer> q=new Queue<Integer>();
  color[s]=WHITE;
  marked[s]=true;
  q.enqueue(s);
  while (!q.isEmpty()) {
    int v=q.dequeue();
    for (    int w : G.adj(v)) {
      if (!marked[w]) {
        marked[w]=true;
        edgeTo[w]=v;
        color[w]=!color[v];
        q.enqueue(w);
      }
 else       if (color[w] == color[v]) {
        isBipartite=false;
        cycle=new Queue<Integer>();
        Stack<Integer> stack=new Stack<Integer>();
        int x=v, y=w;
        while (x != y) {
          stack.push(x);
          cycle.enqueue(y);
          x=edgeTo[x];
          y=edgeTo[y];
        }
        stack.push(x);
        while (!stack.isEmpty())         cycle.enqueue(stack.pop());
        cycle.enqueue(w);
        return;
      }
    }
  }
}
