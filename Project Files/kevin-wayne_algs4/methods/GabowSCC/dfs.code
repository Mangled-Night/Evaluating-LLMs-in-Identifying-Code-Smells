private void dfs(Digraph G,int v){
  marked[v]=true;
  preorder[v]=pre++;
  stack1.push(v);
  stack2.push(v);
  for (  int w : G.adj(v)) {
    if (!marked[w])     dfs(G,w);
 else     if (id[w] == -1) {
      while (preorder[stack2.peek()] > preorder[w])       stack2.pop();
    }
  }
  if (stack2.peek() == v) {
    stack2.pop();
    int w;
    do {
      w=stack1.pop();
      id[w]=count;
    }
 while (w != v);
    count++;
  }
}
