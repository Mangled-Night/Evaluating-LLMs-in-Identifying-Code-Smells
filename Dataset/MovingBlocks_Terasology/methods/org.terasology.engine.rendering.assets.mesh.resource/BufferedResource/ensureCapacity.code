/** 
 * ensure the buffer is large enough for the size requested.  {@link #inSize()} will use the current size if the buffer is already largerthen the requested size else the size is set to the requested
 * @param size the size of the buffer
 */
protected void ensureCapacity(int size){
  if (size > buffer.capacity()) {
    int newCap=Math.max(this.buffer.capacity() << 1,size);
    ByteBuffer newBuffer=BufferUtils.createByteBuffer(newCap);
    buffer.limit(this.inSize);
    buffer.position(0);
    newBuffer.put(buffer);
    this.buffer=newBuffer;
  }
  if (size > this.inSize) {
    this.inSize=size;
  }
  buffer.limit(inSize);
  mark();
}
