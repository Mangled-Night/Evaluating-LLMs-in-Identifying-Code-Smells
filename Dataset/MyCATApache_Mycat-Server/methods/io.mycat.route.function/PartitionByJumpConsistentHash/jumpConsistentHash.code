public static int jumpConsistentHash(final long key,final int buckets){
  checkBuckets(buckets);
  long k=key;
  long b=-1;
  long j=0;
  while (j < buckets) {
    b=j;
    k=k * CONSTANT + 1L;
    j=(long)((b + 1L) * (JUMP / toDouble((k >>> 33) + 1L)));
  }
  return (int)b;
}
