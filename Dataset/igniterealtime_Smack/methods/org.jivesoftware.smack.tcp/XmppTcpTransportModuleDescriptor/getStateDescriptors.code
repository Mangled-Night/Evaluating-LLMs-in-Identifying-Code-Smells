@Override protected Set<Class<? extends StateDescriptor>> getStateDescriptors(){
  Set<Class<? extends StateDescriptor>> res=new HashSet<>();
  res.add(EstablishingTcpConnectionStateDescriptor.class);
  if (startTls) {
    res.add(EstablishTlsStateDescriptor.class);
  }
  if (directTls) {
    throw new IllegalArgumentException("DirectTLS is not implemented yet");
  }
  return res;
}
