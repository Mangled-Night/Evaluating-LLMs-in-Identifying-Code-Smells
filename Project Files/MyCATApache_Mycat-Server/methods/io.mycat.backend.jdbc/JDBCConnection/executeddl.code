private void executeddl(ServerConnection sc,String sql) throws SQLException {
  Statement stmt=null;
  try {
    stmt=con.createStatement();
    int count=stmt.executeUpdate(sql,Statement.RETURN_GENERATED_KEYS);
    long lastInsertId=0;
    if ("mysql".equalsIgnoreCase(getDbType())) {
      ResultSet generatedKeys=stmt.getGeneratedKeys();
      if (generatedKeys != null) {
        ResultSetMetaData metaData=generatedKeys.getMetaData();
        if (metaData.getColumnCount() == 1) {
          lastInsertId=(generatedKeys.next() ? generatedKeys.getLong(1) : 0L);
        }
      }
    }
    OkPacket okPck=new OkPacket();
    okPck.affectedRows=count;
    okPck.insertId=lastInsertId;
    okPck.packetId=++packetId;
    okPck.message=" OK!".getBytes();
    this.respHandler.okResponse(okPck.writeToBytes(sc),this);
  }
 catch (  Exception e) {
    LOGGER.error("",e);
    throw e;
  }
 finally {
    if (stmt != null) {
      try {
        stmt.close();
      }
 catch (      SQLException e) {
        LOGGER.error("",e);
      }
    }
  }
}
