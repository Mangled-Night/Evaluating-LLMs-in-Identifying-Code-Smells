private Map<FieldMetadata<?,?>,TypeHandler> getFieldHandlerMap(ClassMetadata<?,?> type){
  Map<FieldMetadata<?,?>,TypeHandler> handlerMap=Maps.newHashMap();
  for (  FieldMetadata<?,?> field : type.getFields()) {
    Optional<TypeHandler<?>> handler=getTypeHandler(field.getField().getGenericType());
    if (handler.isPresent()) {
      handlerMap.put(field,handler.get());
    }
 else {
      logger.error("Unsupported field: '{}.{}'",type.getId(),field.getName());
    }
  }
  return handlerMap;
}
