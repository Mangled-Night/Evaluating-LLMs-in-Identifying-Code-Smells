public void createInterface() throws Exception {
  result.setPackageDeclaration(new PackageDeclaration(new Name(targetPackage)));
  template=JavaParser.parse(templateFile);
  ClassOrInterfaceDeclaration templateTypeDeclaration=(ClassOrInterfaceDeclaration)template.getTypes().get(0);
  resultType=new ClassOrInterfaceDeclaration(EnumSet.of(Modifier.PUBLIC),true,targetName);
  if (templateTypeDeclaration.getExtendedTypes() != null) {
    resultType.setExtendedTypes(templateTypeDeclaration.getExtendedTypes());
  }
  if (!templateTypeDeclaration.getTypeParameters().isEmpty()) {
    resultType.setTypeParameters(new NodeList<>());
    for (    TypeParameter typeParameter : templateTypeDeclaration.getTypeParameters()) {
      resultType.getTypeParameters().add(new TypeParameter(typeParameter.getName().getIdentifier(),typeParameter.getTypeBound()));
    }
  }
  resultType.setComment(new JavadocComment(typeDocFunction.apply(templateTypeDeclaration.getComment().get().getContent())));
  result.setComment(template.getComment().orElse(null));
  result.setImports(new NodeList<>());
  result.addType(resultType);
  resultType.setParentNode(result);
  if (template.getImports() != null) {
    result.getImports().addAll(template.getImports());
  }
  List<String> importLines=importSupplier.get();
  importLines.forEach(importLine -> result.getImports().add(new ImportDeclaration(importLine,false,false)));
  new MethodVisitor().visit(template,null);
  if (typeMutator != null) {
    typeMutator.accept(resultType);
  }
  removeUnusedImports();
  writeResult();
}
