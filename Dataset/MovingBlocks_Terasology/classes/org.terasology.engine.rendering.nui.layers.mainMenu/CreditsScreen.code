public class CreditsScreen extends CoreScreenLayer {
  public static final ResourceUrn ASSET_URI=new ResourceUrn("engine:creditsScreen");
  @In private Config config;
  @In private TranslationSystem translationSystem;
  private UIScrollingText creditsScroll;
  @Override @SuppressWarnings("unchecked") public void initialise(){
    setAnimationSystem(MenuAnimationSystems.createDefaultSwipeAnimation());
    WidgetUtil.trySubscribe(this,"back",button -> triggerBackAnimation());
    creditsScroll=find("creditsScroll",UIScrollingText.class);
    if (creditsScroll != null) {
      StringBuilder credits=new StringBuilder();
      ClassLoader classloader=getClass().getClassLoader();
      InputStream is=classloader.getResourceAsStream("Credits.md");
      if (is == null) {
        credits.append(translationSystem.translate("${engine:menu#error-credits-not-found}"));
      }
 else {
        try (BufferedReader br=new BufferedReader(new InputStreamReader(is,StandardCharsets.UTF_8))){
          String line;
          while ((line=br.readLine()) != null) {
            line=line.replaceAll("\\[([^]]*)]\\(([^)]+)\\)","$1").trim();
            if (line.startsWith("* ")) {
              if (line.endsWith(":")) {
                credits.append(System.lineSeparator());
                credits.append(line,2,line.length() - 1);
                credits.append(System.lineSeparator());
                credits.append(System.lineSeparator());
              }
 else {
                credits.append(line,2,line.length());
                credits.append(System.lineSeparator());
              }
            }
 else {
              credits.append(line);
              credits.append(System.lineSeparator());
            }
          }
        }
 catch (        IOException e) {
          Logger logger=LoggerFactory.getLogger(CreditsScreen.class);
          logger.info("Could not open Credits file");
          credits=new StringBuilder(translationSystem.translate("${engine:menu#error-credits-open"));
        }
      }
      creditsScroll.setText(credits.toString());
      creditsScroll.setAutoReset(false);
      creditsScroll.setScrollingSpeed(1);
      creditsScroll.startScrolling();
    }
  }
  @Override public void onOpened(){
    super.onOpened();
    if (creditsScroll != null) {
      creditsScroll.resetScrolling();
    }
  }
  @Override public boolean isLowerLayerVisible(){
    return false;
  }
}
