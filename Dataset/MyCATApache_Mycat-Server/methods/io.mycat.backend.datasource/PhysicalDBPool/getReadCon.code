/** 
 * 从 writeHost 下面的 readHost中随机获取一个 connection, 用于slave注解
 * @param schema
 * @param autocommit
 * @param handler
 * @param attachment
 * @param database
 * @return
 * @throws Exception
 */
public boolean getReadCon(String schema,boolean autocommit,ResponseHandler handler,Object attachment,String database) throws Exception {
  PhysicalDatasource theNode=null;
  LOGGER.debug("!readSources.isEmpty() " + !readSources.isEmpty());
  if (!readSources.isEmpty()) {
    int index=Math.abs(random.nextInt(Integer.MAX_VALUE)) % readSources.size();
    PhysicalDatasource[] allSlaves=this.readSources.get(index);
    if (allSlaves != null) {
      index=Math.abs(random.nextInt(Integer.MAX_VALUE)) % readSources.size();
      PhysicalDatasource slave=allSlaves[index];
      for (int i=0; i < allSlaves.length; i++) {
        LOGGER.debug("allSlaves.length i:::::: " + i);
        if (isAlive(slave)) {
          if (checkSlaveSynStatus()) {
            if (canSelectAsReadNode(slave)) {
              theNode=slave;
              break;
            }
 else {
              continue;
            }
          }
 else {
            theNode=slave;
            break;
          }
        }
      }
    }
    if (theNode != null) {
      theNode.setReadCount();
      theNode.getConnection(schema,autocommit,handler,attachment);
      return true;
    }
 else {
      LOGGER.warn("readhost is notavailable.");
      return false;
    }
  }
 else {
    LOGGER.warn("readhost is empty, readSources is empty.");
    return false;
  }
}
