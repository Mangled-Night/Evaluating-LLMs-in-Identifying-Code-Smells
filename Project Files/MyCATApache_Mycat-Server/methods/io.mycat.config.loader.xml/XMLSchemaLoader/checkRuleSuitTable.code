/** 
 * 检查分片表分片规则配置, 目前主要检查分片表分片算法定义与分片dataNode是否匹配<br> 例如分片表定义如下:<br> {@code <table name="hotnews" primaryKey="ID" autoIncrement="true" dataNode="dn1,dn2" rule="mod-long" />}<br> 分片算法如下:<br> {@code <function name="mod-long" class="io.mycat.route.function.PartitionByMod"> <!-- how many data nodes --> <property name="count">3</property> </function>}<br> shard table datanode(2) < function count(3) 此时检测为不匹配
 */
private void checkRuleSuitTable(TableConfig tableConf){
  AbstractPartitionAlgorithm function=tableConf.getRule().getRuleAlgorithm();
  int suitValue=function.suitableFor(tableConf);
switch (suitValue) {
case -1:
    throw new ConfigException("Illegal table conf : table [ " + tableConf.getName() + " ] rule function [ "+ tableConf.getRule().getFunctionName()+ " ] partition size : "+ tableConf.getRule().getRuleAlgorithm().getPartitionNum()+ " > table datanode size : "+ tableConf.getDataNodes().size()+ ", please make sure table datanode size = function partition size");
case 0:
  break;
case 1:
LOGGER.warn("table conf : table [ {} ] rule function [ {} ] partition size : {} < table datanode size : {} , this cause some datanode to be redundant",new String[]{tableConf.getName(),tableConf.getRule().getFunctionName(),String.valueOf(tableConf.getRule().getRuleAlgorithm().getPartitionNum()),String.valueOf(tableConf.getDataNodes().size())});
break;
}
}
