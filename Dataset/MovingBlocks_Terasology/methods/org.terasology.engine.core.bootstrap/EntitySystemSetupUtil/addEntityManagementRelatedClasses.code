/** 
 * Objects for the following classes must be available in the context: <ul> <li> {@link ModuleEnvironment}</li> <li> {@link NetworkSystem}</li> <li> {@link ReflectFactory}</li> <li> {@link CopyStrategyLibrary}</li> <li> {@link TypeHandlerLibrary}</li> </ul> <p> The method will make objects for the following classes available in the context: <ul> <li> {@link EngineEntityManager}</li> <li> {@link ComponentLibrary}</li> <li> {@link EventLibrary}</li> <li> {@link PrefabManager}</li> <li> {@link EventSystem}</li> </ul>
 */
public static void addEntityManagementRelatedClasses(Context context){
  ModuleManager moduleManager=context.get(ModuleManager.class);
  ModuleEnvironment environment=moduleManager.getEnvironment();
  NetworkSystem networkSystem=context.get(NetworkSystem.class);
  PojoEntityManager entityManager=new PojoEntityManager();
  context.put(EntityManager.class,entityManager);
  context.put(EngineEntityManager.class,entityManager);
  TypeHandlerLibrary typeHandlerLibrary=context.get(TypeHandlerLibrary.class);
  typeHandlerLibrary.addTypeHandler(EntityRef.class,new EntityRefTypeHandler(entityManager));
  entityManager.setTypeSerializerLibrary(typeHandlerLibrary);
  PrefabManager prefabManager=new PojoPrefabManager(context);
  entityManager.setPrefabManager(prefabManager);
  context.put(PrefabManager.class,prefabManager);
  EntitySystemLibrary library=context.get(EntitySystemLibrary.class);
  entityManager.setComponentLibrary(library.getComponentLibrary());
  RecordAndReplayCurrentStatus recordAndReplayCurrentStatus=context.get(RecordAndReplayCurrentStatus.class);
  RecordAndReplayUtils recordAndReplayUtils=context.get(RecordAndReplayUtils.class);
  CharacterStateEventPositionMap characterStateEventPositionMap=context.get(CharacterStateEventPositionMap.class);
  DirectionAndOriginPosRecorderList directionAndOriginPosRecorderList=context.get(DirectionAndOriginPosRecorderList.class);
  RecordedEventStore recordedEventStore=new RecordedEventStore();
  RecordAndReplaySerializer recordAndReplaySerializer=new RecordAndReplaySerializer(entityManager,recordedEventStore,recordAndReplayUtils,characterStateEventPositionMap,directionAndOriginPosRecorderList,moduleManager,context.get(TypeRegistry.class));
  context.put(RecordAndReplaySerializer.class,recordAndReplaySerializer);
  EventSystem eventSystem=createEventSystem(networkSystem,entityManager,library,recordedEventStore,recordAndReplaySerializer,recordAndReplayUtils,recordAndReplayCurrentStatus);
  entityManager.setEventSystem(eventSystem);
  context.put(EventSystem.class,eventSystem);
  context.put(OneOfProviderFactory.class,new OneOfProviderFactory());
  registerComponents(library.getComponentLibrary(),environment);
  registerEvents(entityManager.getEventSystem(),environment);
}
