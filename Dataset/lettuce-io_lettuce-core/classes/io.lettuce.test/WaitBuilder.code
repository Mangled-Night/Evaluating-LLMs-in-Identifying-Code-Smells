/** 
 * Builder to build a waiter/sleeper with a timeout. Make sure to call  {@link #waitOrTimeout()} to block execution until the{@link WaitCondition} is met.
 * @param < T >
 */
public static class WaitBuilder<T> {
  private Duration duration=Duration.ofSeconds(10);
  private Sleeper sleeper=new ThreadSleep(Duration.ofMillis(10));
  private Function<T,String> messageFunction;
  private Supplier<T> supplier;
  private Predicate<T> check;
  private WaitCondition waitCondition;
  public WaitBuilder<T> during(  Duration duration){
    this.duration=duration;
    return this;
  }
  public WaitBuilder<T> message(  String message){
    this.messageFunction=o -> message;
    return this;
  }
  @SuppressWarnings("unchecked") public void waitOrTimeout(){
    Waiter waiter=new Waiter();
    waiter.duration=duration;
    waiter.sleeper=sleeper;
    waiter.messageFunction=(Function<Object,String>)messageFunction;
    if (waitCondition != null) {
      waiter.waitOrTimeout(waitCondition,supplier);
    }
 else {
      waiter.waitOrTimeout(supplier,check);
    }
  }
}
