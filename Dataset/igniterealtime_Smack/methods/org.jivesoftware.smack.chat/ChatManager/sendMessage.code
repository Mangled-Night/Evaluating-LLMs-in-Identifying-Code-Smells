void sendMessage(Chat chat,Message message) throws NotConnectedException, InterruptedException {
  for (  Map.Entry<MessageListener,StanzaFilter> interceptor : interceptors.entrySet()) {
    StanzaFilter filter=interceptor.getValue();
    if (filter != null && filter.accept(message)) {
      interceptor.getKey().processMessage(message);
    }
  }
  connection().sendStanza(message);
}
