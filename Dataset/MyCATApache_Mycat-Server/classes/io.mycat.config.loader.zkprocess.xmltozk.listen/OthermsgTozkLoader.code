/** 
 * 其他一些信息加载到zk中 源文件名：SchemasLoader.java 文件版本：1.0.0 创建作者：liujun 创建日期：2016年9月15日 修改作者：liujun 修改日期：2016年9月15日 文件描述：TODO 版权所有：Copyright 2016 zjhz, Inc. All Rights Reserved.
 */
public class OthermsgTozkLoader extends ZkMultLoader implements NotiflyService {
  /** 
 * 日志
 * @字段说明 LOGGER
 */
  private static final Logger LOGGER=LoggerFactory.getLogger(OthermsgTozkLoader.class);
  /** 
 * 当前文件中的zkpath信息 
 * @字段说明 currZkPath
 */
  private final String currZkPath;
  public OthermsgTozkLoader(  ZookeeperProcessListen zookeeperListen,  CuratorFramework curator,  XmlProcessBase xmlParseBase){
    this.setCurator(curator);
    String schemaPath=zookeeperListen.getBasePath();
    currZkPath=schemaPath;
    zookeeperListen.addListen(schemaPath,this);
  }
  @Override public boolean notiflyProcess() throws Exception {
    String line=currZkPath + ZookeeperPath.ZK_SEPARATOR.getKey() + ZookeeperPath.FLOW_ZK_PATH_LINE.getKey();
    ZKPaths.mkdirs(this.getCurator().getZookeeperClient().getZooKeeper(),line);
    LOGGER.info("OthermsgTozkLoader zookeeper mkdir " + line + " success");
    String seqLine=currZkPath + ZookeeperPath.ZK_SEPARATOR.getKey() + ZookeeperPath.FLOW_ZK_PATH_SEQUENCE.getKey();
    seqLine=seqLine + ZookeeperPath.ZK_SEPARATOR.getKey() + ZookeeperPath.FLOW_ZK_PATH_SEQUENCE_INSTANCE.getKey();
    ZKPaths.mkdirs(this.getCurator().getZookeeperClient().getZooKeeper(),seqLine);
    String seqLeader=currZkPath + ZookeeperPath.ZK_SEPARATOR.getKey() + ZookeeperPath.FLOW_ZK_PATH_SEQUENCE.getKey();
    seqLeader=seqLeader + ZookeeperPath.ZK_SEPARATOR.getKey() + ZookeeperPath.FLOW_ZK_PATH_SEQUENCE_LEADER.getKey();
    ZKPaths.mkdirs(this.getCurator().getZookeeperClient().getZooKeeper(),seqLeader);
    String incrSeq=currZkPath + ZookeeperPath.ZK_SEPARATOR.getKey() + ZookeeperPath.FLOW_ZK_PATH_SEQUENCE.getKey();
    incrSeq=incrSeq + ZookeeperPath.ZK_SEPARATOR.getKey() + ZookeeperPath.FLOW_ZK_PATH_SEQUENCE_INCREMENT_SEQ.getKey();
    ZKPaths.mkdirs(this.getCurator().getZookeeperClient().getZooKeeper(),incrSeq);
    LOGGER.info("OthermsgTozkLoader zookeeper mkdir " + seqLine + " success");
    LOGGER.info("OthermsgTozkLoader zookeeper mkdir " + seqLeader + " success");
    LOGGER.info("OthermsgTozkLoader zookeeper mkdir " + incrSeq + " success");
    return true;
  }
}
