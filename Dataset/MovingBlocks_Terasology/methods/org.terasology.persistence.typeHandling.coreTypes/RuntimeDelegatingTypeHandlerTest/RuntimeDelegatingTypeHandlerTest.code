RuntimeDelegatingTypeHandlerTest(@Mock TypeHandler<Base> baseTypeHandler,@Mock SubHandler subTypeHandler,@Mock SerializationSandbox sandbox,@Mock TypeHandlerLibrary typeHandlerLibrary){
  this.baseTypeHandler=baseTypeHandler;
  this.subTypeHandler=subTypeHandler;
  configureMockSerializer(baseTypeHandler);
  configureMockSerializer(subTypeHandler);
  this.typeHandlerLibrary=typeHandlerLibrary;
  when(typeHandlerLibrary.getTypeHandler((Type)baseType)).thenReturn(Optional.of(baseTypeHandler));
  when(typeHandlerLibrary.getTypeHandler((Type)subType)).thenReturn(Optional.of(subTypeHandler));
  when(sandbox.findSubTypeOf(subType.getName(),baseType)).thenReturn(Optional.of(subType));
  when(sandbox.getSubTypeIdentifier(subType,baseType)).thenReturn(subType.getName());
  TypeHandlerContext context=new TypeHandlerContext(typeHandlerLibrary,sandbox);
  runtimeDelegatingTypeHandler=new RuntimeDelegatingTypeHandler<>(baseTypeHandler,TypeInfo.of(Base.class),context);
}
