private static RedisNodeDescription lookupMaster(List<RedisNodeDescription> nodes){
  Optional<RedisNodeDescription> first=findFirst(nodes,n -> n.getRole().isUpstream());
  return first.orElseThrow(() -> new IllegalStateException("Cannot lookup master from " + nodes));
}
