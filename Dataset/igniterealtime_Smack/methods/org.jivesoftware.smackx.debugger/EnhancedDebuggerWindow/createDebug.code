/** 
 * Creates the main debug window that provides information about Smack and also shows a tab panel for each connection that is being debugged.
 */
@SuppressWarnings({"rawtypes","unchecked"}) private void createDebug(){
  frame=new JFrame("Smack Debug Window");
  if (!PERSISTED_DEBUGGER) {
    frame.addWindowListener(new WindowAdapter(){
      @Override public void windowClosing(      WindowEvent evt){
        rootWindowClosing(evt);
      }
    }
);
  }
  tabbedPane=new JTabbedPane();
  JPanel informationPanel=new JPanel();
  informationPanel.setLayout(new BoxLayout(informationPanel,BoxLayout.Y_AXIS));
  JPanel versionPanel=new JPanel();
  versionPanel.setLayout(new BoxLayout(versionPanel,BoxLayout.X_AXIS));
  versionPanel.setMaximumSize(new Dimension(2000,31));
  versionPanel.add(new JLabel(" Smack version: "));
  JFormattedTextField field=new JFormattedTextField(Smack.getVersion());
  field.setEditable(false);
  field.setBorder(null);
  versionPanel.add(field);
  informationPanel.add(versionPanel);
  JPanel iqProvidersPanel=new JPanel();
  iqProvidersPanel.setLayout(new GridLayout(1,1));
  iqProvidersPanel.setBorder(BorderFactory.createTitledBorder("Installed IQ Providers"));
  Vector<String> providers=new Vector<>();
  for (  Object provider : ProviderManager.getIQProviders()) {
    if (provider.getClass() == Class.class) {
      providers.add(((Class<?>)provider).getName());
    }
 else {
      providers.add(provider.getClass().getName());
    }
  }
  Collections.sort(providers);
  JList list=new JList(providers);
  iqProvidersPanel.add(new JScrollPane(list));
  informationPanel.add(iqProvidersPanel);
  JPanel extensionProvidersPanel=new JPanel();
  extensionProvidersPanel.setLayout(new GridLayout(1,1));
  extensionProvidersPanel.setBorder(BorderFactory.createTitledBorder("Installed Extension Providers"));
  providers=new Vector<>();
  for (  Object provider : ProviderManager.getExtensionProviders()) {
    if (provider.getClass() == Class.class) {
      providers.add(((Class<?>)provider).getName());
    }
 else {
      providers.add(provider.getClass().getName());
    }
  }
  Collections.sort(providers);
  list=new JList(providers);
  extensionProvidersPanel.add(new JScrollPane(list));
  informationPanel.add(extensionProvidersPanel);
  tabbedPane.add("Smack Info",informationPanel);
  JPopupMenu menu=new JPopupMenu();
  JMenuItem menuItem=new JMenuItem("Close");
  menuItem.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      if (tabbedPane.getSelectedIndex() < tabbedPane.getTabCount() - 1) {
        int index=tabbedPane.getSelectedIndex();
        EnhancedDebugger debugger=debuggers.get(index);
        debugger.cancel();
        tabbedPane.remove(debugger.tabbedPane);
        debuggers.remove(debugger);
        frame.setTitle("Smack Debug Window -- Total connections: " + (tabbedPane.getTabCount() - 1));
      }
    }
  }
);
  menu.add(menuItem);
  menuItem=new JMenuItem("Close All Not Active");
  menuItem.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      ArrayList<EnhancedDebugger> debuggersToRemove=new ArrayList<>();
      for (int index=0; index < tabbedPane.getTabCount() - 1; index++) {
        EnhancedDebugger debugger=debuggers.get(index);
        if (!debugger.isConnectionActive()) {
          debugger.cancel();
          debuggersToRemove.add(debugger);
        }
      }
      for (      EnhancedDebugger debugger : debuggersToRemove) {
        tabbedPane.remove(debugger.tabbedPane);
        debuggers.remove(debugger);
      }
      frame.setTitle("Smack Debug Window -- Total connections: " + (tabbedPane.getTabCount() - 1));
    }
  }
);
  menu.add(menuItem);
  tabbedPane.addMouseListener(new PopupListener(menu));
  frame.getContentPane().add(tabbedPane);
  frame.setSize(650,400);
  if (!PERSISTED_DEBUGGER) {
    frame.setVisible(true);
  }
}
