/** 
 * Get Public Address from the Server.
 * @param xmppConnection TODO javadoc me please
 * @return public IP String or null if not found
 * @throws NotConnectedException if the XMPP connection is not connected.
 * @throws InterruptedException if the calling thread was interrupted.
 * @throws XMPPErrorException if there was an XMPP error returned.
 * @throws NoResponseException if there was no response from the remote entity.
 */
public static String getPublicIP(XMPPConnection xmppConnection) throws NotConnectedException, InterruptedException, NoResponseException, XMPPErrorException {
  if (!xmppConnection.isConnected()) {
    return null;
  }
  RTPBridge rtpPacket=new RTPBridge(RTPBridge.BridgeAction.publicip);
  DomainBareJid jid;
  try {
    jid=JidCreate.domainBareFrom(RTPBridge.NAME + "." + xmppConnection.getXMPPServiceDomain());
  }
 catch (  XmppStringprepException e) {
    throw new AssertionError(e);
  }
  rtpPacket.setTo(jid);
  rtpPacket.setType(Type.set);
  RTPBridge response=xmppConnection.sendIqRequestAndWaitForResponse(rtpPacket);
  if (response == null)   return null;
  if (response.getIp() == null || response.getIp().equals(""))   return null;
  Enumeration<NetworkInterface> ifaces=null;
  try {
    ifaces=NetworkInterface.getNetworkInterfaces();
  }
 catch (  SocketException e) {
    LOGGER.log(Level.WARNING,"exception",e);
  }
  while (ifaces != null && ifaces.hasMoreElements()) {
    NetworkInterface iface=ifaces.nextElement();
    Enumeration<InetAddress> iaddresses=iface.getInetAddresses();
    while (iaddresses.hasMoreElements()) {
      InetAddress iaddress=iaddresses.nextElement();
      if (!iaddress.isLoopbackAddress())       if (iaddress.getHostAddress().indexOf(response.getIp()) >= 0)       return null;
    }
  }
  return response.getIp();
}
