@Override public void complete(int depth){
  if (depth == 3 && bodyReceived) {
    subscriber.onNext(output,new StreamMessage<>(stream,id,body == null ? Collections.emptyMap() : body));
    bodyReceived=false;
    key=null;
    body=null;
    id=null;
  }
  if (depth == 2 && skipStreamKeyReset) {
    skipStreamKeyReset=false;
  }
  if (depth == 1) {
    if (skipStreamKeyReset) {
      skipStreamKeyReset=false;
    }
 else {
      stream=null;
    }
  }
}
