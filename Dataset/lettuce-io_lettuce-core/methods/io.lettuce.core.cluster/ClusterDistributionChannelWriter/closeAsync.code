@Override @SuppressWarnings("rawtypes") public CompletableFuture<Void> closeAsync(){
  if (closed) {
    return CompletableFuture.completedFuture(null);
  }
  closed=true;
  List<CompletableFuture<Void>> futures=new ArrayList<>();
  if (defaultWriter != null) {
    futures.add(defaultWriter.closeAsync());
  }
  if (clusterConnectionProvider != null) {
    futures.add(clusterConnectionProvider.closeAsync());
    clusterConnectionProvider=null;
  }
  return Futures.allOf(futures);
}
