private byte[] mertFields(byte[] bs,byte[] bs2,int colType,int mergeType){
  if (bs2 == null || bs2.length == 0) {
    return bs;
  }
 else   if (bs == null || bs.length == 0) {
    return bs2;
  }
switch (mergeType) {
case MergeCol.MERGE_SUM:
    if (colType == ColMeta.COL_TYPE_DOUBLE || colType == ColMeta.COL_TYPE_FLOAT) {
      Double vale=ByteUtil.getDouble(bs) + ByteUtil.getDouble(bs2);
      return vale.toString().getBytes();
    }
 else     if (colType == ColMeta.COL_TYPE_NEWDECIMAL || colType == ColMeta.COL_TYPE_DECIMAL) {
      BigDecimal d1=new BigDecimal(new String(bs));
      d1=d1.add(new BigDecimal(new String(bs2)));
      return String.valueOf(d1).getBytes();
    }
case MergeCol.MERGE_COUNT:
{
    long s1=Long.parseLong(new String(bs));
    long s2=Long.parseLong(new String(bs2));
    long total=s1 + s2;
    return LongUtil.toBytes(total);
  }
case MergeCol.MERGE_MAX:
{
  int compare=ByteUtil.compareNumberByte(bs,bs2);
  return (compare > 0) ? bs : bs2;
}
case MergeCol.MERGE_MIN:
{
int compare=ByteUtil.compareNumberByte(bs,bs2);
return (compare > 0) ? bs2 : bs;
}
case MergeCol.MERGE_AVG:
{
if (colType == ColMeta.COL_TYPE_DOUBLE || colType == ColMeta.COL_TYPE_FLOAT) {
double aDouble=ByteUtil.getDouble(bs);
long s2=Long.parseLong(new String(bs2));
Double vale=aDouble / s2;
return vale.toString().getBytes();
}
 else if (colType == ColMeta.COL_TYPE_NEWDECIMAL || colType == ColMeta.COL_TYPE_DECIMAL) {
BigDecimal sum=new BigDecimal(new String(bs));
BigDecimal avg=sum.divide(new BigDecimal(new String(bs2)),sum.scale() + 4,RoundingMode.HALF_UP);
return avg.toString().getBytes();
}
}
default :
return null;
}
}
