@SuppressWarnings({"unchecked","rawtypes"}) public MySQLConnection make(MySQLDataSource pool,ResponseHandler handler,String schema) throws IOException {
  DBHostConfig dsc=pool.getConfig();
  NetworkChannel channel=openSocketChannel(MycatServer.getInstance().isAIO());
  MySQLConnection c=new MySQLConnection(channel,pool.isReadNode());
  MycatServer.getInstance().getConfig().setSocketParams(c,false);
  c.setHost(dsc.getIp());
  c.setPort(dsc.getPort());
  c.setUser(dsc.getUser());
  c.setPassword(dsc.getPassword());
  c.setSchema(schema);
  c.setHandler(new MySQLConnectionAuthenticator(c,handler));
  c.setPool(pool);
  c.setIdleTimeout(pool.getConfig().getIdleTimeout());
  if (channel instanceof AsynchronousSocketChannel) {
    ((AsynchronousSocketChannel)channel).connect(new InetSocketAddress(dsc.getIp(),dsc.getPort()),c,(CompletionHandler)MycatServer.getInstance().getConnector());
  }
 else {
    ((NIOConnector)MycatServer.getInstance().getConnector()).postConnect(c);
  }
  return c;
}
