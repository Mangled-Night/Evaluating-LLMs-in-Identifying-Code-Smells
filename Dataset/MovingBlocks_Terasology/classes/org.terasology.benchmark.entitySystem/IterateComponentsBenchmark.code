@BenchmarkMode(Mode.AverageTime) @OutputTimeUnit(TimeUnit.NANOSECONDS) @Warmup(iterations=1) @Measurement(iterations=1) public class IterateComponentsBenchmark {
@State(Scope.Benchmark) public static class StateObject {
    private final PojoEntityManager entityManager=new PojoEntityManager();
    public void setup(){
      FastRandom rand=new FastRandom(0L);
      for (int i=0; i < 1000; ++i) {
        List<Component> entityData=Lists.newArrayList();
        if (rand.nextFloat() < 0.75f) {
          entityData.add(new LocationComponent());
        }
        if (rand.nextFloat() < 0.5f) {
          entityData.add(new MeshComponent());
        }
        if (rand.nextFloat() < 0.25f) {
          entityData.add(new BlockComponent());
        }
        entityManager.create(entityData);
      }
    }
  }
  @Benchmark public void iterateMultipleComponent(  StateObject state){
    for (    EntityRef entity : state.entityManager.getEntitiesWith(MeshComponent.class,LocationComponent.class)) {
      LocationComponent loc=entity.getComponent(LocationComponent.class);
      MeshComponent meshComp=entity.getComponent(MeshComponent.class);
      loc.getLocalPosition();
    }
  }
  @Benchmark public void iterateSingleComponent(  StateObject state){
    for (    EntityRef entity : state.entityManager.getEntitiesWith(LocationComponent.class)) {
      LocationComponent loc=entity.getComponent(LocationComponent.class);
      loc.getLocalPosition();
    }
  }
}
