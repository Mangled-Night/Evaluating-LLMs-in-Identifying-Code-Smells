@Test public void test() throws ParseException {
  PartitionByRangeDateHash partition=new PartitionByRangeDateHash();
  partition.setDateFormat("yyyy-MM-dd HH:mm:ss");
  partition.setsBeginDate("2014-01-01 00:00:00");
  partition.setsPartionDay("3");
  partition.setGroupPartionSize("6");
  partition.init();
  Integer calculate=partition.calculate("2014-01-01 00:00:00");
  Assert.assertEquals(true,3 == calculate);
  calculate=partition.calculate("2014-01-01 00:00:01");
  Assert.assertEquals(true,1 == calculate);
  calculate=partition.calculate("2014-01-04 00:00:00");
  Assert.assertEquals(true,7 == calculate);
  calculate=partition.calculate("2014-01-04 00:00:01");
  Assert.assertEquals(true,11 == calculate);
  Date beginDate=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse("2014-01-01 00:00:00");
  Calendar cal=Calendar.getInstance();
  cal.setTime(beginDate);
  for (int i=0; i < 60 * 60 * 24* 3 - 1; i++) {
    cal.add(Calendar.SECOND,1);
    int v=partition.calculate(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(cal.getTime()));
    Assert.assertTrue(v < 6);
  }
}
