/** 
 * Enable Push Notifications IQ.
 * @see <a href="http://xmpp.org/extensions/xep-0357.html">XEP-0357: Push
 *      Notifications</a>
 * @author Fernando Ramirez
 */
public class EnablePushNotificationsIQ extends IQ {
  /** 
 * enable element.
 */
  public static final String ELEMENT="enable";
  /** 
 * the IQ NAMESPACE.
 */
  public static final String NAMESPACE=PushNotificationsElements.NAMESPACE;
  private final Jid jid;
  private final String node;
  private final HashMap<String,String> publishOptions;
  public EnablePushNotificationsIQ(  Jid jid,  String node,  HashMap<String,String> publishOptions){
    super(ELEMENT,NAMESPACE);
    this.jid=jid;
    this.node=node;
    this.publishOptions=publishOptions;
    this.setType(Type.set);
  }
  public EnablePushNotificationsIQ(  Jid jid,  String node){
    this(jid,node,null);
  }
  /** 
 * Get the JID.
 * @return the JID
 */
  public Jid getJid(){
    return jid;
  }
  /** 
 * Get the node.
 * @return the node
 */
  public String getNode(){
    return node;
  }
  /** 
 * Get the publish options.
 * @return the publish options
 */
  public HashMap<String,String> getPublishOptions(){
    return publishOptions;
  }
  @Override protected IQChildElementXmlStringBuilder getIQChildElementBuilder(  IQChildElementXmlStringBuilder xml){
    xml.attribute("jid",jid);
    xml.attribute("node",node);
    xml.rightAngleBracket();
    if (publishOptions != null) {
      DataForm.Builder dataForm=DataForm.builder();
      FormField formTypeField=FormField.buildHiddenFormType(PubSub.NAMESPACE + "#publish-options");
      dataForm.addField(formTypeField);
      Iterator<Map.Entry<String,String>> publishOptionsIterator=publishOptions.entrySet().iterator();
      while (publishOptionsIterator.hasNext()) {
        Map.Entry<String,String> pairVariableValue=publishOptionsIterator.next();
        TextSingleFormField.Builder field=FormField.builder(pairVariableValue.getKey());
        field.setValue(pairVariableValue.getValue());
        dataForm.addField(field.build());
      }
      xml.append(dataForm.build());
    }
    return xml;
  }
}
