protected final int getRelativeIndex(int x,int y,int z){
  if (!relativeRegion.contains(x,y,z)) {
    throw new IllegalArgumentException(String.format("Out of bounds: (%d, %d, %d) for region %s",x,y,z,relativeRegion.toString()));
  }
  return x - relativeRegion.minX() + relativeRegion.getSizeX() * (y - relativeRegion.minY() + relativeRegion.getSizeY() * (z - relativeRegion.minZ()));
}
