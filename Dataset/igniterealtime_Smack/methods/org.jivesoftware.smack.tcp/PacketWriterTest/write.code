@Override public void write(char[] cbuf,int off,int len) throws IOException {
synchronized (this) {
    while (blocked) {
      try {
        wait();
      }
 catch (      InterruptedException e) {
        throw new AssertionError(e);
      }
    }
  }
}
