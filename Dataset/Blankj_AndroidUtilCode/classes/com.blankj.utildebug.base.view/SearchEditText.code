/** 
 * <pre> author: blankj blog  : http://blankj.com time  : 2019/09/06 desc  : </pre>
 */
public class SearchEditText extends FloatEditText {
  private static final long LIMIT=200;
  private OnTextChangedListener mListener;
  private String mStartSearchText="";
  private Runnable mAction=new Runnable(){
    @Override public void run(){
      if (mListener != null) {
        if (!StringUtils.equals(mStartSearchText,getText().toString())) {
          mStartSearchText=getText().toString();
          mListener.onTextChanged(mStartSearchText);
        }
      }
    }
  }
;
  public SearchEditText(  Context context){
    this(context,null);
  }
  public SearchEditText(  Context context,  AttributeSet attrs){
    super(context,attrs);
  }
  /** 
 * 在 LIMIT 时间内连续输入不触发文本变化
 */
  public void setOnTextChangedListener(  OnTextChangedListener listener){
    mListener=listener;
  }
  public void reset(){
    mStartSearchText="";
    setText("");
    KeyboardUtils.hideSoftInput(this);
  }
  @Override protected void onTextChanged(  final CharSequence text,  int start,  int lengthBefore,  int lengthAfter){
    super.onTextChanged(text,start,lengthBefore,lengthAfter);
    removeCallbacks(mAction);
    postDelayed(mAction,LIMIT);
  }
  @Override protected void onDetachedFromWindow(){
    removeCallbacks(mAction);
    KeyboardUtils.hideSoftInput(this);
    super.onDetachedFromWindow();
  }
public interface OnTextChangedListener {
    void onTextChanged(    String text);
  }
}
