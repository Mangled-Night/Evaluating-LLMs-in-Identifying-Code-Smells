public class PasswordMessage extends PostgreSQLPacket {
  public PasswordMessage(  String user,  String password,  AuthType aut,  byte[] salt) throws UnsupportedEncodingException {
    if (aut == AuthType.MD5Password) {
      this.password=MD5Digest.encode(user.getBytes(UTF8),password.getBytes(UTF8),salt);
    }
  }
  private char marker=PacketMarker.F_PwdMess.getValue();
  private byte[] password;
  @Override public int getLength(){
    return 4 + password.length;
  }
  @Override public char getMarker(){
    return marker;
  }
  public void write(  ByteBuffer buffer){
    PIOUtils.SendChar(getMarker(),buffer);
    PIOUtils.SendInteger4(getLength(),buffer);
    PIOUtils.Send(password,buffer);
  }
}
