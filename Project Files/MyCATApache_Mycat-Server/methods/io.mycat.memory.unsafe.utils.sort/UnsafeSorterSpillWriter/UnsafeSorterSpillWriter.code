public UnsafeSorterSpillWriter(DataNodeDiskManager blockManager,int fileBufferSize,int numRecordsToWrite) throws IOException {
  this.diskBlockManager=blockManager.diskBlockManager();
  this.conId=diskBlockManager.createTempLocalBlock();
  this.file=diskBlockManager.getFile(this.conId);
  this.numRecordsToWrite=numRecordsToWrite;
  writer=blockManager.getDiskWriter(conId,file,DummySerializerInstance.INSTANCE,fileBufferSize);
  writeIntToBuffer(numRecordsToWrite,0);
  writer.write(writeBuffer,0,4);
}
