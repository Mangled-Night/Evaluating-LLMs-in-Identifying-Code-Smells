private static String getNodeIdForNextScanIteration(List<String> nodeIds,ClusterScanCursor clusterKeyScanCursor){
  if (clusterKeyScanCursor.isScanOnCurrentNodeFinished()) {
    if (clusterKeyScanCursor.isFinished()) {
      throw new IllegalStateException("Cluster scan is finished");
    }
    int nodeIndex=nodeIds.indexOf(clusterKeyScanCursor.getCurrentNodeId());
    return nodeIds.get(nodeIndex + 1);
  }
  return clusterKeyScanCursor.getCurrentNodeId();
}
