private void setUpMockModuleEnvironment(){
  ModuleManager moduleManager=mock(ModuleManager.class);
  ModuleRegistry moduleRegistry=new TableModuleRegistry();
  Module module=mock(Module.class);
  when(module.getId()).thenReturn(new Name(TEST_MODULE));
  when(module.getVersion()).thenReturn(new Version(0,0,1,true));
  when(module.getMetadata()).thenReturn(new ModuleMetadata());
  moduleRegistry.add(module);
  when(moduleManager.getRegistry()).thenReturn(moduleRegistry);
  ModuleEnvironment environment=mock(ModuleEnvironment.class);
  when(moduleManager.loadEnvironment(any(),anyBoolean())).thenReturn(environment);
  when(moduleManager.getEnvironment()).thenReturn(environment);
  registerBindButtonClasses=new ArrayList<>();
  when(environment.getTypesAnnotatedWith(eq(RegisterBindButton.class))).thenReturn(registerBindButtonClasses);
  when(environment.getTypesAnnotatedWith(eq(RegisterBindButton.class),any())).thenReturn(registerBindButtonClasses);
  registerRealBindAxisClasses=new ArrayList<>();
  when(environment.getTypesAnnotatedWith(eq(RegisterBindAxis.class))).thenReturn(registerRealBindAxisClasses);
  when(environment.getTypesAnnotatedWith(eq(RegisterBindAxis.class),any())).thenReturn(registerRealBindAxisClasses);
  when(environment.getModuleProviding(any())).thenReturn(new Name(TEST_MODULE));
  context.put(ModuleManager.class,moduleManager);
}
