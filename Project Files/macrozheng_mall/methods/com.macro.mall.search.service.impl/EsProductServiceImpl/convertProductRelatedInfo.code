/** 
 * 将返回结果转换为对象
 */
private EsProductRelatedInfo convertProductRelatedInfo(SearchHits<EsProduct> response){
  EsProductRelatedInfo productRelatedInfo=new EsProductRelatedInfo();
  Map<String,Aggregation> aggregationMap=((Aggregations)response.getAggregations().aggregations()).asMap();
  Aggregation brandNames=aggregationMap.get("brandNames");
  List<String> brandNameList=new ArrayList<>();
  for (int i=0; i < ((Terms)brandNames).getBuckets().size(); i++) {
    brandNameList.add(((Terms)brandNames).getBuckets().get(i).getKeyAsString());
  }
  productRelatedInfo.setBrandNames(brandNameList);
  Aggregation productCategoryNames=aggregationMap.get("productCategoryNames");
  List<String> productCategoryNameList=new ArrayList<>();
  for (int i=0; i < ((Terms)productCategoryNames).getBuckets().size(); i++) {
    productCategoryNameList.add(((Terms)productCategoryNames).getBuckets().get(i).getKeyAsString());
  }
  productRelatedInfo.setProductCategoryNames(productCategoryNameList);
  Aggregation productAttrs=aggregationMap.get("allAttrValues");
  List<? extends Terms.Bucket> attrIds=((ParsedLongTerms)((ParsedFilter)((ParsedNested)productAttrs).getAggregations().get("productAttrs")).getAggregations().get("attrIds")).getBuckets();
  List<EsProductRelatedInfo.ProductAttr> attrList=new ArrayList<>();
  for (  Terms.Bucket attrId : attrIds) {
    EsProductRelatedInfo.ProductAttr attr=new EsProductRelatedInfo.ProductAttr();
    attr.setAttrId((Long)attrId.getKey());
    List<String> attrValueList=new ArrayList<>();
    List<? extends Terms.Bucket> attrValues=((ParsedStringTerms)attrId.getAggregations().get("attrValues")).getBuckets();
    List<? extends Terms.Bucket> attrNames=((ParsedStringTerms)attrId.getAggregations().get("attrNames")).getBuckets();
    for (    Terms.Bucket attrValue : attrValues) {
      attrValueList.add(attrValue.getKeyAsString());
    }
    attr.setAttrValues(attrValueList);
    if (!CollectionUtils.isEmpty(attrNames)) {
      String attrName=attrNames.get(0).getKeyAsString();
      attr.setAttrName(attrName);
    }
    attrList.add(attr);
  }
  productRelatedInfo.setProductAttrs(attrList);
  return productRelatedInfo;
}
