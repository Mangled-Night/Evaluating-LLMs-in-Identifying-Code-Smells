/** 
 * An IQProvider for transcripts.
 * @author Gaston Dombiak
 */
public class TranscriptProvider extends IqProvider<Transcript> {
  @Override public Transcript parse(  XmlPullParser parser,  int initialDepth,  IqData iqData,  XmlEnvironment xmlEnvironment) throws XmlPullParserException, IOException, SmackParsingException {
    String sessionID=parser.getAttributeValue("","sessionID");
    List<Stanza> packets=new ArrayList<>();
    boolean done=false;
    while (!done) {
      XmlPullParser.Event eventType=parser.next();
      if (eventType == XmlPullParser.Event.START_ELEMENT) {
        if (parser.getName().equals("message")) {
          packets.add(PacketParserUtils.parseMessage(parser));
        }
 else         if (parser.getName().equals("presence")) {
          packets.add(PacketParserUtils.parsePresence(parser));
        }
      }
 else       if (eventType == XmlPullParser.Event.END_ELEMENT) {
        if (parser.getName().equals("transcript")) {
          done=true;
        }
      }
    }
    return new Transcript(sessionID,packets);
  }
}
