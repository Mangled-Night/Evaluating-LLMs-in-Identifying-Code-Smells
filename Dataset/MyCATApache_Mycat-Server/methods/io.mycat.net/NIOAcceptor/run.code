@Override public void run(){
  int invalidSelectCount=0;
  for (; ; ) {
    try {
      final Selector tSelector=this.selector;
      ++acceptCount;
      long start=System.nanoTime();
      tSelector.select(1000L);
      long end=System.nanoTime();
      Set<SelectionKey> keys=tSelector.selectedKeys();
      if (keys.size() == 0 && (end - start) < SelectorUtil.MIN_SELECT_TIME_IN_NANO_SECONDS) {
        invalidSelectCount++;
      }
 else {
        try {
          for (          SelectionKey key : keys) {
            if (key.isValid() && key.isAcceptable()) {
              accept();
            }
 else {
              key.cancel();
            }
          }
        }
  finally {
          keys.clear();
          invalidSelectCount=0;
        }
      }
      if (invalidSelectCount > SelectorUtil.REBUILD_COUNT_THRESHOLD) {
        final Selector rebuildSelector=SelectorUtil.rebuildSelector(this.selector);
        if (rebuildSelector != null) {
          this.selector=rebuildSelector;
        }
        invalidSelectCount=0;
      }
    }
 catch (    Exception e) {
      LOGGER.warn(getName(),e);
    }
catch (    final Throwable e) {
      LOGGER.warn("caught Throwable err: ",e);
    }
  }
}
