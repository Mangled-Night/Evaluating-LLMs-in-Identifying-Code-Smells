/** 
 * Returns a sorted iterator. It is the caller's responsibility to call `cleanupResources()` after consuming this iterator.
 */
public KVSorterIterator sortedIterator() throws IOException {
  try {
    final UnsafeSorterIterator underlying=sorter.getSortedIterator();
    if (!underlying.hasNext()) {
      cleanupResources();
    }
    return new KVSorterIterator(underlying);
  }
 catch (  IOException e) {
    cleanupResources();
    throw e;
  }
}
