public UnsafeSorterSpillReader(SerializerManager serializerManager,File file,ConnectionId blockId) throws IOException {
  assert (file.length() > 0);
  final BufferedInputStream bs=new BufferedInputStream(new FileInputStream(file));
  try {
    this.in=serializerManager.wrapForCompression(blockId,bs);
    this.din=new DataInputStream(this.in);
    numRecords=numRecordsRemaining=din.readInt();
  }
 catch (  IOException e) {
    Closeables.close(bs,true);
    throw e;
  }
}
