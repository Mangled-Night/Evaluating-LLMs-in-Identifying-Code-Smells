@RequiresPermissions("admin:groupon:read") @RequiresPermissionsDesc(menu={"推广管理","团购管理"},button="详情") @GetMapping("/listRecord") public Object listRecord(String grouponRuleId,@RequestParam(defaultValue="1") Integer page,@RequestParam(defaultValue="10") Integer limit,@Sort @RequestParam(defaultValue="add_time") String sort,@Order @RequestParam(defaultValue="desc") String order){
  List<LitemallGroupon> grouponList=grouponService.querySelective(grouponRuleId,page,limit,sort,order);
  List<Map<String,Object>> groupons=new ArrayList<>();
  for (  LitemallGroupon groupon : grouponList) {
    try {
      Map<String,Object> recordData=new HashMap<>();
      List<LitemallGroupon> subGrouponList=grouponService.queryJoinRecord(groupon.getId());
      LitemallGrouponRules rules=rulesService.findById(groupon.getRulesId());
      LitemallGoods goods=goodsService.findById(rules.getGoodsId());
      recordData.put("groupon",groupon);
      recordData.put("subGroupons",subGrouponList);
      recordData.put("rules",rules);
      recordData.put("goods",goods);
      groupons.add(recordData);
    }
 catch (    Exception e) {
      logger.error(e.getMessage(),e);
    }
  }
  return ResponseUtil.okList(groupons,grouponList);
}
