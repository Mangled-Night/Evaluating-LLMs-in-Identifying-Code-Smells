private int wrapIndex(int i){
  int m=i % n;
  if (m < 0) {
    m+=n;
  }
  return m;
}
