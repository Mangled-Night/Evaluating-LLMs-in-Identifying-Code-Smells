/** 
 * 授权：验证权限时调用
 * @param principalCollection
 * @return
 */
@Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection){
  String username=(String)principalCollection.getPrimaryPrincipal();
  UpmsUser upmsUser=upmsApiService.selectUpmsUserByUsername(username);
  List<UpmsRole> upmsRoles=upmsApiService.selectUpmsRoleByUpmsUserId(upmsUser.getUserId());
  Set<String> roles=new HashSet<>();
  for (  UpmsRole upmsRole : upmsRoles) {
    if (StringUtils.isNotBlank(upmsRole.getName())) {
      roles.add(upmsRole.getName());
    }
  }
  List<UpmsPermission> upmsPermissions=upmsApiService.selectUpmsPermissionByUpmsUserId(upmsUser.getUserId());
  Set<String> permissions=new HashSet<>();
  for (  UpmsPermission upmsPermission : upmsPermissions) {
    if (StringUtils.isNotBlank(upmsPermission.getPermissionValue())) {
      permissions.add(upmsPermission.getPermissionValue());
    }
  }
  SimpleAuthorizationInfo simpleAuthorizationInfo=new SimpleAuthorizationInfo();
  simpleAuthorizationInfo.setStringPermissions(permissions);
  simpleAuthorizationInfo.setRoles(roles);
  return simpleAuthorizationInfo;
}
