/** 
 * @author mycat
 */
public class ClearSlow {
  public static void dataNode(  ManagerConnection c,  String name){
    PhysicalDBNode dn=MycatServer.getInstance().getConfig().getDataNodes().get(name);
    PhysicalDBPool ds=null;
    if (dn != null && ((ds=dn.getDbPool()) != null)) {
      c.write(c.writeToBuffer(OkPacket.OK,c.allocate()));
    }
 else {
      c.writeErrMessage(ErrorCode.ER_YES,"Invalid DataNode:" + name);
    }
  }
  public static void schema(  ManagerConnection c,  String name){
    MycatConfig conf=MycatServer.getInstance().getConfig();
    SchemaConfig schema=conf.getSchemas().get(name);
    if (schema != null) {
      c.write(c.writeToBuffer(OkPacket.OK,c.allocate()));
    }
 else {
      c.writeErrMessage(ErrorCode.ER_YES,"Invalid Schema:" + name);
    }
  }
}
