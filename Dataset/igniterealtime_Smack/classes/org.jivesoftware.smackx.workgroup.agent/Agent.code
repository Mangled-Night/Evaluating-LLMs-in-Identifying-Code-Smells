/** 
 * The <code>Agent</code> class is used to represent one agent in a Workgroup Queue.
 * @author Derek DeMoro
 */
public class Agent {
  private XMPPConnection connection;
  private final EntityBareJid workgroupJID;
  public static Collection<String> getWorkgroups(  Jid serviceJID,  Jid agentJID,  XMPPConnection connection) throws NoResponseException, XMPPErrorException, NotConnectedException, InterruptedException {
    AgentWorkgroups request=new AgentWorkgroups(agentJID);
    request.setTo(serviceJID);
    AgentWorkgroups response=connection.sendIqRequestAndWaitForResponse(request);
    return response.getWorkgroups();
  }
  /** 
 * Constructs an Agent.
 */
  Agent(  XMPPConnection connection,  EntityBareJid workgroupJID){
    this.connection=connection;
    this.workgroupJID=workgroupJID;
  }
  /** 
 * Return the agents JID.
 * @return - the agents JID.
 */
  public Jid getUser(){
    return connection.getUser();
  }
  /** 
 * Return the agents name.
 * @return - the agents name.
 * @throws XMPPErrorException if there was an XMPP error returned.
 * @throws NoResponseException if there was no response from the remote entity.
 * @throws NotConnectedException if the XMPP connection is not connected.
 * @throws InterruptedException if the calling thread was interrupted.
 */
  public String getName() throws NoResponseException, XMPPErrorException, NotConnectedException, InterruptedException {
    AgentInfo agentInfo=new AgentInfo();
    agentInfo.setType(IQ.Type.get);
    agentInfo.setTo(workgroupJID);
    agentInfo.setFrom(getUser());
    AgentInfo response=connection.sendIqRequestAndWaitForResponse(agentInfo);
    return response.getName();
  }
  /** 
 * Changes the name of the agent in the server. The server may have this functionality disabled for all the agents or for this agent in particular. If the agent is not allowed to change his name then an exception will be thrown with a service_unavailable error code.
 * @param newName the new name of the agent.
 * @throws XMPPErrorException if there was an XMPP error returned.
 * @throws NoResponseException if there was no response from the remote entity.
 * @throws NotConnectedException if the XMPP connection is not connected.
 * @throws InterruptedException if the calling thread was interrupted.
 */
  public void setName(  String newName) throws NoResponseException, XMPPErrorException, NotConnectedException, InterruptedException {
    AgentInfo agentInfo=new AgentInfo();
    agentInfo.setType(IQ.Type.set);
    agentInfo.setTo(workgroupJID);
    agentInfo.setFrom(getUser());
    agentInfo.setName(newName);
    connection.sendIqRequestAndWaitForResponse(agentInfo);
  }
}
