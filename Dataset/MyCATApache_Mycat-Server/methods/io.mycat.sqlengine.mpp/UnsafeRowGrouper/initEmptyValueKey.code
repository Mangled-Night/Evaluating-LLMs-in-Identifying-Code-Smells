private void initEmptyValueKey(){
  emptyAggregationBuffer=new UnsafeRow(this.valuefieldCount);
  bufferHolder=new BufferHolder(emptyAggregationBuffer,0);
  unsafeRowWriter=new UnsafeRowWriter(bufferHolder,this.valuefieldCount);
  bufferHolder.reset();
  ColMeta curColMeta=null;
  for (  Map.Entry<String,ColMeta> fieldEntry : columToIndx.entrySet()) {
    curColMeta=fieldEntry.getValue();
switch (curColMeta.colType) {
case ColMeta.COL_TYPE_BIT:
      emptyAggregationBuffer.setByte(curColMeta.colIndex,(byte)0);
    break;
case ColMeta.COL_TYPE_INT:
case ColMeta.COL_TYPE_INT24:
case ColMeta.COL_TYPE_LONG:
  emptyAggregationBuffer.setInt(curColMeta.colIndex,0);
break;
case ColMeta.COL_TYPE_SHORT:
emptyAggregationBuffer.setShort(curColMeta.colIndex,(short)0);
break;
case ColMeta.COL_TYPE_LONGLONG:
emptyAggregationBuffer.setLong(curColMeta.colIndex,0);
break;
case ColMeta.COL_TYPE_FLOAT:
emptyAggregationBuffer.setFloat(curColMeta.colIndex,0);
break;
case ColMeta.COL_TYPE_DOUBLE:
emptyAggregationBuffer.setDouble(curColMeta.colIndex,0);
break;
case ColMeta.COL_TYPE_NEWDECIMAL:
unsafeRowWriter.write(curColMeta.colIndex,new BigDecimal(0L));
break;
default :
unsafeRowWriter.write(curColMeta.colIndex,"init".getBytes());
break;
}
}
emptyAggregationBuffer.setTotalSize(bufferHolder.totalSize());
aggBufferSchema=new StructType(columToIndx,this.valuefieldCount);
aggBufferSchema.setOrderCols(null);
}
