public void handleDataProcessException(Exception e){
  if (!errorRepsponsed.get()) {
    this.error=e.toString();
    LOGGER.warn(this.toString() + " caught exception ",e);
    setFail(e.toString());
    boolean finished=false;
    lock.lock();
    try {
      finished=(this.nodeCount == 0);
    }
  finally {
      lock.unlock();
    }
    this.tryErrorFinished(finished);
  }
}
