protected int checkSchema(String schema,String user){
  if (schema == null) {
    return 0;
  }
  FrontendPrivileges privileges=source.getPrivileges();
  if (!privileges.schemaExists(schema)) {
    return ErrorCode.ER_BAD_DB_ERROR;
  }
  Set<String> schemas=privileges.getUserSchemas(user);
  if (schemas == null || schemas.size() == 0 || schemas.contains(schema)) {
    return 0;
  }
 else {
    return ErrorCode.ER_DBACCESS_DENIED_ERROR;
  }
}
