/** 
 * JDBC工具类 Created by ZhangShuzheng on 2017/1/10.
 */
public class JdbcUtil {
  private Connection conn;
  private PreparedStatement pstmt;
  private ResultSet rs;
  public JdbcUtil(  String driver,  String url,  String username,  String password){
    try {
      Class.forName(driver);
      conn=DriverManager.getConnection(url,username,password);
      System.out.println("数据库连接成功");
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
  public boolean updateByParams(  String sql,  List params) throws SQLException {
    int result=-1;
    pstmt=conn.prepareStatement(sql);
    int index=1;
    if (null != params && !params.isEmpty()) {
      for (int i=0; i < params.size(); i++) {
        pstmt.setObject(index++,params.get(i));
      }
    }
    result=pstmt.executeUpdate();
    return result > 0 ? true : false;
  }
  public List<Map> selectByParams(  String sql,  List params) throws SQLException {
    List<Map> list=new ArrayList<>();
    int index=1;
    pstmt=conn.prepareStatement(sql);
    if (null != params && !params.isEmpty()) {
      for (int i=0; i < params.size(); i++) {
        pstmt.setObject(index++,params.get(i));
      }
    }
    rs=pstmt.executeQuery();
    ResultSetMetaData metaData=rs.getMetaData();
    int colsLen=metaData.getColumnCount();
    while (rs.next()) {
      Map map=new HashMap(colsLen);
      for (int i=0; i < colsLen; i++) {
        String columnName=metaData.getColumnName(i + 1);
        Object columnValue=rs.getObject(columnName);
        if (null == columnValue) {
          columnValue="";
        }
        map.put(columnName,columnValue);
      }
      list.add(map);
    }
    return list;
  }
  public void release(){
    try {
      if (null != rs) {
        rs.close();
      }
      if (null != pstmt) {
        pstmt.close();
      }
      if (null != conn) {
        conn.close();
      }
    }
 catch (    SQLException e) {
      e.printStackTrace();
    }
    System.out.println("释放数据库连接");
  }
}
