public class IndexResourceTest {
  @Test public void testPutIndexResource(){
    IndexResource in=new IndexResource();
    in.put(10);
    in.put(11);
    in.put(15);
    assertEquals(3,in.indices());
    in.writeBuffer(buffer -> {
      assertEquals(3 * Integer.BYTES,buffer.limit());
      assertEquals(10,buffer.getInt(0));
      assertEquals(11,buffer.getInt(1 * Integer.BYTES));
      assertEquals(15,buffer.getInt(2 * Integer.BYTES));
    }
);
  }
  @Test public void testRewind(){
    IndexResource in=new IndexResource();
    in.put(10);
    in.put(11);
    in.put(15);
    assertEquals(3,in.indices());
    in.writeBuffer(buffer -> {
      assertEquals(3 * Integer.BYTES,buffer.limit());
      assertEquals(10,buffer.getInt(0));
      assertEquals(11,buffer.getInt(1 * Integer.BYTES));
      assertEquals(15,buffer.getInt(2 * Integer.BYTES));
    }
);
    in.rewind();
    in.put(20);
    assertEquals(3,in.indices());
    in.writeBuffer(buffer -> {
      assertEquals(3 * Integer.BYTES,buffer.limit());
      assertEquals(20,buffer.getInt(0));
      assertEquals(11,buffer.getInt(1 * Integer.BYTES));
      assertEquals(15,buffer.getInt(2 * Integer.BYTES));
    }
);
  }
  @Test public void testAllocate(){
    IndexResource in=new IndexResource();
    in.allocateElements(20);
    in.put(100);
    in.put(14);
    in.put(10);
    assertEquals(20,in.indices());
    in.writeBuffer(buffer -> {
      assertEquals(20 * Integer.BYTES,buffer.limit());
      assertEquals(100,buffer.getInt(0));
      assertEquals(14,buffer.getInt(1 * Integer.BYTES));
      assertEquals(10,buffer.getInt(2 * Integer.BYTES));
    }
);
    in.allocateElements(4);
    assertEquals(4,in.indices());
    in.writeBuffer(buffer -> {
      assertEquals(4 * Integer.BYTES,buffer.limit());
      assertEquals(100,buffer.getInt(0));
      assertEquals(14,buffer.getInt(1 * Integer.BYTES));
      assertEquals(10,buffer.getInt(2 * Integer.BYTES));
    }
);
  }
}
