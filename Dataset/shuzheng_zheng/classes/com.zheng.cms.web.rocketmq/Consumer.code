/** 
 * Created by ZhangShuzheng on 2016/12/8.
 */
public class Consumer {
  public static void main(  String[] args){
    DefaultMQPushConsumer consumer=new DefaultMQPushConsumer("PushConsumer");
    consumer.setNamesrvAddr("127.0.0.1:9876");
    try {
      consumer.subscribe("PushTopic","push");
      consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);
      consumer.registerMessageListener(new MessageListenerConcurrently(){
        @Override public ConsumeConcurrentlyStatus consumeMessage(        List<MessageExt> list,        ConsumeConcurrentlyContext context){
          Message msg=list.get(0);
          System.out.println(msg.toString());
          return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;
        }
      }
);
      consumer.start();
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
}
