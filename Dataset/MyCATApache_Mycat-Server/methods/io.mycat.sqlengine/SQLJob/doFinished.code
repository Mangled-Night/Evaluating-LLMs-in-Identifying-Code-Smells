private void doFinished(boolean failed,String errorMsg){
  finished=true;
  jobHandler.finished(dataNodeOrDatabase,failed,errorMsg);
  if (ctx != null) {
    if (failed) {
      ctx.setHasError(true);
    }
    ctx.onJobFinished(this);
  }
}
