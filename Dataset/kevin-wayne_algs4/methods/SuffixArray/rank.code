/** 
 * Returns the number of suffixes strictly less than the  {@code query} string.We note that  {@code rank(select(i))} equals {@code i} for each {@code i}between 0 and <em>n</em>-1.
 * @param query the query string
 * @return the number of suffixes strictly less than {@code query}
 */
public int rank(String query){
  int lo=0, hi=suffixes.length - 1;
  while (lo <= hi) {
    int mid=lo + (hi - lo) / 2;
    int cmp=compare(query,suffixes[mid]);
    if (cmp < 0)     hi=mid - 1;
 else     if (cmp > 0)     lo=mid + 1;
 else     return mid;
  }
  return lo;
}
