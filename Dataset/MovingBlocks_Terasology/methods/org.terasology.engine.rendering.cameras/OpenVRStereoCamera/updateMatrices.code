@Override public void updateMatrices(){
  updateMatrices(activeFov);
}
@Override public void updateMatrices(float fov){
  prevViewProjectionMatrix.set(viewProjectionMatrix);
  Matrix4f leftEyeProjection=vrProvider.getState().getEyeProjectionMatrix(0);
  Matrix4f rightEyeProjection=vrProvider.getState().getEyeProjectionMatrix(1);
  Matrix4f leftEyePose=vrProvider.getState().getEyePose(0);
  Matrix4f rightEyePose=vrProvider.getState().getEyePose(1);
  float halfIPD=(float)Math.sqrt(Math.pow(leftEyePose.m30() - rightEyePose.m30(),2) + Math.pow(leftEyePose.m31() - rightEyePose.m31(),2) + Math.pow(leftEyePose.m32() - rightEyePose.m32(),2)) / 2.0f;
  Vector4f vecQuaternion=OpenVRUtil.convertToQuaternion(leftEyePose);
  Quaternionf quaternion=new Quaternionf(vecQuaternion.x,vecQuaternion.y,vecQuaternion.z,vecQuaternion.w);
  setOrientation(quaternion);
  leftEyePose=leftEyePose.invert();
  rightEyePose=rightEyePose.invert();
  if (Math.sqrt(Math.pow(leftEyePose.m30(),2) + Math.pow(leftEyePose.m31(),2) + Math.pow(leftEyePose.m32(),2)) < 0.25) {
    return;
  }
  projectionMatrixLeftEye.set(leftEyeProjection);
  projectionMatrixRightEye.set(rightEyeProjection);
  projectionMatrix=projectionMatrixLeftEye;
  viewMatrixLeftEye.set(leftEyePose);
  viewMatrixRightEye.set(rightEyePose);
  viewMatrix=viewMatrixLeftEye;
  normViewMatrix=viewMatrixLeftEye;
  reflectionMatrix.setRow(0,new Vector4f(1.0f,0.0f,0.0f,0.0f));
  reflectionMatrix.setRow(1,new Vector4f(0.0f,-1.0f,0.0f,2f * (-position.y + 32f)));
  reflectionMatrix.setRow(2,new Vector4f(0.0f,0.0f,1.0f,0.0f));
  reflectionMatrix.setRow(3,new Vector4f(0.0f,0.0f,0.0f,1.0f));
  viewMatrix.mul(reflectionMatrix,viewMatrixReflected);
  reflectionMatrix.setRow(1,new Vector4f(0.0f,-1.0f,0.0f,0.0f));
  normViewMatrix.mul(reflectionMatrix,normViewMatrixReflected);
  viewTranslationLeftEye.identity();
  viewTranslationLeftEye.setTranslation(halfIPD,0.0f,0.0f);
  viewTranslationRightEye.identity();
  viewTranslationRightEye.setTranslation(-halfIPD,0.0f,0.0f);
  viewTranslationLeftEye.mul(viewMatrixReflected,viewMatrixReflectedLeftEye);
  viewTranslationRightEye.mul(viewMatrixReflected,viewMatrixReflectedRightEye);
  projectionMatrixLeftEye.mul(viewMatrixLeftEye,viewProjectionMatrixLeftEye);
  projectionMatrixRightEye.mul(viewMatrixRightEye,viewProjectionMatrixRightEye);
  viewProjectionMatrixLeftEye.invert(inverseViewProjectionMatrixLeftEye);
  viewProjectionMatrixRightEye.invert(inverseViewProjectionMatrixRightEye);
  projectionMatrixLeftEye.invert(inverseProjectionMatrixLeftEye);
  projectionMatrixRightEye.invert(inverseProjectionMatrixRightEye);
  updateFrustum();
}
