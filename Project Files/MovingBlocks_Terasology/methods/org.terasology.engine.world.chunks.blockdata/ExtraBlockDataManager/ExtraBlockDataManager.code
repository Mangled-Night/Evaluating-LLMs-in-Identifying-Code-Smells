/** 
 * Construct a trivial instance for testing purposes: don't add any data-fields.
 */
public ExtraBlockDataManager(){
  slots=new HashMap<>();
  slotFactories=new TeraArray.Factory[0];
}
/** 
 * Set extra-data fields based on the modules available through the context.
 */
public ExtraBlockDataManager(Context context){
  Map<Integer,Map<String,Set<Block>>> fieldss=getFieldsFromAnnotations(context);
  slots=new HashMap<>();
  ArrayList<TeraArray.Factory<?>> tempSlotTypes=new ArrayList<>();
  fieldss.forEach((size,fields) -> {
    Graph disjointnessGraph=getDisjointnessGraph(fields);
    ArrayList<ArrayList<String>> cliques=findCliqueCover(disjointnessGraph);
    for (    ArrayList<String> clique : cliques) {
      for (      String label : clique) {
        slots.put(label,tempSlotTypes.size());
      }
      tempSlotTypes.add(TERA_ARRAY_FACTORIES.get(size));
    }
  }
);
  slotFactories=tempSlotTypes.toArray(new TeraArray.Factory<?>[0]);
  String loggingOutput="Extra data slots registered:";
  boolean first=true;
  for (  Map.Entry<String,Integer> entry : slots.entrySet()) {
    loggingOutput+=(first ? " " : ", ") + entry.getKey() + " -> "+ entry.getValue();
    first=false;
  }
  logger.info(loggingOutput);
}
