private static <K,V>void writeCommands(Collection<RedisCommand<K,V,?>> commands,RedisChannelWriter writer){
  try {
    getWriterToUse(writer).write(commands);
  }
 catch (  Exception e) {
    commands.forEach(command -> command.completeExceptionally(e));
  }
}
