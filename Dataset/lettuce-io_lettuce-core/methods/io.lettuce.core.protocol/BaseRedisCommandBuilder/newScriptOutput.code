@SuppressWarnings("unchecked") protected <T>CommandOutput<K,V,T> newScriptOutput(RedisCodec<K,V> codec,ScriptOutputType type){
switch (type) {
case BOOLEAN:
    return (CommandOutput<K,V,T>)new BooleanOutput<>(codec);
case INTEGER:
  return (CommandOutput<K,V,T>)new IntegerOutput<>(codec);
case STATUS:
return (CommandOutput<K,V,T>)new StatusOutput<>(codec);
case MULTI:
return (CommandOutput<K,V,T>)new NestedMultiOutput<>(codec);
case VALUE:
return (CommandOutput<K,V,T>)new ValueOutput<>(codec);
default :
throw new RedisException("Unsupported script output type");
}
}
