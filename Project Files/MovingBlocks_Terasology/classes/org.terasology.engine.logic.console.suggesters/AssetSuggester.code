/** 
 * Suggest asset names. When only one asset resource exists for the entire set of loaded modules, the name alone suffices. Otherwise, the module name must be prepended.
 */
public abstract class AssetSuggester implements CommandParameterSuggester<String> {
  private final Class<? extends Asset<?>> assetType;
  private final AssetManager assetManager;
  public AssetSuggester(  Class<? extends Asset<?>> assetType,  AssetManager assetManager){
    this.assetType=assetType;
    this.assetManager=assetManager;
  }
  @Override public Set<String> suggest(  EntityRef sender,  Object... resolvedParameters){
    Map<String,Set<ResourceUrn>> resourceMap=Maps.newHashMap();
    Set<String> suggestions=Sets.newHashSet();
    for (    ResourceUrn resolvedParameter : assetManager.getAvailableAssets(assetType)) {
      String resourceName=resolvedParameter.getResourceName().toString();
      if (!resourceMap.containsKey(resourceName)) {
        resourceMap.put(resourceName,Sets.newHashSet());
      }
      resourceMap.get(resourceName).add(resolvedParameter);
    }
    for (    String key : resourceMap.keySet()) {
      Set<ResourceUrn> set=resourceMap.get(key);
      if (set.size() == 1) {
        suggestions.add(set.iterator().next().getResourceName().toString());
      }
 else {
        for (        ResourceUrn resourceUrn : set) {
          suggestions.add(resourceUrn.toString());
        }
      }
    }
    return suggestions;
  }
}
