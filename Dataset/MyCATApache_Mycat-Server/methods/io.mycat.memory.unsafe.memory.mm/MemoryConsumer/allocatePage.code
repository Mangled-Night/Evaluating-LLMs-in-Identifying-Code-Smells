/** 
 * Allocate a memory block with at least `required` bytes. Throws IOException if there is not enough memory.
 * @throws OutOfMemoryError
 */
protected MemoryBlock allocatePage(long required){
  MemoryBlock page=dataNodeMemoryManager.allocatePage(Math.max(pageSize,required),this);
  if (page == null || page.size() < required) {
    long got=0;
    if (page != null) {
      got=page.size();
      dataNodeMemoryManager.freePage(page,this);
    }
    dataNodeMemoryManager.showMemoryUsage();
    throw new OutOfMemoryError("Unable to acquire " + required + " bytes of memory, got "+ got);
  }
  used+=page.size();
  return page;
}
