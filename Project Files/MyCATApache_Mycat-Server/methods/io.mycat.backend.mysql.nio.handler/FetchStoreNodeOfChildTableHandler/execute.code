public String execute(String schema,String sql,List<String> dataNodes,ServerConnection sc){
  String key=schema + ":" + sql;
  CachePool cache=MycatServer.getInstance().getCacheService().getCachePool("ER_SQL2PARENTID");
  String result=(String)cache.get(key);
  if (result != null) {
    return result;
  }
  this.sql=sql;
  int totalCount=dataNodes.size();
  long startTime=System.currentTimeMillis();
  long endTime=startTime + 5 * 60 * 1000L;
  MycatConfig conf=MycatServer.getInstance().getConfig();
  this.sc=sc;
  LOGGER.debug("find child node with sql:" + sql);
  for (  String dn : dataNodes) {
    if (dataNode != null) {
      return dataNode;
    }
    PhysicalDBNode mysqlDN=conf.getDataNodes().get(dn);
    try {
      if (LOGGER.isDebugEnabled()) {
        LOGGER.debug(sc + "execute in datanode " + dn);
      }
      RouteResultsetNode node=new RouteResultsetNode(dn,ServerParse.SELECT,sql);
      node.setRunOnSlave(false);
      BackendConnection conn=sc.getSession2().getTarget(node);
      if (sc.getSession2().tryExistsCon(conn,node)) {
        _execute(conn,node,sc);
      }
 else {
        mysqlDN.getConnection(mysqlDN.getDatabase(),sc.isAutocommit(),node,this,node);
      }
    }
 catch (    Exception e) {
      LOGGER.warn("get connection err " + e);
    }
  }
  while (dataNode == null && System.currentTimeMillis() < endTime) {
    try {
      Thread.sleep(50);
    }
 catch (    InterruptedException e) {
      break;
    }
    if (dataNode != null || finished.get() >= totalCount) {
      break;
    }
  }
  if (dataNode != null) {
    cache.putIfAbsent(key,dataNode);
  }
  if (System.currentTimeMillis() > endTime) {
    LOGGER.error("timeout when executing fetch sql  " + sql);
  }
  return dataNode;
}
public String execute(String schema,String sql,ArrayList<String> dataNodes){
  String key=schema + ":" + sql;
  CachePool cache=MycatServer.getInstance().getCacheService().getCachePool("ER_SQL2PARENTID");
  String result=(String)cache.get(key);
  if (result != null) {
    return result;
  }
  this.sql=sql;
  int totalCount=dataNodes.size();
  long startTime=System.currentTimeMillis();
  long endTime=startTime + 5 * 60 * 1000L;
  MycatConfig conf=MycatServer.getInstance().getConfig();
  LOGGER.debug("find child node with sql:" + sql);
  for (  String dn : dataNodes) {
    if (dataNode != null) {
      return dataNode;
    }
    PhysicalDBNode mysqlDN=conf.getDataNodes().get(dn);
    try {
      if (LOGGER.isDebugEnabled()) {
        LOGGER.debug("execute in datanode " + dn);
      }
      RouteResultsetNode node=new RouteResultsetNode(dn,ServerParse.SELECT,sql);
      node.setRunOnSlave(false);
      mysqlDN.getConnection(mysqlDN.getDatabase(),true,node,this,node);
    }
 catch (    Exception e) {
      LOGGER.warn("get connection err " + e);
    }
    try {
      Thread.sleep(200);
    }
 catch (    InterruptedException e) {
    }
  }
  while (dataNode == null && System.currentTimeMillis() < endTime) {
    try {
      Thread.sleep(50);
    }
 catch (    InterruptedException e) {
      break;
    }
    if (dataNode != null || finished.get() >= totalCount) {
      break;
    }
  }
  if (dataNode != null) {
    cache.putIfAbsent(key,dataNode);
  }
  return dataNode;
}
