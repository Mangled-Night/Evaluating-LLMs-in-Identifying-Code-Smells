/** 
 * This method sets the close flag and removes the data stanza listener.
 */
private void closeInternal(){
  if (isClosed) {
    return;
  }
  isClosed=true;
}
/** 
 * Sets the close flag and optionally flushes the stream.
 * @param flush if <code>true</code> flushes the stream
 */
protected void closeInternal(boolean flush){
  if (this.isClosed) {
    return;
  }
  this.isClosed=true;
  try {
    if (flush) {
      flushBuffer();
    }
  }
 catch (  IOException e) {
  }
}
