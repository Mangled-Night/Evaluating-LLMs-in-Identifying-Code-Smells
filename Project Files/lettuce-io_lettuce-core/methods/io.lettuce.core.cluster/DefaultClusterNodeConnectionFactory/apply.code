@Override public ConnectionFuture<StatefulRedisConnection<K,V>> apply(ConnectionKey key){
  if (key.nodeId != null) {
    return redisClusterClient.connectToNodeAsync(redisCodec,key.nodeId,null,getSocketAddressSupplier(key));
  }
  return redisClusterClient.connectToNodeAsync(redisCodec,key.host + ":" + key.port,clusterWriter,getSocketAddressSupplier(key));
}
