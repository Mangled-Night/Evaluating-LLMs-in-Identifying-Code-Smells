@Override public XmlStringBuilder toXML(org.jivesoftware.smack.packet.XmlEnvironment enclosingNamespace){
  XmlStringBuilder buf=new XmlStringBuilder(this,enclosingNamespace);
  addCommonAttributes(buf);
  if (type != Type.available) {
    buf.attribute("type",type);
  }
  List<XmlElement> extensions=getExtensions();
  if (status == null && priority == null && (mode == null || mode == Mode.available) && extensions.isEmpty() && getError() == null) {
    return buf.closeEmptyElement();
  }
  buf.rightAngleBracket();
  buf.optElement("status",status);
  buf.optElement("priority",priority);
  if (mode != null && mode != Mode.available) {
    buf.element("show",mode);
  }
  buf.append(extensions);
  appendErrorIfExists(buf);
  buf.closeElement(ELEMENT);
  return buf;
}
