@Test void shouldReplayNestedCompletion(){
  ReplayOutput<String,String> replay=new ReplayOutput<>();
  ArrayOutput<String,String> target=new ArrayOutput<>(StringCodec.ASCII);
  replay.multi(1);
  replay.multi(1);
  replay.set(ByteBuffer.wrap("foo".getBytes()));
  replay.complete(2);
  replay.multi(1);
  replay.set(ByteBuffer.wrap("bar".getBytes()));
  replay.complete(2);
  replay.complete(1);
  replay.replay(target);
  assertThat(target.get().get(0)).isEqualTo(Arrays.asList("foo",Collections.singletonList("bar")));
}
