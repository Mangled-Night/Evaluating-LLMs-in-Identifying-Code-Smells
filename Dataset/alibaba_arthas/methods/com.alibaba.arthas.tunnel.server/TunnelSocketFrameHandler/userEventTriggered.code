@Override public void userEventTriggered(ChannelHandlerContext ctx,Object evt) throws Exception {
  if (evt instanceof HandshakeComplete) {
    HandshakeComplete handshake=(HandshakeComplete)evt;
    String uri=handshake.requestUri();
    logger.info("websocket handshake complete, uri: {}",uri);
    MultiValueMap<String,String> parameters=UriComponentsBuilder.fromUriString(uri).build().getQueryParams();
    String method=parameters.getFirst(URIConstans.METHOD);
    if (MethodConstants.CONNECT_ARTHAS.equals(method)) {
      connectArthas(ctx,parameters);
    }
 else     if (MethodConstants.AGENT_REGISTER.equals(method)) {
      agentRegister(ctx,handshake,uri);
    }
    if (MethodConstants.OPEN_TUNNEL.equals(method)) {
      String clientConnectionId=parameters.getFirst(URIConstans.CLIENT_CONNECTION_ID);
      openTunnel(ctx,clientConnectionId);
    }
  }
 else {
    ctx.fireUserEventTriggered(evt);
  }
}
