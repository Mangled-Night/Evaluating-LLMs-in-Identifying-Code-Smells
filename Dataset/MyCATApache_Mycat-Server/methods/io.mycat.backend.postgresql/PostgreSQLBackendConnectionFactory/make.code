@SuppressWarnings({"unchecked","rawtypes"}) public PostgreSQLBackendConnection make(PostgreSQLDataSource pool,ResponseHandler handler,final String schema) throws IOException {
  final DBHostConfig dsc=pool.getConfig();
  NetworkChannel channel=this.openSocketChannel(MycatServer.getInstance().isAIO());
  final PostgreSQLBackendConnection c=new PostgreSQLBackendConnection(channel,pool.isReadNode());
  MycatServer.getInstance().getConfig().setSocketParams(c,false);
  c.setHandler(new PostgreSQLBackendConnectionHandler(c));
  c.setHost(dsc.getIp());
  c.setPort(dsc.getPort());
  c.setUser(dsc.getUser());
  c.setPassword(dsc.getPassword());
  c.setSchema(schema);
  c.setPool(pool);
  c.setResponseHandler(handler);
  c.setIdleTimeout(pool.getConfig().getIdleTimeout());
  if (channel instanceof AsynchronousSocketChannel) {
    ((AsynchronousSocketChannel)channel).connect(new InetSocketAddress(dsc.getIp(),dsc.getPort()),c,(CompletionHandler)MycatServer.getInstance().getConnector());
  }
 else {
    ((NIOConnector)MycatServer.getInstance().getConnector()).postConnect(c);
  }
  return c;
}
