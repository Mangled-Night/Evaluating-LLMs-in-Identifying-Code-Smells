/** 
 * Create mapping between the Key and hash slot.
 * @param partitioned map partitioned by slot-hash and keys.
 * @return map of keys to their slot-hash.
 * @param < K > key type
 * @param < S > slot-hash number type.
 */
public static <S extends Number,K>Map<K,S> getSlots(Map<S,? extends Iterable<K>> partitioned){
  Map<K,S> result=new HashMap<>();
  for (  Map.Entry<S,? extends Iterable<K>> entry : partitioned.entrySet()) {
    for (    K key : entry.getValue()) {
      result.put(key,entry.getKey());
    }
  }
  return result;
}
