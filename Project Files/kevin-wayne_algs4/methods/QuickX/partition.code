private static int partition(Comparable[] a,int lo,int hi){
  int n=hi - lo + 1;
  int m=median3(a,lo,lo + n / 2,hi);
  exch(a,m,lo);
  int i=lo;
  int j=hi + 1;
  Comparable v=a[lo];
  while (less(a[++i],v)) {
    if (i == hi) {
      exch(a,lo,hi);
      return hi;
    }
  }
  while (less(v,a[--j])) {
    if (j == lo + 1)     return lo;
  }
  while (i < j) {
    exch(a,i,j);
    while (less(a[++i],v))     ;
    while (less(v,a[--j]))     ;
  }
  exch(a,lo,j);
  return j;
}
