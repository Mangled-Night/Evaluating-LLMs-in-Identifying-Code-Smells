/** 
 * Responsible for calling  {@link ComponentSystem#preBegin()} on all registered systems.
 */
public class PreBeginSystems extends StepBasedLoadProcess {
  private final Context context;
  private Iterator<ComponentSystem> componentSystems;
  public PreBeginSystems(  Context context){
    this.context=context;
  }
  @Override public String getMessage(){
    return "${engine:menu#reticulating-splines}";
  }
  @Override public boolean step(){
    if (componentSystems.hasNext()) {
      componentSystems.next().preBegin();
      stepDone();
    }
    return !componentSystems.hasNext();
  }
  @Override public void begin(){
    ComponentSystemManager csm=context.get(ComponentSystemManager.class);
    final List<ComponentSystem> componentSystemList=csm.getAllSystems();
    componentSystems=componentSystemList.iterator();
    setTotalSteps(componentSystemList.size());
  }
  @Override public int getExpectedCost(){
    return 1;
  }
}
