public static String detectDefaultDb(String sql,int type){
  String db=null;
  Map<String,SchemaConfig> schemaConfigMap=MycatServer.getInstance().getConfig().getSchemas();
  if (ServerParse.SELECT == type) {
    SchemaUtil.SchemaInfo schemaInfo=SchemaUtil.parseSchema(sql);
    if ((schemaInfo == null || schemaInfo.table == null) && !schemaConfigMap.isEmpty()) {
      db=schemaConfigMap.entrySet().iterator().next().getKey();
    }
    if (schemaInfo != null && schemaInfo.schema != null) {
      if (schemaConfigMap.containsKey(schemaInfo.schema)) {
        db=schemaInfo.schema;
      }
 else       if ("information_schema".equalsIgnoreCase(schemaInfo.schema)) {
        db="information_schema";
      }
    }
  }
 else   if (ServerParse.INSERT == type || ServerParse.UPDATE == type || ServerParse.DELETE == type || ServerParse.DDL == type) {
    SchemaUtil.SchemaInfo schemaInfo=SchemaUtil.parseSchema(sql);
    if (schemaInfo != null && schemaInfo.schema != null && schemaConfigMap.containsKey(schemaInfo.schema)) {
      db=schemaInfo.schema;
    }
  }
 else   if (ServerParse.COMMAND == type) {
    int index=sql.indexOf(ServerParse.COM_FIELD_LIST_FLAG);
    String table=sql.substring(index + 17);
    db=getSchema(schemaConfigMap,table);
  }
 else   if ((ServerParse.SHOW == type || ServerParse.USE == type || ServerParse.EXPLAIN == type || ServerParse.SET == type || ServerParse.HELP == type || ServerParse.DESCRIBE == type) && !schemaConfigMap.isEmpty()) {
    try {
      SQLStatementParser parser=new MySqlStatementParser(sql);
      SQLShowColumnsStatement stmt=(SQLShowColumnsStatement)parser.parseStatement();
      db=getSchema(schemaConfigMap,stmt.getTable().getSimpleName());
    }
 catch (    Exception e) {
      db=schemaConfigMap.entrySet().iterator().next().getKey();
    }
  }
  return db;
}
