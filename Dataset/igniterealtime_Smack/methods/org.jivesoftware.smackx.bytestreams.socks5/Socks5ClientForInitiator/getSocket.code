@Override public Socket getSocket(int timeout) throws IOException, InterruptedException, TimeoutException, XMPPException, SmackMessageException, NotConnectedException, NoResponseException {
  Socket socket;
  if (this.streamHost.getJID().equals(this.connection.get().getUser())) {
    socket=Socks5Proxy.getSocketForDigest(this.digest);
    if (socket == null) {
      throw new SmackException.SmackMessageException("target is not connected to SOCKS5 proxy");
    }
  }
 else {
    socket=super.getSocket(timeout);
    try {
      activate();
    }
 catch (    XMPPException e1) {
      socket.close();
      throw e1;
    }
catch (    NoResponseException e2) {
      socket.close();
      throw e2;
    }
  }
  return socket;
}
