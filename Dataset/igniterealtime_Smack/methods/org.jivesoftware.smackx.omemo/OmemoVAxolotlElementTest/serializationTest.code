@Test public void serializationTest() throws Exception {
  byte[] payload="This is payload.".getBytes(StandardCharsets.UTF_8);
  int keyId1=8;
  int keyId2=33333;
  byte[] keyData1="KEYDATA".getBytes(StandardCharsets.UTF_8);
  byte[] keyData2="DATAKEY".getBytes(StandardCharsets.UTF_8);
  int sid=12131415;
  byte[] iv=OmemoMessageBuilder.generateIv();
  ArrayList<OmemoKeyElement> keys=new ArrayList<>();
  keys.add(new OmemoKeyElement(keyData1,keyId1));
  keys.add(new OmemoKeyElement(keyData2,keyId2,true));
  OmemoHeaderElement_VAxolotl header=new OmemoHeaderElement_VAxolotl(sid,keys,iv);
  OmemoElement_VAxolotl element=new OmemoElement_VAxolotl(header,payload);
  String expected="<encrypted xmlns='eu.siacs.conversations.axolotl'>" + "<header sid='12131415'>" + "<key rid='8'>" + Base64.encodeToString(keyData1) + "</key>"+ "<key prekey='true' rid='33333'>"+ Base64.encodeToString(keyData2)+ "</key>"+ "<iv>"+ Base64.encodeToString(iv)+ "</iv>"+ "</header>"+ "<payload>"+ Base64.encodeToString(payload)+ "</payload>"+ "</encrypted>";
  String actual=element.toXML().toString();
  assertEquals("Serialized xml of OmemoElement must match.",expected,actual);
  OmemoElement_VAxolotl parsed=new OmemoVAxolotlProvider().parse(TestUtils.getParser(actual));
  assertEquals("Parsed OmemoElement must equal the original.",element.toXML().toString(),parsed.toXML().toString());
}
