@Test public void testAutoPartitionByLong(){
  AutoPartitionByLong autoPartition=new AutoPartitionByLong();
  autoPartition.setMapFile("autopartition-long.txt");
  autoPartition.init();
  Assert.assertEquals(3,autoPartition.getPartitionNum());
  RuleConfig rule=new RuleConfig("id","auto-partition-long");
  rule.setRuleAlgorithm(autoPartition);
  TableConfig tableConf=new TableConfig("test","id",true,false,-1,"dn1,dn2",null,rule,true,null,false,null,null,null,false);
  int suit1=autoPartition.suitableFor(tableConf);
  Assert.assertEquals(-1,suit1);
  tableConf.getDataNodes().clear();
  tableConf.getDataNodes().addAll(Arrays.asList("dn1","dn2","dn3"));
  int suit2=autoPartition.suitableFor(tableConf);
  Assert.assertEquals(0,suit2);
  tableConf.getDataNodes().clear();
  tableConf.getDataNodes().addAll(Arrays.asList("dn1","dn2","dn3","dn4"));
  int suit3=autoPartition.suitableFor(tableConf);
  Assert.assertEquals(1,suit3);
  AutoPartitionByLong autoPartition2=new AutoPartitionByLong();
  autoPartition2.setMapFile("autopartition-long-dupl.txt");
  autoPartition2.init();
  Assert.assertEquals(2,autoPartition2.getPartitionNum());
  RuleConfig rule2=new RuleConfig("id","auto-partition-long-dupl");
  rule2.setRuleAlgorithm(autoPartition2);
  TableConfig tableConf2=new TableConfig("test2","id",true,false,-1,"dn1,dn2",null,rule,true,null,false,null,null,null,false);
  Assert.assertEquals(0,autoPartition2.suitableFor(tableConf2));
  Assert.assertEquals(0,autoPartition2.calculate("500").intValue());
  Assert.assertEquals(1,autoPartition2.calculate("1500").intValue());
  Assert.assertEquals(1,autoPartition2.calculate("2000").intValue());
  Assert.assertEquals(0,autoPartition2.calculate("3000").intValue());
  Assert.assertEquals(1,autoPartition2.calculate("3001").intValue());
}
