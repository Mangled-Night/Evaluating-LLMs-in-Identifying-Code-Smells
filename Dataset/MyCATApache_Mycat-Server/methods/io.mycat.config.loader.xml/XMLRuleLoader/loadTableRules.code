/** 
 * tableRule标签结构： <tableRule name="sharding-by-month"> <rule> <columns>create_date</columns> <algorithm>partbymonth</algorithm> </rule> </tableRule>
 * @param root
 * @throws SQLSyntaxErrorException
 */
private void loadTableRules(Element root) throws SQLSyntaxErrorException {
  NodeList list=root.getElementsByTagName("tableRule");
  for (int i=0, n=list.getLength(); i < n; ++i) {
    Node node=list.item(i);
    if (node instanceof Element) {
      Element e=(Element)node;
      String name=e.getAttribute("name");
      if (tableRules.containsKey(name)) {
        throw new ConfigException("table rule " + name + " duplicated!");
      }
      NodeList ruleNodes=e.getElementsByTagName("rule");
      int length=ruleNodes.getLength();
      if (length > 1) {
        throw new ConfigException("only one rule can defined :" + name);
      }
      RuleConfig rule=loadRule((Element)ruleNodes.item(0));
      String funName=rule.getFunctionName();
      AbstractPartitionAlgorithm func=functions.get(funName);
      if (func == null) {
        throw new ConfigException("can't find function of name :" + funName);
      }
      rule.setRuleAlgorithm(func);
      tableRules.put(name,new TableRuleConfig(name,rule));
    }
  }
}
