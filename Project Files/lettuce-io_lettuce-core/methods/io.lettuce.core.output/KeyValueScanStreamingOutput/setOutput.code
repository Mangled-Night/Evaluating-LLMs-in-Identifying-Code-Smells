@Override protected void setOutput(ByteBuffer bytes){
  if (key == null) {
    key=codec.decodeKey(bytes);
    return;
  }
  V value=(bytes == null) ? null : codec.decodeValue(bytes);
  channel.onKeyValue(key,value);
  output.setCount(output.getCount() + 1);
  key=null;
}
