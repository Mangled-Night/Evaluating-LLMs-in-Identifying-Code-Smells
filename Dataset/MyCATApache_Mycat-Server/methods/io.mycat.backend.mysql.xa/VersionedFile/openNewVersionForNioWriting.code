/** 
 * Opens a new version for writing to. Note that this new version is tentative and cannot be read by  {@link #openLastValidVersionForReading()} until{@link #discardBackupVersion()} is called.
 * @return A file for writing to.
 * @throws IOException
 * @throws IllegalStateException If called more than oncewithout a close in between.
 * @throws FileNotFoundException If the file cannot be opened for writing.
 * @throws IOException
 */
public FileChannel openNewVersionForNioWriting() throws FileNotFoundException {
  if (randomAccessFile != null)   throw new IllegalStateException("Already writing a new version.");
  randomAccessFile=new RandomAccessFile(getCurrentVersionFileName(),"rw");
  return randomAccessFile.getChannel();
}
