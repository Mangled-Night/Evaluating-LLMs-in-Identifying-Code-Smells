@Override public void run(){
  Connection con=null;
  try {
    List<String> batch=getNextBatch();
    while (!batch.isEmpty()) {
      try {
        if (con == null || con.isClosed()) {
          con=conPool.getConnection();
          if (con.getAutoCommit() != autocommit) {
            con.setAutoCommit(autocommit);
          }
        }
        insert(con,batch);
        finshiedCount.addAndGet(batch.size());
      }
 catch (      Exception e) {
        System.out.println("caught err in  thread :" + Thread.currentThread().getId() + " "+ e);
        try {
          con.rollback();
        }
 catch (        SQLException e1) {
          System.out.println("caught err in thread :" + Thread.currentThread().getId() + " rollback err "+ e1);
        }
        failedCount.addAndGet(batch.size());
      }
      batch=getNextBatch();
    }
  }
  finally {
    if (con != null) {
      this.conPool.returnCon(con);
    }
  }
}
