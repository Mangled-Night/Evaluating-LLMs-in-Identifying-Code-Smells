public void testRouteInsertShort() throws Exception {
  String sql="inSErt into offer_detail (`offer_id`, gmt) values ('123',now())";
  SchemaConfig schema=schemaMap.get("cndb");
  RouteResultset rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(1,rrs.getNodes().length);
  Assert.assertEquals(false,rrs.isCacheAble());
  Assert.assertEquals(-1l,rrs.getLimitSize());
  Assert.assertEquals("detail_dn15",rrs.getNodes()[0].getName());
  String expect="INSERT INTO offer_detail (`offer_id`, gmt)\n" + "VALUES ('123', now())";
  Assert.assertEquals(expect,rrs.getNodes()[0].getStatement());
  sql="inSErt into offer_detail ( gmt) values (now())";
  schema=schemaMap.get("cndb");
  try {
    rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  }
 catch (  Exception e) {
    String msg="bad insert sql (sharding column:";
    Assert.assertTrue(e.getMessage().contains(msg));
  }
  sql="inSErt into offer_detail (offer_id, gmt) values (123,now())";
  schema=schemaMap.get("cndb");
  rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(1,rrs.getNodes().length);
  Assert.assertEquals(false,rrs.isCacheAble());
  Assert.assertEquals(-1l,rrs.getLimitSize());
  Assert.assertEquals("detail_dn15",rrs.getNodes()[0].getName());
  Assert.assertEquals("INSERT INTO offer_detail (offer_id, gmt)\nVALUES ('123', now())",rrs.getNodes()[0].getStatement());
  sql="insert into offer(group_id,offer_id,member_id)values(234,123,'abc')";
  schema=schemaMap.get("cndb");
  rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(1,rrs.getNodes().length);
  Assert.assertEquals(false,rrs.isCacheAble());
  Assert.assertEquals(-1l,rrs.getLimitSize());
  Assert.assertEquals("offer_dn12",rrs.getNodes()[0].getName());
  Assert.assertEquals("INSERT INTO offer (group_id, offer_id, member_id)\n" + "VALUES (234, 123, 'abc')",rrs.getNodes()[0].getStatement());
  sql="\n" + "  INSERT INTO \n" + "`offer` \n"+ "(`asf`,member_id) \n"+ "VALUES \n"+ "(' the articles sfroms user selection ','abc')";
  schema=schemaMap.get("cndb");
  rrs=routeStrategy.route(new SystemConfig(),schema,-1,sql,null,null,cachePool);
  Assert.assertEquals(1,rrs.getNodes().length);
}
