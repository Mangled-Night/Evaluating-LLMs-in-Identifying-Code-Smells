@Test @Inject void routeCommandToForbiddenHostOnRedirect(@Connection(requiresNew=true) StatefulRedisClusterConnection<String,String> connectionUnderTest){
  RedisAdvancedClusterCommands<String,String> sync=connectionUnderTest.sync();
  try {
    Partitions partitions=clusterClient.getPartitions();
    for (    RedisClusterNode partition : partitions) {
      partition.setSlots(Collections.singletonList(0));
      if (partition.getUri().getPort() == 7380) {
        partition.setSlots(Collections.singletonList(6373));
      }
 else {
        partition.setUri(RedisURI.create("redis://non.existent.host:1234"));
      }
    }
    partitions.updateCache();
    sync.set("A","value");
  }
 catch (  Exception e) {
    assertThat(e).isInstanceOf(RedisException.class).hasMessageContaining("not allowed");
  }
 finally {
    clusterClient.getPartitions().clear();
    clusterClient.reloadPartitions();
  }
}
