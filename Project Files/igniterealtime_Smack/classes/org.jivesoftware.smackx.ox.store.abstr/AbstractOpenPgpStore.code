public abstract class AbstractOpenPgpStore implements OpenPgpStore {
  protected final OpenPgpKeyStore keyStore;
  protected final OpenPgpMetadataStore metadataStore;
  protected final OpenPgpTrustStore trustStore;
  protected SecretKeyPassphraseCallback secretKeyPassphraseCallback;
  protected SecretKeyRingProtector unlocker=new UnprotectedKeysProtector();
  protected final Map<BareJid,OpenPgpContact> contacts=new HashMap<>();
  @Override public void deletePublicKeyRing(  BareJid owner,  OpenPgpV4Fingerprint fingerprint) throws IOException, PGPException {
    keyStore.deletePublicKeyRing(owner,fingerprint);
  }
  @Override public void deleteSecretKeyRing(  BareJid owner,  OpenPgpV4Fingerprint fingerprint) throws IOException, PGPException {
    keyStore.deleteSecretKeyRing(owner,fingerprint);
  }
  protected AbstractOpenPgpStore(  OpenPgpKeyStore keyStore,  OpenPgpMetadataStore metadataStore,  OpenPgpTrustStore trustStore){
    this.keyStore=Objects.requireNonNull(keyStore);
    this.metadataStore=Objects.requireNonNull(metadataStore);
    this.trustStore=Objects.requireNonNull(trustStore);
  }
  @Override public OpenPgpContact getOpenPgpContact(  BareJid jid){
    OpenPgpContact contact=contacts.get(jid);
    if (contact == null) {
      contact=new OpenPgpContact(jid,this);
      contacts.put(jid,contact);
    }
    return contact;
  }
  @Override public void setKeyRingProtector(  SecretKeyRingProtector protector){
    this.unlocker=protector;
  }
  @Override public SecretKeyRingProtector getKeyRingProtector(){
    return unlocker;
  }
  @Override public void setSecretKeyPassphraseCallback(  SecretKeyPassphraseCallback callback){
    this.secretKeyPassphraseCallback=callback;
  }
  @Override public PGPPublicKeyRingCollection getPublicKeysOf(  BareJid owner) throws IOException, PGPException {
    return keyStore.getPublicKeysOf(owner);
  }
  @Override public PGPSecretKeyRingCollection getSecretKeysOf(  BareJid owner) throws IOException, PGPException {
    return keyStore.getSecretKeysOf(owner);
  }
  @Override public PGPPublicKeyRing getPublicKeyRing(  BareJid owner,  OpenPgpV4Fingerprint fingerprint) throws IOException, PGPException {
    return keyStore.getPublicKeyRing(owner,fingerprint);
  }
  @Override public PGPSecretKeyRing getSecretKeyRing(  BareJid owner,  OpenPgpV4Fingerprint fingerprint) throws IOException, PGPException {
    return keyStore.getSecretKeyRing(owner,fingerprint);
  }
  @Override public PGPSecretKeyRing generateKeyRing(  BareJid owner) throws PGPException, NoSuchAlgorithmException, NoSuchProviderException, InvalidAlgorithmParameterException {
    return keyStore.generateKeyRing(owner);
  }
  @Override public void importSecretKey(  BareJid owner,  PGPSecretKeyRing secretKeys) throws IOException, PGPException, MissingUserIdOnKeyException {
    keyStore.importSecretKey(owner,secretKeys);
  }
  @Override public void importPublicKey(  BareJid owner,  PGPPublicKeyRing publicKeys) throws IOException, PGPException, MissingUserIdOnKeyException {
    keyStore.importPublicKey(owner,publicKeys);
  }
  @Override public Map<OpenPgpV4Fingerprint,Date> getPublicKeyFetchDates(  BareJid contact) throws IOException {
    return keyStore.getPublicKeyFetchDates(contact);
  }
  @Override public void setPublicKeyFetchDates(  BareJid contact,  Map<OpenPgpV4Fingerprint,Date> dates) throws IOException {
    keyStore.setPublicKeyFetchDates(contact,dates);
  }
  @Override public Map<OpenPgpV4Fingerprint,Date> getAnnouncedFingerprintsOf(  BareJid contact) throws IOException {
    return metadataStore.getAnnouncedFingerprintsOf(contact);
  }
  @Override public void setAnnouncedFingerprintsOf(  BareJid contact,  Map<OpenPgpV4Fingerprint,Date> data) throws IOException {
    metadataStore.setAnnouncedFingerprintsOf(contact,data);
  }
  @Override public Trust getTrust(  BareJid owner,  OpenPgpV4Fingerprint fingerprint) throws IOException {
    return trustStore.getTrust(owner,fingerprint);
  }
  @Override public void setTrust(  BareJid owner,  OpenPgpV4Fingerprint fingerprint,  Trust trust) throws IOException {
    trustStore.setTrust(owner,fingerprint,trust);
  }
}
