/** 
 * Run a command on all available masters,
 * @param function function producing the command
 * @param < T > result type
 * @return map of a key (counter) and commands.
 */
protected <T>Map<String,CompletableFuture<T>> executeOnUpstream(Function<RedisClusterAsyncCommands<K,V>,RedisFuture<T>> function){
  return executeOnNodes(function,redisClusterNode -> redisClusterNode.is(UPSTREAM));
}
