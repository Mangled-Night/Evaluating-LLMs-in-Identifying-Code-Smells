private static KeyValueMap toMap(List<Object> kvlist){
  if (kvlist.size() % 2 != 0) {
    throw new IllegalArgumentException("Key-Value list must contain an even number of key-value tuples");
  }
  Map<String,Object> map=new LinkedHashMap<>(kvlist.size() / 2);
  for (int i=0; i < kvlist.size(); i+=2) {
    String key=(String)kvlist.get(i);
    Object value=kvlist.get(i + 1);
    map.put(key,value);
  }
  return new KeyValueMap(map);
}
