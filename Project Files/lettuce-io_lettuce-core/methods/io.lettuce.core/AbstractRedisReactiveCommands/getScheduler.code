private EventExecutorGroup getScheduler(){
  EventExecutorGroup scheduler=this.scheduler;
  if (scheduler != null) {
    return scheduler;
  }
  EventExecutorGroup schedulerToUse=ImmediateEventExecutor.INSTANCE;
  if (connection.getOptions().isPublishOnScheduler()) {
    schedulerToUse=connection.getResources().eventExecutorGroup();
  }
  return this.scheduler=schedulerToUse;
}
