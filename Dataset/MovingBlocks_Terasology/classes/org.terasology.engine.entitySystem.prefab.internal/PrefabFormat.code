public class PrefabFormat extends AbstractAssetFileFormat<PrefabData> {
  private static final Logger logger=LoggerFactory.getLogger(PrefabFormat.class);
  private ComponentLibrary componentLibrary;
  private TypeHandlerLibrary typeHandlerLibrary;
  public PrefabFormat(  ComponentLibrary componentLibrary,  TypeHandlerLibrary typeHandlerLibrary){
    super("prefab");
    this.componentLibrary=componentLibrary;
    this.typeHandlerLibrary=typeHandlerLibrary;
  }
  @Override public PrefabData load(  ResourceUrn resourceUrn,  List<AssetDataFile> inputs) throws IOException {
    try (BufferedReader reader=new BufferedReader(new InputStreamReader(inputs.get(0).openStream(),Charsets.UTF_8))){
      EntityData.Prefab prefabData=EntityDataJSONFormat.readPrefab(reader);
      if (prefabData != null) {
        if (!prefabData.hasName()) {
          prefabData=prefabData.toBuilder().setName(resourceUrn.toString()).build();
        }
        logger.debug("Deserializing prefab {} with inputs {}",resourceUrn,inputs);
        PrefabSerializer serializer=new PrefabSerializer(componentLibrary,typeHandlerLibrary);
        return serializer.deserialize(prefabData);
      }
 else {
        throw new IOException("Failed to read prefab for '" + resourceUrn + "'");
      }
    }
   }
}
