@Test public void testPartitionByHashMod(){
  PartitionByHashMod partition=new PartitionByHashMod();
  partition.setCount(3);
  Assert.assertEquals(3,partition.getPartitionNum());
  RuleConfig rule=new RuleConfig("id","partition-hash-mod");
  rule.setRuleAlgorithm(partition);
  TableConfig tableConf=new TableConfig("test","id",true,false,-1,"dn1,dn2,dn3",null,rule,true,null,false,null,null,null,false);
  int suit1=partition.suitableFor(tableConf);
  Assert.assertEquals(0,suit1);
  tableConf.getDataNodes().clear();
  tableConf.getDataNodes().addAll(Arrays.asList("dn1","dn2","dn3","dn4"));
  int suit2=partition.suitableFor(tableConf);
  Assert.assertEquals(1,suit2);
  tableConf.getDataNodes().clear();
  tableConf.getDataNodes().addAll(Arrays.asList("dn1","dn2"));
  int suit3=partition.suitableFor(tableConf);
  Assert.assertEquals(-1,suit3);
}
