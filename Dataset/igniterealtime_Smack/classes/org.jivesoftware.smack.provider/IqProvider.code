/** 
 * An abstract class for parsing custom  {@link IQ} packets. Each IqProvider must be registered with the {@link ProviderManager} for it to be used. Every implementation of this abstract class <b>must</b> have a public,no-argument constructor.
 * @param < I > the {@link IQ} that is parsed by implementations.
 */
public abstract class IqProvider<I extends IQ> extends AbstractProvider<I> {
  public final I parse(  XmlPullParser parser,  IqData iqCommon) throws XmlPullParserException, IOException, SmackParsingException {
    return parse(parser,iqCommon,null);
  }
  public final I parse(  XmlPullParser parser,  IqData iqData,  XmlEnvironment outerXmlEnvironment) throws XmlPullParserException, IOException, SmackParsingException {
    final int initialDepth=parser.getDepth();
    final XmlEnvironment xmlEnvironment=XmlEnvironment.from(parser,outerXmlEnvironment);
    I i=wrapExceptions(() -> parse(parser,initialDepth,iqData,xmlEnvironment));
    ParserUtils.forwardToEndTagOfDepth(parser,initialDepth);
    return i;
  }
  public abstract I parse(  XmlPullParser parser,  int initialDepth,  IqData iqData,  XmlEnvironment xmlEnvironment) throws XmlPullParserException, IOException, SmackParsingException, ParseException ;
}
