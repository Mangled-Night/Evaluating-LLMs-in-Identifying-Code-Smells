private void advanceToNextPage(){
synchronized (this) {
    int nextIdx=dataPages.indexOf(currentPage) + 1;
    if (destructive && currentPage != null) {
      dataPages.remove(currentPage);
      freePage(currentPage);
      nextIdx--;
    }
    if (dataPages.size() > nextIdx) {
      currentPage=dataPages.get(nextIdx);
      pageBaseObject=currentPage.getBaseObject();
      offsetInPage=currentPage.getBaseOffset();
      recordsInPage=Platform.getInt(pageBaseObject,offsetInPage);
      offsetInPage+=4;
    }
 else {
      currentPage=null;
      if (reader != null) {
        File file=spillWriters.removeFirst().getFile();
        if (file != null && file.exists()) {
          if (!file.delete()) {
            logger.error("Was unable to delete spill file {}",file.getAbsolutePath());
          }
        }
      }
      try {
        Closeables.close(reader,false);
        if (spillWriters.size() > 0) {
          reader=spillWriters.getFirst().getReader(serializerManager);
        }
        recordsInPage=-1;
      }
 catch (      IOException e) {
        Platform.throwException(e);
      }
    }
  }
}
