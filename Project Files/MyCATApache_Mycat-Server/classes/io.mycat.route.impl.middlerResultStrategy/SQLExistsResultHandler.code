/** 
 * 对于 EXISTS/NOT EXISTS, 判断subquery结果集是否为空。
 * @author lyj
 */
public class SQLExistsResultHandler implements RouteMiddlerReaultHandler {
  @Override public String dohandler(  SQLStatement statement,  SQLSelect sqlselect,  SQLObject parent,  List param){
    SQLExpr se=null;
    if (param == null || param.isEmpty()) {
      se=new SQLNullExpr();
    }
 else {
      se=(SQLExpr)param.get(0);
    }
    if (parent.getParent() instanceof MySqlSelectQueryBlock) {
      MySqlSelectQueryBlock msqb=(MySqlSelectQueryBlock)parent.getParent();
      msqb.setWhere(se);
    }
 else     if (parent.getParent() instanceof SQLBinaryOpExpr) {
      SQLBinaryOpExpr sbqe=(SQLBinaryOpExpr)parent.getParent();
      if (sbqe.getLeft().equals(parent)) {
        sbqe.setLeft(se);
      }
 else {
        sbqe.setRight(se);
      }
    }
    return statement.toString();
  }
}
