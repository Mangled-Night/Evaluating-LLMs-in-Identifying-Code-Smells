@Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals){
  if (principals == null) {
    throw new AuthorizationException("PrincipalCollection method argument cannot be null.");
  }
  LitemallAdmin admin=(LitemallAdmin)getAvailablePrincipal(principals);
  Integer[] roleIds=admin.getRoleIds();
  Set<String> roles=roleService.queryByIds(roleIds);
  Set<String> permissions=permissionService.queryByRoleIds(roleIds);
  SimpleAuthorizationInfo info=new SimpleAuthorizationInfo();
  info.setRoles(roles);
  info.setStringPermissions(permissions);
  return info;
}
