/** 
 * 账号信息更新
 * @param body    请求内容{ password: xxx, mobile: xxx code: xxx } 其中code是手机验证码，目前还不支持手机短信验证码
 * @param request 请求对象
 * @return 登录结果成功则 { errno: 0, errmsg: '成功' } 失败则 { errno: XXX, errmsg: XXX }
 */
@PostMapping("profile") public Object profile(@LoginUser Integer userId,@RequestBody String body,HttpServletRequest request){
  if (userId == null) {
    return ResponseUtil.unlogin();
  }
  String avatar=JacksonUtil.parseString(body,"avatar");
  Byte gender=JacksonUtil.parseByte(body,"gender");
  String nickname=JacksonUtil.parseString(body,"nickname");
  LitemallUser user=userService.findById(userId);
  if (!StringUtils.isEmpty(avatar)) {
    user.setAvatar(avatar);
  }
  if (gender != null) {
    user.setGender(gender);
  }
  if (!StringUtils.isEmpty(nickname)) {
    user.setNickname(nickname);
  }
  if (userService.updateById(user) == 0) {
    return ResponseUtil.updatedDataFailed();
  }
  return ResponseUtil.ok();
}
