@SafeVarargs @Override public final Iterable<EntityRef> getEntitiesWith(Class<? extends Component>... componentClasses){
  return () -> entityStore.keySet().stream().filter(id -> {
    for (    Class<? extends Component> component : componentClasses) {
      if (componentStore.get(id,component) == null) {
        return false;
      }
    }
    return true;
  }
).map(id -> getEntity(id)).iterator();
}
