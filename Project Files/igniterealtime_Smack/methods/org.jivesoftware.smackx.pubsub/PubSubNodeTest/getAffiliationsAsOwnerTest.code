@Test public void getAffiliationsAsOwnerTest() throws InterruptedException, SmackException, IOException, XMPPException, Exception {
  Protocol protocol=new Protocol();
  XMPPConnection connection=ConnectionUtils.createMockedConnection(protocol,JidTestUtil.FULL_JID_1_RESOURCE_1);
  PubSubManager mgr=new PubSubManager(connection,JidTestUtil.PUBSUB_EXAMPLE_ORG);
  Node testNode=new LeafNode(mgr,"princely_musings");
  List<Affiliation> affiliations=Arrays.asList(new Affiliation(JidTestUtil.BARE_JID_1,Affiliation.Type.member),new Affiliation(JidTestUtil.BARE_JID_2,Affiliation.Type.publisher));
  AffiliationsExtension affiliationsExtension=new AffiliationsExtension(AffiliationNamespace.owner,affiliations);
  PubSub response=new PubSub(JidTestUtil.PUBSUB_EXAMPLE_ORG,IQ.Type.result,PubSubNamespace.owner);
  response.addExtension(affiliationsExtension);
  protocol.addResponse(response);
  List<Affiliation> returnedAffiliations=testNode.getAffiliationsAsOwner();
  PubSub request=(PubSub)protocol.getRequests().get(0);
  assertEquals("http://jabber.org/protocol/pubsub#owner",request.getChildElementNamespace());
  assertEquals("pubsub",request.getChildElementName());
  Affiliation affiliationOne=returnedAffiliations.get(0);
  assertEquals(affiliationOne.getJid(),JidTestUtil.BARE_JID_1);
  assertEquals(affiliationOne.getAffiliation(),Affiliation.Type.member);
  Affiliation affiliationTwo=returnedAffiliations.get(1);
  assertEquals(affiliationTwo.getJid(),JidTestUtil.BARE_JID_2);
  assertEquals(affiliationTwo.getAffiliation(),Affiliation.Type.publisher);
}
