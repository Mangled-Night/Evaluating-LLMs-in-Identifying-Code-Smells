/** 
 * Extract the connection state from a from a  {@link StatefulConnection}.
 * @param connection the connection
 * @return the connection state as {@link String}
 */
public static String getConnectionState(StatefulConnection<?,?> connection){
  Channel channel=getChannel(connection);
  if (channel != null) {
    CommandHandler commandHandler=channel.pipeline().get(CommandHandler.class);
    return ReflectionTestUtils.getField(commandHandler,"lifecycleState").toString();
  }
  return "";
}
