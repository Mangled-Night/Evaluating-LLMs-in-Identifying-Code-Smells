@Override public void onResult(SQLQueryResult<Map<String,String>> result){
  if (result.isSuccess()) {
    int balance=heartbeat.getSource().getDbPool().getBalance();
    PhysicalDatasource source=heartbeat.getSource();
    int switchType=source.getHostConfig().getSwitchType();
    Map<String,String> resultResult=result.getResult();
    if (resultResult != null && !resultResult.isEmpty() && switchType == DataHostConfig.SYN_STATUS_SWITCH_DS && source.getHostConfig().isShowSlaveSql()) {
      String Slave_IO_Running=resultResult != null ? resultResult.get("Slave_IO_Running") : null;
      String Slave_SQL_Running=resultResult != null ? resultResult.get("Slave_SQL_Running") : null;
      String Last_SQL_Error=resultResult != null ? resultResult.get("Last_SQL_Error") : null;
      Last_SQL_Error=Last_SQL_Error == null ? "" : Last_SQL_Error;
      if ("".equals(Last_SQL_Error) && Slave_IO_Running != null && Slave_IO_Running.equals(Slave_SQL_Running) && Slave_SQL_Running.equals("Yes") && source.isSalveOrRead()) {
        heartbeat.setDbSynStatus(DBHeartbeat.DB_SYN_NORMAL);
        String Seconds_Behind_Master=resultResult.get("Seconds_Behind_Master");
        if (null == Seconds_Behind_Master) {
          MySQLHeartbeat.LOGGER.warn("Master is down but its relay log is clean.");
          heartbeat.setSlaveBehindMaster(0);
        }
 else         if (!"".equals(Seconds_Behind_Master)) {
          int Behind_Master=Integer.parseInt(Seconds_Behind_Master);
          if (Behind_Master > source.getHostConfig().getSlaveThreshold()) {
            MySQLHeartbeat.LOGGER.warn("found MySQL master/slave Replication delay !!! " + heartbeat.getSource().getConfig() + ", binlog sync time delay: "+ Behind_Master+ "s");
          }
          heartbeat.setSlaveBehindMaster(Behind_Master);
        }
      }
 else       if (source.isSalveOrRead()) {
        MySQLHeartbeat.LOGGER.warn("found MySQL master/slave Replication err !!! " + heartbeat.getSource().getConfig() + ", "+ resultResult);
        heartbeat.setDbSynStatus(DBHeartbeat.DB_SYN_ERROR);
      }
      heartbeat.getAsynRecorder().set(resultResult,switchType);
      heartbeat.setResult(MySQLHeartbeat.OK_STATUS,this,null);
    }
 else     if (resultResult != null && !resultResult.isEmpty() && switchType == DataHostConfig.CLUSTER_STATUS_SWITCH_DS && source.getHostConfig().isShowClusterSql()) {
      String wsrep_cluster_status=resultResult != null ? resultResult.get("wsrep_cluster_status") : null;
      String wsrep_connected=resultResult != null ? resultResult.get("wsrep_connected") : null;
      String wsrep_ready=resultResult != null ? resultResult.get("wsrep_ready") : null;
      if ("ON".equals(wsrep_connected) && "ON".equals(wsrep_ready) && "Primary".equals(wsrep_cluster_status)) {
        heartbeat.setDbSynStatus(DBHeartbeat.DB_SYN_NORMAL);
        heartbeat.setResult(MySQLHeartbeat.OK_STATUS,this,null);
      }
 else {
        MySQLHeartbeat.LOGGER.warn("found MySQL  cluster status err !!! " + heartbeat.getSource().getConfig() + " wsrep_cluster_status: "+ wsrep_cluster_status+ " wsrep_connected: "+ wsrep_connected+ " wsrep_ready: "+ wsrep_ready);
        heartbeat.setDbSynStatus(DBHeartbeat.DB_SYN_ERROR);
        heartbeat.setResult(MySQLHeartbeat.ERROR_STATUS,this,null);
      }
      heartbeat.getAsynRecorder().set(resultResult,switchType);
    }
 else {
      heartbeat.setResult(MySQLHeartbeat.OK_STATUS,this,null);
    }
    heartbeat.getAsynRecorder().set(resultResult,switchType);
  }
 else {
    MySQLHeartbeat.LOGGER.warn("heart beat error: " + heartbeat.getSource().getName() + "/"+ heartbeat.getSource().getHostConfig().getName()+ " retry="+ heartbeat.getHeartbeatRetry()+ " tmo="+ heartbeat.getHeartbeatTimeout());
    heartbeat.setResult(MySQLHeartbeat.ERROR_STATUS,this,null);
  }
  lasstReveivedQryTime=System.currentTimeMillis();
  heartbeat.getRecorder().set((lasstReveivedQryTime - lastSendQryTime));
}
