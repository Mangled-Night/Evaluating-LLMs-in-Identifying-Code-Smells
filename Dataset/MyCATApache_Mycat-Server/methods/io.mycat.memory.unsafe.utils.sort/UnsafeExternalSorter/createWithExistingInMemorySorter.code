public static UnsafeExternalSorter createWithExistingInMemorySorter(DataNodeMemoryManager dataNodeMemoryManager,DataNodeDiskManager blockManager,SerializerManager serializerManager,RecordComparator recordComparator,PrefixComparator prefixComparator,int initialSize,long pageSizeBytes,UnsafeInMemorySorter inMemorySorter,boolean enableSort) throws IOException {
  UnsafeExternalSorter sorter=new UnsafeExternalSorter(dataNodeMemoryManager,blockManager,serializerManager,recordComparator,prefixComparator,initialSize,pageSizeBytes,inMemorySorter,false,enableSort);
  sorter.spill(Long.MAX_VALUE,sorter);
  sorter.inMemSorter=null;
  return sorter;
}
