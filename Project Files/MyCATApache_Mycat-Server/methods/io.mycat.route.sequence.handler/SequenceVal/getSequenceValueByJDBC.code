private Long[] getSequenceValueByJDBC(int retryCount){
  MycatConfig conf=MycatServer.getInstance().getConfig();
  PhysicalDBNode mysqlDN=conf.getDataNodes().get(this.dataNode);
  final int systemRetryCount=MycatServer.getInstance().getConfig().getSystem().getSequnceMySqlRetryCount();
  long mysqlWaitTime=MycatServer.getInstance().getConfig().getSystem().getSequnceMySqlWaitTime();
  if (retryCount > systemRetryCount) {
    this.fetching.compareAndSet(true,false);
    return null;
  }
  if (LOGGER.isDebugEnabled()) {
    LOGGER.debug("execute in datanode " + this.dataNode + " for fetch sequence sql "+ this.sql+ " with retry count:"+ retryCount);
  }
  long start=System.currentTimeMillis();
  long end=start + mysqlWaitTime;
  while (System.currentTimeMillis() < end) {
    PhysicalDatasource physicalDatasource=mysqlDN.getDbPool().getSource();
    if (physicalDatasource instanceof JDBCDatasource) {
      JDBCDatasource jdbcDatasource=(JDBCDatasource)physicalDatasource;
      Connection con=null;
      PreparedStatement pstmt=null;
      ResultSet rs=null;
      try {
        con=jdbcDatasource.getDruidConnection();
        String useDB="use `" + mysqlDN.getDatabase() + "`;";
        pstmt=con.prepareStatement(useDB);
        pstmt.execute();
        pstmt=con.prepareStatement(this.sql);
        rs=pstmt.executeQuery();
        String returnedValue="";
        if (rs.next())         returnedValue=rs.getString(1);
        if (StringUtils.isEmpty(returnedValue) || errSeqResult.equals(returnedValue)) {
          LOGGER.warn("can't fetch sequnce in db,sequnce :" + this.seqName + " detail:"+ " fetch return -999999,null , and retry "+ (retryCount)+ " time");
          sleep(100);
          return getSequenceValueByJDBC(++retryCount);
        }
        Long curVal=Long.parseLong(returnedValue.split(",")[0]);
        Long increment=Long.parseLong(returnedValue.split(",")[1]);
        if (curVal == 0) {
          LOGGER.warn("can't fetch sequnce in db,sequnce :" + this.seqName + " detail:"+ " fetch return 0,0 , and retry "+ (retryCount)+ " time");
          sleep(100);
          return getSequenceValueByJDBC(++retryCount);
        }
 else {
          this.fetching.compareAndSet(true,false);
          return new Long[]{curVal,curVal + increment};
        }
      }
 catch (      Exception e) {
        LOGGER.warn("get sequence value err ",e);
      }
 finally {
        try {
          con.close();
          pstmt.close();
          rs.close();
        }
 catch (        SQLException e) {
          e.printStackTrace();
        }
      }
    }
  }
  LOGGER.error("get sequence:" + this.seqName + " value failure, please check the sequence config");
  this.fetching.compareAndSet(true,false);
  return null;
}
