/** 
 * Get the offset associated with an address encoded by {@link DataNodeMemoryManager#encodePageNumberAndOffset(MemoryBlock,long)}
 */
public long getOffsetInPage(long pagePlusOffsetAddress){
  final long offsetInPage=decodeOffset(pagePlusOffsetAddress);
  if (tungstenMemoryMode == MemoryMode.ON_HEAP) {
    return offsetInPage;
  }
 else {
    final int pageNumber=decodePageNumber(pagePlusOffsetAddress);
    assert (pageNumber >= 0 && pageNumber < PAGE_TABLE_SIZE);
    final MemoryBlock page=pageTable[pageNumber];
    assert (page != null);
    return page.getBaseOffset() + offsetInPage;
  }
}
