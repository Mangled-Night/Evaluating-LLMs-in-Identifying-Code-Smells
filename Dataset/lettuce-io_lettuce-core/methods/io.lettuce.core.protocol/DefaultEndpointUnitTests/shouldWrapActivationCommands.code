@Test void shouldWrapActivationCommands(){
  when(channel.isActive()).thenReturn(true);
  doAnswer(i -> {
    sut.write(new Command<>(CommandType.AUTH,new StatusOutput<>(StringCodec.UTF8)));
    sut.write(Collections.singletonList(new Command<>(CommandType.SELECT,new StatusOutput<>(StringCodec.UTF8))));
    return null;
  }
).when(connectionFacade).activated();
  sut.notifyChannelActive(channel);
  DefaultChannelPromise promise=new DefaultChannelPromise(channel,ImmediateEventExecutor.INSTANCE);
  when(channel.writeAndFlush(any())).thenAnswer(invocation -> {
    if (invocation.getArguments()[0] instanceof RedisCommand) {
      queue.add((RedisCommand)invocation.getArguments()[0]);
    }
    if (invocation.getArguments()[0] instanceof Collection) {
      queue.addAll((Collection)invocation.getArguments()[0]);
    }
    return promise;
  }
);
  assertThat(queue).hasSize(2).hasOnlyElementsOfTypes(DefaultEndpoint.ActivationCommand.class);
}
