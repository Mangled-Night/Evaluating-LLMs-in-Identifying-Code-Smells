public AbstractDebugger(final XMPPConnection connection){
  super(connection);
  this.reader=new ObservableReader(reader);
  readerListener=new ReaderListener(){
    @Override public void read(    String str){
      log("RECV (" + connection.getConnectionCounter() + "): "+ str);
    }
  }
;
  this.reader.addReaderListener(readerListener);
  this.writer=new ObservableWriter(writer);
  writerListener=new WriterListener(){
    @Override public void write(    String str){
      log("SENT (" + connection.getConnectionCounter() + "): "+ str);
    }
  }
;
  this.writer.addWriterListener(writerListener);
  connListener=new ConnectionListener(){
    @Override public void connected(    XMPPConnection connection){
      log("XMPPConnection connected (" + connection + ")");
    }
    @Override public void authenticated(    XMPPConnection connection,    boolean resumed){
      String logString="XMPPConnection authenticated (" + connection + ")";
      if (resumed) {
        logString+=" and resumed";
      }
      log(logString);
    }
    @Override public void connectionClosed(){
      log("XMPPConnection closed (" + connection + ")");
    }
    @Override public void connectionClosedOnError(    Exception e){
      log("XMPPConnection closed due to an exception (" + connection + ")",e);
    }
  }
;
  reconnectionListener=new ReconnectionListener(){
    @Override public void reconnectionFailed(    Exception e){
      log("Reconnection failed due to an exception (" + connection + ")",e);
    }
    @Override public void reconnectingIn(    int seconds){
      log("XMPPConnection (" + connection + ") will reconnect in "+ seconds);
    }
  }
;
  if (connection instanceof AbstractXMPPConnection) {
    AbstractXMPPConnection abstractXmppConnection=(AbstractXMPPConnection)connection;
    ReconnectionManager.getInstanceFor(abstractXmppConnection).addReconnectionListener(reconnectionListener);
  }
 else {
    LOGGER.info("The connection instance " + connection + " is not an instance of AbstractXMPPConnection, thus we can not install the ReconnectionListener");
  }
}
