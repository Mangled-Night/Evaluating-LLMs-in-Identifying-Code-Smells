private static final class KVComparator extends RecordComparator {
  private final BaseOrdering ordering;
  private final UnsafeRow row1;
  private final UnsafeRow row2;
  private final int numKeyFields;
  KVComparator(  BaseOrdering ordering,  int numKeyFields){
    this.numKeyFields=numKeyFields;
    this.row1=new UnsafeRow(numKeyFields);
    this.row2=new UnsafeRow(numKeyFields);
    this.ordering=ordering;
  }
  @Override public int compare(  Object baseObj1,  long baseOff1,  Object baseObj2,  long baseOff2){
    row1.pointTo(baseObj1,baseOff1 + 4,-1);
    row2.pointTo(baseObj2,baseOff2 + 4,-1);
    return ordering.compare(row1,row2);
  }
}
