/** 
 * Connection to identify a connection either by nodeId or host/port.
 */
class ConnectionKey {
  final ConnectionIntent connectionIntent;
  final String nodeId;
  final String host;
  final int port;
  public ConnectionKey(  ConnectionIntent connectionIntent,  String nodeId){
    this.connectionIntent=connectionIntent;
    this.nodeId=nodeId;
    this.host=null;
    this.port=0;
  }
  public ConnectionKey(  ConnectionIntent connectionIntent,  String host,  int port){
    this.connectionIntent=connectionIntent;
    this.host=host;
    this.port=port;
    this.nodeId=null;
  }
  @Override public boolean equals(  Object o){
    if (this == o)     return true;
    if (!(o instanceof ConnectionKey))     return false;
    ConnectionKey key=(ConnectionKey)o;
    if (port != key.port)     return false;
    if (connectionIntent != key.connectionIntent)     return false;
    if (nodeId != null ? !nodeId.equals(key.nodeId) : key.nodeId != null)     return false;
    return !(host != null ? !host.equals(key.host) : key.host != null);
  }
  @Override public int hashCode(){
    int result=connectionIntent != null ? connectionIntent.name().hashCode() : 0;
    result=31 * result + (nodeId != null ? nodeId.hashCode() : 0);
    result=31 * result + (host != null ? host.hashCode() : 0);
    result=31 * result + port;
    return result;
  }
  @Override public String toString(){
    StringBuffer sb=new StringBuffer();
    sb.append(getClass().getSimpleName());
    sb.append(" [connectionIntent=").append(connectionIntent);
    sb.append(", nodeId='").append(nodeId).append('\'');
    sb.append(", host='").append(host).append('\'');
    sb.append(", port=").append(port);
    sb.append(']');
    return sb.toString();
  }
}
