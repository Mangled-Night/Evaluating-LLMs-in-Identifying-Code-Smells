/** 
 * Compare  {@link RedisNodeDescription} based on their latency. Lowest comes first.
 */
static class LatencyComparator implements Comparator<RedisNodeDescription> {
  private final Map<RedisNodeDescription,Long> latencies;
  public LatencyComparator(  Map<RedisNodeDescription,Long> latencies){
    this.latencies=latencies;
  }
  @Override public int compare(  RedisNodeDescription o1,  RedisNodeDescription o2){
    Long latency1=latencies.get(o1);
    Long latency2=latencies.get(o2);
    if (latency1 != null && latency2 != null) {
      return latency1.compareTo(latency2);
    }
    if (latency1 != null) {
      return -1;
    }
    if (latency2 != null) {
      return 1;
    }
    return 0;
  }
}
