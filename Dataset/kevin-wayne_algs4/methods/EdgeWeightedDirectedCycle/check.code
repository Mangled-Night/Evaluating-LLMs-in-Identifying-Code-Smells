private boolean check(){
  if (hasCycle()) {
    DirectedEdge first=null, last=null;
    for (    DirectedEdge e : cycle()) {
      if (first == null)       first=e;
      if (last != null) {
        if (last.to() != e.from()) {
          System.err.printf("cycle edges %s and %s not incident\n",last,e);
          return false;
        }
      }
      last=e;
    }
    if (first == null || last == null) {
      System.err.printf("cycle contains no edges\n");
      return false;
    }
    if (last.to() != first.from()) {
      System.err.printf("cycle edges %s and %s not incident\n",last,first);
      return false;
    }
  }
  return true;
}
