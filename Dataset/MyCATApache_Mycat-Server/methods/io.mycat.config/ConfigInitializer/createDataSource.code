private PhysicalDatasource[] createDataSource(DataHostConfig conf,String hostName,String dbType,String dbDriver,DBHostConfig[] nodes,boolean isRead){
  PhysicalDatasource[] dataSources=new PhysicalDatasource[nodes.length];
  if (dbType.equals("mysql") && dbDriver.equals("native")) {
    for (int i=0; i < nodes.length; i++) {
      nodes[i].setIdleTimeout(system.getIdleTimeout());
      MySQLDataSource ds=new MySQLDataSource(nodes[i],conf,isRead);
      dataSources[i]=ds;
    }
  }
 else   if (dbDriver.equals("jdbc")) {
    for (int i=0; i < nodes.length; i++) {
      nodes[i].setIdleTimeout(system.getIdleTimeout());
      JDBCDatasource ds=new JDBCDatasource(nodes[i],conf,isRead);
      dataSources[i]=ds;
    }
  }
 else   if ("postgresql".equalsIgnoreCase(dbType) && dbDriver.equalsIgnoreCase("native")) {
    for (int i=0; i < nodes.length; i++) {
      nodes[i].setIdleTimeout(system.getIdleTimeout());
      PostgreSQLDataSource ds=new PostgreSQLDataSource(nodes[i],conf,isRead);
      dataSources[i]=ds;
    }
  }
 else {
    throw new ConfigException("not supported yet !" + hostName);
  }
  return dataSources;
}
