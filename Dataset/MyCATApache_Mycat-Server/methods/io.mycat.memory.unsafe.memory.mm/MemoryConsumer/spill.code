/** 
 * Force spill during building. For testing.
 */
public void spill() throws IOException {
  spill(Long.MAX_VALUE,this);
}
/** 
 * Spill some data to disk to release memory, which will be called by DataNodeMemoryManager when there is not enough memory for the task. This should be implemented by subclass. Note: In order to avoid possible deadlock, should not call acquireMemory() from spill(). Note: today, this only frees Tungsten-managed pages.
 * @param size the amount of memory should be released
 * @param trigger the MemoryConsumer that trigger this spilling
 * @return the amount of released memory in bytes
 * @throws IOException
 */
public abstract long spill(long size,MemoryConsumer trigger) throws IOException ;
