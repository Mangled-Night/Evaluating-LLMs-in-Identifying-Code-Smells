/** 
 * Convert a byte array  to a int value
 * @param buf
 * @return int
 * @throws NumberFormatException
 */
public static int getInt(byte[] buf) throws NumberFormatException {
  return getInt(buf,0,buf.length);
}
public static int getInt(byte[] buf,int offset,int endPos) throws NumberFormatException {
  byte base=10;
  int s;
  for (s=offset; s < endPos && Character.isWhitespace((char)buf[s]); ++s) {
    ;
  }
  if (s == endPos) {
    throw new NumberFormatException(toString(buf));
  }
 else {
    boolean negative=false;
    if ((char)buf[s] == 45) {
      negative=true;
      ++s;
    }
 else     if ((char)buf[s] == 43) {
      ++s;
    }
    int save=s;
    int cutoff=2147483647 / base;
    int cutlim=2147483647 % base;
    if (negative) {
      ++cutlim;
    }
    boolean overflow=false;
    int i;
    for (i=0; s < endPos; ++s) {
      char c=(char)buf[s];
      if (Character.isDigit(c)) {
        c=(char)(c - 48);
      }
 else {
        if (!Character.isLetter(c)) {
          break;
        }
        c=(char)(Character.toUpperCase(c) - 65 + 10);
      }
      if (c >= base) {
        break;
      }
      if (i <= cutoff && (i != cutoff || c <= cutlim)) {
        i*=base;
        i+=c;
      }
 else {
        overflow=true;
      }
    }
    if (s == save) {
      throw new NumberFormatException(toString(buf));
    }
 else     if (overflow) {
      throw new NumberFormatException(toString(buf));
    }
 else {
      return negative ? -i : i;
    }
  }
}
