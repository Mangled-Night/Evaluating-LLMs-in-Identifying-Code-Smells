/** 
 * State object for a cluster-wide SCAN using Key results.
 * @param < K >
 */
private static class ClusterKeyScanCursor<K> extends KeyScanCursor<K> implements ClusterScanCursor {
  final List<String> nodeIds;
  final String currentNodeId;
  final KeyScanCursor<K> cursor;
  public ClusterKeyScanCursor(  List<String> nodeIds,  String currentNodeId,  KeyScanCursor<K> cursor){
    super();
    this.nodeIds=nodeIds;
    this.currentNodeId=currentNodeId;
    this.cursor=cursor;
    setCursor(cursor.getCursor());
    getKeys().addAll(cursor.getKeys());
    if (cursor.isFinished()) {
      int nodeIndex=nodeIds.indexOf(currentNodeId);
      if (nodeIndex == -1 || nodeIndex == nodeIds.size() - 1) {
        setFinished(true);
      }
    }
  }
  @Override public List<String> getNodeIds(){
    return nodeIds;
  }
  @Override public String getCurrentNodeId(){
    return currentNodeId;
  }
  public boolean isScanOnCurrentNodeFinished(){
    return cursor.isFinished();
  }
}
