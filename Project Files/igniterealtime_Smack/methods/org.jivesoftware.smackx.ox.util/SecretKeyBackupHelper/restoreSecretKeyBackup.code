/** 
 * Decrypt a secret key backup and return the  {@link PGPSecretKeyRing} contained in it.TODO: Return a PGPSecretKeyRingCollection instead?
 * @param backup encrypted {@link SecretkeyElement} containing the backup
 * @param backupCode passphrase for decrypting the {@link SecretkeyElement}.
 * @return the TODO javadoc me please
 * @throws InvalidBackupCodeException in case the provided backup code is invalid.
 * @throws IOException IO is dangerous.
 * @throws PGPException PGP is brittle.
 */
public static PGPSecretKeyRing restoreSecretKeyBackup(SecretkeyElement backup,OpenPgpSecretKeyBackupPassphrase backupCode) throws InvalidBackupCodeException, IOException, PGPException {
  byte[] encrypted=Base64.decode(backup.getB64Data());
  InputStream encryptedIn=new ByteArrayInputStream(encrypted);
  ByteArrayOutputStream plaintextOut=new ByteArrayOutputStream();
  try {
    DecryptionStream decryptionStream=PGPainless.decryptAndOrVerify().onInputStream(encryptedIn).withOptions(new ConsumerOptions().addDecryptionPassphrase(Passphrase.fromPassword(backupCode.toString())));
    Streams.pipeAll(decryptionStream,plaintextOut);
    decryptionStream.close();
  }
 catch (  MissingDecryptionMethodException e) {
    throw new InvalidBackupCodeException("Could not decrypt secret key backup. Possibly wrong passphrase?",e);
  }
  byte[] decrypted=plaintextOut.toByteArray();
  return PGPainless.readKeyRing().secretKeyRing(decrypted);
}
