@Override public void run(){
  Connection con=null;
  try {
    List<Map<String,String>> batch=getNextBatch();
    while (!batch.isEmpty()) {
      try {
        if (con == null || con.isClosed()) {
          con=conPool.getConnection();
          con.setAutoCommit(false);
        }
        insert(con,batch);
        finshiedCount.addAndGet(batch.size());
      }
 catch (      Exception e) {
        e.printStackTrace();
        try {
          con.rollback();
        }
 catch (        SQLException e1) {
          e1.printStackTrace();
          e1.printStackTrace();
        }
        failedCount.addAndGet(batch.size());
      }
      batch=getNextBatch();
    }
  }
  finally {
    if (con != null) {
      this.conPool.returnCon(con);
    }
  }
}
