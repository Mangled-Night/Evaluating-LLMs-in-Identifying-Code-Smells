public static File createDirectory(String rootDir,String blockmgr) throws IOException {
  int attempts=0;
  int maxAttempts=MAX_DIR_CREATION_ATTEMPTS;
  File dir=null;
  while (dir == null) {
    attempts+=1;
    if (attempts > maxAttempts) {
      throw new IOException("Failed to create a temp directory (under " + rootDir + ") after "+ maxAttempts+ " attempts!");
    }
    try {
      dir=new File(rootDir,blockmgr + "-" + UUID.randomUUID().toString());
      if (dir.exists() || !dir.mkdirs()) {
        dir=null;
      }
    }
 catch (    Exception e) {
      logger.error(e.getMessage());
    }
  }
  return dir.getCanonicalFile();
}
