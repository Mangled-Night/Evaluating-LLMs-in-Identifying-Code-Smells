@Override public <K,V>void build(CommandArgs<K,V> args){
  if (weights != null && !weights.isEmpty()) {
    args.add(WEIGHTS);
    for (    double weight : weights) {
      args.add(weight);
    }
  }
  if (aggregate != null) {
    args.add(AGGREGATE);
switch (aggregate) {
case SUM:
      args.add(SUM);
    break;
case MIN:
  args.add(MIN);
break;
case MAX:
args.add(MAX);
break;
default :
throw new IllegalArgumentException("Aggregation " + aggregate + " not supported");
}
}
}
