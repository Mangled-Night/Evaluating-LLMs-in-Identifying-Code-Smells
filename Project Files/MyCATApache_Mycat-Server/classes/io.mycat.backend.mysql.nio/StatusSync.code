private static class StatusSync {
  private final String schema;
  private final Integer charsetIndex;
  private final Integer txtIsolation;
  private final Boolean autocommit;
  private final AtomicInteger synCmdCount;
  private final boolean xaStarted;
  private final Boolean txReadonly;
  private final Integer sqlSelectLimit;
  public StatusSync(  boolean xaStarted,  String schema,  Integer charsetIndex,  Integer txtIsolation,  Boolean autocommit,  int synCount,  boolean txReadonly,  Integer sqlSelectLimit){
    super();
    this.xaStarted=xaStarted;
    this.schema=schema;
    this.charsetIndex=charsetIndex;
    this.txtIsolation=txtIsolation;
    this.autocommit=autocommit;
    this.synCmdCount=new AtomicInteger(synCount);
    this.txReadonly=txReadonly;
    this.sqlSelectLimit=sqlSelectLimit;
  }
  public boolean synAndExecuted(  MySQLConnection conn){
    int remains=synCmdCount.decrementAndGet();
    if (remains == 0) {
      this.updateConnectionInfo(conn);
      conn.metaDataSyned=true;
      return false;
    }
 else     if (remains < 0) {
      return true;
    }
    return false;
  }
  private void updateConnectionInfo(  MySQLConnection conn){
    if (schema != null) {
      conn.schema=schema;
      conn.oldSchema=conn.schema;
    }
    if (charsetIndex != null) {
      conn.setCharset(CharsetUtil.getCharset(charsetIndex));
    }
    if (txtIsolation != null) {
      conn.txIsolation=txtIsolation;
    }
    if (autocommit != null) {
      conn.autocommit=autocommit;
    }
    if (txReadonly != null) {
      conn.txReadonly=txReadonly;
    }
    if (sqlSelectLimit != null) {
      conn.sqlSelectLimit=sqlSelectLimit;
    }
  }
}
