/** 
 * Checks if a  {@link org.terasology.protobuf.NetData.ServerInfoMessage} was received and disconnects.
 */
public class ServerInfoRequestHandler extends ChannelInboundHandlerAdapter {
  private static final Logger logger=LoggerFactory.getLogger(ServerInfoRequestHandler.class);
  private volatile ServerInfoMessage serverInfo;
  @Override public void exceptionCaught(  ChannelHandlerContext ctx,  Throwable cause) throws Exception {
    logger.warn("Could not query server info: {}",cause.toString());
  }
  @Override public void channelRead(  ChannelHandlerContext ctx,  Object msg) throws Exception {
    NetData.NetMessage message=(NetData.NetMessage)msg;
    if (message.hasServerInfo()) {
      logger.info("Received server info");
      serverInfo=new ServerInfoMessageImpl(message.getServerInfo());
    }
 else {
      logger.error("Received unexpected message");
    }
    ctx.channel().close();
  }
  public ServerInfoMessage getServerInfo(){
    return serverInfo;
  }
}
