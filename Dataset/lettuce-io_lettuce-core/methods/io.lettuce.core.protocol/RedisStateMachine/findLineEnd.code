private int findLineEnd(ByteBuf buffer){
  int index=buffer.forEachByte(ByteProcessor.FIND_LF);
  return (index > 0 && buffer.getByte(index - 1) == '\r') ? index - 1 : NOT_FOUND;
}
