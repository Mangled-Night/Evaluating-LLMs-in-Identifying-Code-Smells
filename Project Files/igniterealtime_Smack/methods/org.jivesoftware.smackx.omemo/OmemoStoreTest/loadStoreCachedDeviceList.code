@Test public void loadStoreCachedDeviceList() throws IOException {
  Integer[] active=new Integer[]{1,5,999,10};
  Integer[] inactive=new Integer[]{6,7,8};
  OmemoCachedDeviceList before=new OmemoCachedDeviceList(new HashSet<>(Arrays.asList(active)),new HashSet<>(Arrays.asList(inactive)));
  assertNotNull("Loading a non-existent cached deviceList must return an empty list.",store.loadCachedDeviceList(alice,bob.getJid()));
  store.storeCachedDeviceList(alice,bob.getJid(),before);
  OmemoCachedDeviceList after=store.loadCachedDeviceList(alice,bob.getJid());
  assertTrue("Loaded deviceList must not be empty",after.getAllDevices().size() != 0);
  assertEquals("Number of entries in active devices must match.",active.length,after.getActiveDevices().size());
  assertEquals("Number of entries in inactive devices must match.",inactive.length,after.getInactiveDevices().size());
  assertEquals("Number of total entries must match.",active.length + inactive.length,after.getAllDevices().size());
  for (  Integer a : active) {
    assertTrue(after.getActiveDevices().contains(a));
    assertTrue(after.getAllDevices().contains(a));
  }
  for (  Integer i : inactive) {
    assertTrue(after.getInactiveDevices().contains(i));
    assertTrue(after.getAllDevices().contains(i));
  }
  store.storeCachedDeviceList(alice,bob.getJid(),new OmemoCachedDeviceList());
  assertEquals("DeviceList must be empty after overwriting it with empty list.",0,store.loadCachedDeviceList(alice,bob.getJid()).getAllDevices().size());
}
