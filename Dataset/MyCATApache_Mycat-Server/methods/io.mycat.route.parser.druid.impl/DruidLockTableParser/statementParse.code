@Override public void statementParse(SchemaConfig schema,RouteResultset rrs,SQLStatement stmt) throws SQLNonTransientException {
  MySqlLockTableStatement lockTableStat=(MySqlLockTableStatement)stmt;
  String table=lockTableStat.getItems().get(0).getTableSource().toString().toUpperCase();
  TableConfig tableConfig=schema.getTables().get(table);
  if (tableConfig == null) {
    String msg="can't find table define of " + table + " in schema:"+ schema.getName();
    LOGGER.warn(msg);
    throw new SQLNonTransientException(msg);
  }
  LockType lockType=lockTableStat.getItems().get(0).getLockType();
  if (LockType.WRITE != lockType && LockType.READ != lockType) {
    String msg="lock type must be write or read";
    LOGGER.warn(msg);
    throw new SQLNonTransientException(msg);
  }
  List<String> dataNodes=tableConfig.getDataNodes();
  RouteResultsetNode[] nodes=new RouteResultsetNode[dataNodes.size()];
  for (int i=0; i < dataNodes.size(); i++) {
    nodes[i]=new RouteResultsetNode(dataNodes.get(i),ServerParse.LOCK,stmt.toString());
  }
  rrs.setNodes(nodes);
  rrs.setFinishedRoute(true);
}
