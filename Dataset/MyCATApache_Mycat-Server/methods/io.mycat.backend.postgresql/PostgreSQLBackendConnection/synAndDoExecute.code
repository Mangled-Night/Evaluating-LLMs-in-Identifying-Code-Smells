private void synAndDoExecute(String xaTxID,RouteResultsetNode rrn,int clientCharSetIndex,int clientTxIsoLation,boolean clientAutoCommit,boolean clientTxReadonly){
  String xaCmd=null;
  boolean conAutoComit=this.autocommit;
  boolean conTxReadonly=this.txReadonly;
  String conSchema=this.schema;
  boolean expectAutocommit=!modifiedSQLExecuted || isFromSlaveDB() || clientAutoCommit;
  if (!expectAutocommit && xaTxID != null && xaStatus == 0) {
    clientTxIsoLation=Isolations.SERIALIZABLE;
    xaCmd="XA START " + xaTxID + ';';
    currentXaTxId=xaTxID;
  }
  int schemaSyn=conSchema.equals(oldSchema) ? 0 : 1;
  int charsetSyn=(this.charsetIndex == clientCharSetIndex) ? 0 : 1;
  int txIsoLationSyn=(txIsolation == clientTxIsoLation) ? 0 : 1;
  int autoCommitSyn=(conAutoComit == expectAutocommit) ? 0 : 1;
  int txReadonlySyn=(conTxReadonly == clientTxReadonly) ? 0 : 1;
  int synCount=schemaSyn + charsetSyn + txIsoLationSyn+ autoCommitSyn+ txReadonlySyn;
  if (synCount == 0) {
    String sql=rrn.getStatement();
    Query query=new Query(PgSqlApaterUtils.apater(sql));
    ByteBuffer buf=this.allocate();
    query.write(buf);
    this.write(buf);
    return;
  }
  StringBuilder sb=new StringBuilder();
  if (charsetSyn == 1) {
    getCharsetCommand(sb,clientCharSetIndex);
  }
  if (txIsoLationSyn == 1) {
    getTxIsolationCommand(sb,clientTxIsoLation);
  }
  if (autoCommitSyn == 1) {
    getAutocommitCommand(sb,expectAutocommit);
  }
  if (txReadonlySyn == 1) {
    getTxReadonly(sb,clientTxReadonly);
  }
  if (xaCmd != null) {
    sb.append(xaCmd);
  }
  if (LOGGER.isDebugEnabled()) {
    LOGGER.debug("con need syn ,total syn cmd " + synCount + " commands "+ sb.toString()+ "schema change:"+ ("" != null)+ " con:"+ this);
  }
  metaDataSyned=false;
  statusSync=new StatusSync(xaCmd != null,conSchema,clientCharSetIndex,clientTxIsoLation,expectAutocommit,synCount,clientTxReadonly);
  String sql=sb.append(PgSqlApaterUtils.apater(rrn.getStatement())).toString();
  if (LOGGER.isDebugEnabled()) {
    LOGGER.debug("con={}, SQL={}",this,sql);
  }
  Query query=new Query(sql);
  ByteBuffer buf=allocate();
  query.write(buf);
  this.write(buf);
  metaDataSyned=true;
}
