/** 
 * @author Mark Paluch
 */
public class ConnectToMasterSlaveUsingElastiCacheCluster {
  public static void main(  String[] args){
    RedisClient redisClient=RedisClient.create();
    List<RedisURI> nodes=Arrays.asList(RedisURI.create("redis://host1"),RedisURI.create("redis://host2"),RedisURI.create("redis://host3"));
    StatefulRedisMasterReplicaConnection<String,String> connection=MasterReplica.connect(redisClient,StringCodec.UTF8,nodes);
    connection.setReadFrom(ReadFrom.UPSTREAM_PREFERRED);
    System.out.println("Connected to Redis");
    connection.close();
    redisClient.shutdown();
  }
}
