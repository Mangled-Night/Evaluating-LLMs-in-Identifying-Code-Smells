/** 
 * Generates game manifest with default settings (title, seed) if not specified. Uses default world generator, and modules selection.
 * @TODO : rewrite/fix it when code will be more stable
 * @param universeWrapper  contains the universe level properties
 * @param moduleManager    resolves modules
 * @param config           provides default module selection, world generator
 * @return                 game manifest with default settings
 */
public static GameManifest createGameManifest(final UniverseWrapper universeWrapper,final ModuleManager moduleManager,final Config config){
  GameManifest gameManifest=new GameManifest();
  if (StringUtils.isNotBlank(universeWrapper.getGameName())) {
    gameManifest.setTitle(GameProvider.getNextGameName(universeWrapper.getGameName()));
  }
 else {
    gameManifest.setTitle(GameProvider.getNextGameName());
  }
  DependencyResolver resolver=new DependencyResolver(moduleManager.getRegistry());
  ResolutionResult result=resolver.resolve(config.getDefaultModSelection().listModules());
  if (!result.isSuccess()) {
    logger.error("Can't resolve dependencies");
    return null;
  }
  for (  Module module : result.getModules()) {
    gameManifest.addModule(module.getId(),module.getVersion());
  }
  SimpleUri uri;
  String seed;
  WorldSetupWrapper worldSetup=universeWrapper.getTargetWorld();
  if (worldSetup != null) {
    uri=worldSetup.getWorldGenerator().getUri();
    seed=worldSetup.getWorldGenerator().getWorldSeed();
  }
 else {
    uri=config.getWorldGeneration().getDefaultGenerator();
    seed=universeWrapper.getSeed();
  }
  gameManifest.setSeed(seed);
  String targetWorldName="";
  Map<String,Component> worldConfig=Maps.newHashMap();
  if (worldSetup != null) {
    targetWorldName=worldSetup.getWorldName().toString();
    if (worldSetup.getWorldConfigurator() != null) {
      gameManifest.setModuleConfigs(uri,worldSetup.getWorldConfigurator().getProperties());
    }
  }
  WorldInfo worldInfo=new WorldInfo(TerasologyConstants.MAIN_WORLD,targetWorldName,seed,(long)(WorldTime.DAY_LENGTH * WorldTime.SUNRISE_OFFSET),uri);
  gameManifest.addWorld(worldInfo);
  config.getUniverseConfig().addWorldManager(worldInfo);
  config.getUniverseConfig().setSpawnWorldTitle(worldInfo.getTitle());
  config.getUniverseConfig().setUniverseSeed(universeWrapper.getSeed());
  return gameManifest;
}
