public void heatBeatCheck(long timeout,long conHeartBeatPeriod){
  int maxConsInOneCheck=5;
  LinkedList<BackendConnection> heartBeatCons=new LinkedList<BackendConnection>();
  long hearBeatTime=TimeUtil.currentTimeMillis() - conHeartBeatPeriod;
  long hearBeatTime2=TimeUtil.currentTimeMillis() - 2 * conHeartBeatPeriod;
  for (  ConQueue queue : conMap.getAllConQueue()) {
    checkIfNeedHeartBeat(heartBeatCons,queue,queue.getAutoCommitCons(),hearBeatTime,hearBeatTime2);
    if (heartBeatCons.size() < maxConsInOneCheck) {
      checkIfNeedHeartBeat(heartBeatCons,queue,queue.getManCommitCons(),hearBeatTime,hearBeatTime2);
    }
 else     if (heartBeatCons.size() >= maxConsInOneCheck) {
      break;
    }
  }
  if (!heartBeatCons.isEmpty()) {
    for (    BackendConnection con : heartBeatCons) {
      conHeartBeatHanler.doHeartBeat(con,hostConfig.getHearbeatSQL());
    }
  }
  conHeartBeatHanler.abandTimeOuttedConns();
  int idleCons=getIdleCount();
  int activeCons=this.getActiveCount();
  int createCount=(hostConfig.getMinCon() - idleCons) / 3;
  if ((createCount > 0) && (idleCons + activeCons < size) && (idleCons < hostConfig.getMinCon())) {
    createByIdleLitte(idleCons,createCount);
  }
 else   if (idleCons > hostConfig.getMinCon()) {
    closeByIdleMany(idleCons - hostConfig.getMinCon());
  }
 else {
    int activeCount=this.getActiveCount();
    if (activeCount > size) {
      StringBuilder s=new StringBuilder();
      s.append(Alarms.DEFAULT).append("DATASOURCE EXCEED [name=").append(name).append(",active=");
      s.append(activeCount).append(",size=").append(size).append(']');
      LOGGER.warn(s.toString());
    }
  }
}
