protected void performActionAndWaitUntilStanzaReceived(Runnable action,XMPPConnection connection,StanzaFilter filter) throws NoResponseException, XMPPErrorException, NotConnectedException, InterruptedException {
  StanzaCollector.Configuration configuration=StanzaCollector.newConfiguration().setStanzaFilter(filter).setSize(1);
  try (StanzaCollector collector=connection.createStanzaCollector(configuration)){
    action.run();
    collector.nextResultOrThrow(timeout);
  }
 }
