@Test public void failureToAllocateFirstPage(){
  memoryManager.limit(1024);
  BytesToBytesMap map=new BytesToBytesMap(dataNodeMemoryManager,1,PAGE_SIZE_BYTES);
  try {
    final long[] emptyArray=new long[0];
    final BytesToBytesMap.Location loc=map.lookup(emptyArray,Platform.LONG_ARRAY_OFFSET,0);
    Assert.assertFalse(loc.isDefined());
    Assert.assertFalse(loc.append(emptyArray,Platform.LONG_ARRAY_OFFSET,0,emptyArray,Platform.LONG_ARRAY_OFFSET,0));
  }
  finally {
    map.free();
  }
}
