/** 
 * Unit tests for  {@link CommandDetailParser}.
 * @author Mark Paluch
 * @author Mikhael Sokolov
 */
class CommandDetailParserUnitTests {
  @Test void testMappings(){
    assertThat(CommandDetailParser.FLAG_MAPPING).hasSameSizeAs(CommandDetail.Flag.values());
  }
  @Test void testEmptyList(){
    List<CommandDetail> result=CommandDetailParser.parse(new ArrayList<>());
    assertThat(result).isEmpty();
  }
  @Test void testMalformedList(){
    Object o=LettuceLists.newList("","","");
    List<CommandDetail> result=CommandDetailParser.parse(LettuceLists.newList(o));
    assertThat(result).isEmpty();
  }
  @Test void testParse(){
    Object o=LettuceLists.newList("get","1",LettuceLists.newList("fast","loading"),1L,2L,3L,LettuceLists.newList("@read","@string","@fast"));
    List<CommandDetail> result=CommandDetailParser.parse(LettuceLists.newList(o));
    assertThat(result).hasSize(1);
    CommandDetail commandDetail=result.get(0);
    assertThat(commandDetail.getName()).isEqualTo("get");
    assertThat(commandDetail.getArity()).isEqualTo(1);
    assertThat(commandDetail.getFlags()).hasSize(2);
    assertThat(commandDetail.getFirstKeyPosition()).isEqualTo(1);
    assertThat(commandDetail.getLastKeyPosition()).isEqualTo(2);
    assertThat(commandDetail.getKeyStepCount()).isEqualTo(3);
    assertThat(commandDetail.getAclCategories()).hasSize(3);
  }
  @Test void testModel(){
    CommandDetail commandDetail=new CommandDetail();
    commandDetail.setArity(1);
    commandDetail.setFirstKeyPosition(2);
    commandDetail.setLastKeyPosition(3);
    commandDetail.setKeyStepCount(4);
    commandDetail.setName("theName");
    commandDetail.setFlags(new HashSet<>());
    commandDetail.setAclCategories(new HashSet<>());
    assertThat(commandDetail.toString()).contains(CommandDetail.class.getSimpleName());
  }
}
