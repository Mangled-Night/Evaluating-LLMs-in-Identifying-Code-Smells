@Override public AdHocCommandData parse(XmlPullParser parser,int initialDepth,IqData iqData,XmlEnvironment xmlEnvironment) throws XmlPullParserException, IOException, SmackParsingException {
  boolean done=false;
  AdHocCommandData adHocCommandData=new AdHocCommandData();
  DataFormProvider dataFormProvider=new DataFormProvider();
  XmlPullParser.Event eventType;
  String elementName;
  String namespace;
  adHocCommandData.setSessionID(parser.getAttributeValue("","sessionid"));
  adHocCommandData.setNode(parser.getAttributeValue("","node"));
  String status=parser.getAttributeValue("","status");
  if (AdHocCommand.Status.executing.toString().equalsIgnoreCase(status)) {
    adHocCommandData.setStatus(AdHocCommand.Status.executing);
  }
 else   if (AdHocCommand.Status.completed.toString().equalsIgnoreCase(status)) {
    adHocCommandData.setStatus(AdHocCommand.Status.completed);
  }
 else   if (AdHocCommand.Status.canceled.toString().equalsIgnoreCase(status)) {
    adHocCommandData.setStatus(AdHocCommand.Status.canceled);
  }
  String action=parser.getAttributeValue("","action");
  if (action != null) {
    Action realAction=AdHocCommand.Action.valueOf(action);
    if (realAction == null || realAction.equals(Action.unknown)) {
      adHocCommandData.setAction(Action.unknown);
    }
 else {
      adHocCommandData.setAction(realAction);
    }
  }
  while (!done) {
    eventType=parser.next();
    namespace=parser.getNamespace();
    if (eventType == XmlPullParser.Event.START_ELEMENT) {
      elementName=parser.getName();
      if (parser.getName().equals("actions")) {
        String execute=parser.getAttributeValue("","execute");
        if (execute != null) {
          adHocCommandData.setExecuteAction(AdHocCommand.Action.valueOf(execute));
        }
      }
 else       if (parser.getName().equals("next")) {
        adHocCommandData.addAction(AdHocCommand.Action.next);
      }
 else       if (parser.getName().equals("complete")) {
        adHocCommandData.addAction(AdHocCommand.Action.complete);
      }
 else       if (parser.getName().equals("prev")) {
        adHocCommandData.addAction(AdHocCommand.Action.prev);
      }
 else       if (elementName.equals("x") && namespace.equals("jabber:x:data")) {
        adHocCommandData.setForm(dataFormProvider.parse(parser));
      }
 else       if (parser.getName().equals("note")) {
        String typeString=parser.getAttributeValue("","type");
        AdHocCommandNote.Type type;
        if (typeString != null) {
          type=AdHocCommandNote.Type.valueOf(typeString);
        }
 else {
          type=AdHocCommandNote.Type.info;
        }
        String value=parser.nextText();
        adHocCommandData.addNote(new AdHocCommandNote(type,value));
      }
 else       if (parser.getName().equals("error")) {
        StanzaError error=PacketParserUtils.parseError(parser);
        adHocCommandData.setError(error);
      }
    }
 else     if (eventType == XmlPullParser.Event.END_ELEMENT) {
      if (parser.getName().equals("command")) {
        done=true;
      }
    }
  }
  return adHocCommandData;
}
@Override public AdHocCommandData.SpecificError parse(XmlPullParser parser,int initialDepth,XmlEnvironment xmlEnvironment){
  return new AdHocCommandData.SpecificError(AdHocCommand.SpecificErrorCondition.badAction);
}
@Override public AdHocCommandData.SpecificError parse(XmlPullParser parser,int initialDepth,XmlEnvironment xmlEnvironment){
  return new AdHocCommandData.SpecificError(AdHocCommand.SpecificErrorCondition.malformedAction);
}
@Override public AdHocCommandData.SpecificError parse(XmlPullParser parser,int initialDepth,XmlEnvironment xmlEnvironment){
  return new AdHocCommandData.SpecificError(AdHocCommand.SpecificErrorCondition.badLocale);
}
@Override public AdHocCommandData.SpecificError parse(XmlPullParser parser,int initialDepth,XmlEnvironment xmlEnvironment){
  return new AdHocCommandData.SpecificError(AdHocCommand.SpecificErrorCondition.badPayload);
}
@Override public AdHocCommandData.SpecificError parse(XmlPullParser parser,int initialDepth,XmlEnvironment xmlEnvironment){
  return new AdHocCommandData.SpecificError(AdHocCommand.SpecificErrorCondition.badSessionid);
}
@Override public AdHocCommandData.SpecificError parse(XmlPullParser parser,int initialDepth,XmlEnvironment xmlEnvironment){
  return new AdHocCommandData.SpecificError(AdHocCommand.SpecificErrorCondition.sessionExpired);
}
