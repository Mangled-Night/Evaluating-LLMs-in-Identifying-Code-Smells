/** 
 * Sorts the map's records in place, spill them to disk, and returns an [[UnsafeKVExternalSorter]] Note that the map will be reset for inserting new records, and the returned sorter can NOT be used to insert records.
 */
public UnsafeKVExternalSorter destructAndCreateExternalSorter() throws IOException {
  return new UnsafeKVExternalSorter(groupingKeySchema,aggregationBufferSchema,MycatServer.getInstance().getMyCatMemory().getBlockManager(),MycatServer.getInstance().getMyCatMemory().getSerializerManager(),map.getPageSizeBytes(),map);
}
