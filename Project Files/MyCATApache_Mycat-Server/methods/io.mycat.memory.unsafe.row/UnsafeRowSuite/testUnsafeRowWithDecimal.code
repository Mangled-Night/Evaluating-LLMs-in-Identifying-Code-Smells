public void testUnsafeRowWithDecimal(){
  int fieldCount=4;
  String value="12345678901234567890123456789.0123456789";
  String value1="100";
  BigDecimal decimal=new BigDecimal(value);
  BigDecimal decimal1=new BigDecimal(value1);
  System.out.println("decimal precision : " + decimal.precision() + ", scale : "+ decimal.scale());
  UnsafeRow unsafeRow=new UnsafeRow(fieldCount);
  BufferHolder bufferHolder=new BufferHolder(unsafeRow,64);
  UnsafeRowWriter unsafeRowWriter=new UnsafeRowWriter(bufferHolder,fieldCount);
  bufferHolder.reset();
  unsafeRow.setInt(0,100);
  unsafeRow.setDouble(1,0.99);
  unsafeRow.setLong(2,1000);
  unsafeRowWriter.write(3,decimal);
  assertEquals(100,unsafeRow.getInt(0));
  assertEquals("0.99",String.valueOf(unsafeRow.getDouble(1)));
  assertEquals(1000,unsafeRow.getLong(2));
  assertEquals(decimal,unsafeRow.getDecimal(3,decimal.scale()));
  unsafeRow.updateDecimal(3,decimal1);
  assertEquals(decimal1,unsafeRow.getDecimal(3,decimal1.scale()));
  BigDecimal nullDecimal=null;
  unsafeRow.updateDecimal(3,nullDecimal);
  assertEquals(nullDecimal,unsafeRow.getDecimal(3,0));
  unsafeRow.updateDecimal(3,decimal);
  assertEquals(decimal,unsafeRow.getDecimal(3,decimal.scale()));
}
