/** 
 * 测试函数COUNT
 * @throws Exception
 */
@Test public void testAggregateExpr() throws Exception {
  SchemaConfig schema=schemaMap.get("TESTDB");
  String sql="select id, name, count(name) from employee group by name;";
  RouteResultset rrs=routeStrategy.route(new SystemConfig(),schema,ServerParse.SELECT,sql,null,null,cachePool);
  Assert.assertTrue(rrs.getMergeCols().containsKey("count2"));
  sql="select id, name, count(name) as c from employee group by name;";
  rrs=routeStrategy.route(new SystemConfig(),schema,ServerParse.SELECT,sql,null,null,cachePool);
  Assert.assertTrue(rrs.getMergeCols().containsKey("c"));
  sql="select id, name, count(name) c from employee group by name;";
  rrs=routeStrategy.route(new SystemConfig(),schema,ServerParse.SELECT,sql,null,null,cachePool);
  Assert.assertTrue(rrs.getMergeCols().containsKey("c"));
}
