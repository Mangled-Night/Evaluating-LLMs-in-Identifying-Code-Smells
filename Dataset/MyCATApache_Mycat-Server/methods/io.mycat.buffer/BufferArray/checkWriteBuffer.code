public ByteBuffer checkWriteBuffer(int capacity){
  if (capacity > curWritingBlock.remaining()) {
    addtoBlock(curWritingBlock);
    curWritingBlock=bufferPool.allocate(capacity);
    return curWritingBlock;
  }
 else {
    return curWritingBlock;
  }
}
