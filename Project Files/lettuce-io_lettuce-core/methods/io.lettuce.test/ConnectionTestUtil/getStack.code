/** 
 * Extract the stack from a from a  {@link StatefulConnection}.
 * @param connection the connection
 * @return the stack
 */
public static Queue<Object> getStack(StatefulConnection<?,?> connection){
  Channel channel=getChannel(connection);
  if (channel != null) {
    CommandHandler commandHandler=channel.pipeline().get(CommandHandler.class);
    return (Queue)commandHandler.getStack();
  }
  throw new IllegalArgumentException("Cannot obtain stack from " + connection);
}
