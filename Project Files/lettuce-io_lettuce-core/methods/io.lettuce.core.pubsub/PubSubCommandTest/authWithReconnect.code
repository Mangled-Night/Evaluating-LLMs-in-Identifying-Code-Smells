@Test void authWithReconnect(){
  WithPassword.run(client,() -> {
    client.setOptions(ClientOptions.builder().protocolVersion(ProtocolVersion.RESP2).pingBeforeActivateConnection(false).build());
    RedisPubSubAsyncCommands<String,String> connection=client.connectPubSub().async();
    connection.getStatefulConnection().addListener(PubSubCommandTest.this);
    connection.auth(passwd);
    connection.clientSetname("authWithReconnect");
    connection.subscribe(channel).get();
    assertThat(channels.take()).isEqualTo(channel);
    redis.auth(passwd);
    long id=findNamedClient("authWithReconnect");
    redis.clientKill(KillArgs.Builder.id(id));
    Delay.delay(Duration.ofMillis(100));
    Wait.untilTrue(connection::isOpen).waitOrTimeout();
    assertThat(channels.take()).isEqualTo(channel);
  }
);
}
