private VersionManager(final XMPPConnection connection){
  super(connection);
  ServiceDiscoveryManager sdm=ServiceDiscoveryManager.getInstanceFor(connection);
  sdm.addFeature(Version.NAMESPACE);
  connection.registerIQRequestHandler(new AbstractIqRequestHandler(Version.ELEMENT,Version.NAMESPACE,IQ.Type.get,Mode.async){
    @Override public IQ handleIQRequest(    IQ iqRequest){
      if (ourVersion == null) {
        return IQ.createErrorResponse(iqRequest,Condition.not_acceptable);
      }
      Version versionRequest=(Version)iqRequest;
      Version versionResponse=Version.builder(versionRequest).setName(ourVersion.name).setVersion(ourVersion.version).setOs(ourVersion.os).build();
      return versionResponse;
    }
  }
);
}
