protected void runTest(boolean useAuthzid) throws SmackException, InterruptedException, XmppStringprepException {
  EntityBareJid authzid=null;
  if (useAuthzid) {
    authzid=JidCreate.entityBareFrom("shazbat@xmpp.org");
  }
  saslMechanism.authenticate("florian","irrelevant",JidCreate.domainBareFrom("xmpp.org"),"secret",authzid,null);
  byte[] response=saslMechanism.evaluateChallenge(challengeBytes);
  String responseString=new String(response,StandardCharsets.UTF_8);
  String[] responseParts=responseString.split(",");
  Map<String,String> responsePairs=new HashMap<String,String>();
  for (  String part : responseParts) {
    String[] keyValue=part.split("=",2);
    String key=keyValue[0];
    String value=keyValue[1].replace("\"","");
    responsePairs.put(key,value);
  }
  if (useAuthzid) {
    assertMapValue("authzid","shazbat@xmpp.org",responsePairs);
  }
 else {
    assertTrue(!responsePairs.containsKey("authzid"));
  }
  assertMapValue("username","florian",responsePairs);
  assertMapValue("realm","xmpp.org",responsePairs);
  assertMapValue("digest-uri","xmpp/xmpp.org",responsePairs);
  assertMapValue("qop","auth",responsePairs);
}
