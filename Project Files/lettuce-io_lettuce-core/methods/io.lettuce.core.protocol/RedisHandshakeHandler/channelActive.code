@Override public void channelActive(ChannelHandlerContext ctx){
  CompletionStage<Void> future=connectionInitializer.initialize(ctx.channel());
  future.whenComplete((ignore,throwable) -> {
    if (throwable != null) {
      if (shouldFail()) {
        fail(ctx,throwable);
      }
    }
 else {
      ctx.fireChannelActive();
      succeed();
    }
  }
);
}
