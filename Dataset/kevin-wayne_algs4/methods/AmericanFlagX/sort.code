/** 
 * Rearranges the array of extended ASCII strings in ascending order. This is an unstable in-place sorting algorithm.
 * @param a the array to be sorted
 */
public static void sort(String[] a){
  sort(a,0,a.length - 1);
}
public static void sort(String[] a,int lo,int hi){
  Stack<Integer> st=new Stack<Integer>();
  int[] count=new int[R + 1];
  int d=0;
  st.push(lo);
  st.push(hi);
  st.push(d);
  while (!st.isEmpty()) {
    d=st.pop();
    hi=st.pop();
    lo=st.pop();
    if (hi <= lo + CUTOFF) {
      insertion(a,lo,hi,d);
      continue;
    }
    for (int i=lo; i <= hi; i++) {
      int c=charAt(a[i],d) + 1;
      count[c]++;
    }
    count[0]+=lo;
    for (int c=0; c < R; c++) {
      count[c + 1]+=count[c];
      if (c > 0 && count[c + 1] - 1 > count[c]) {
        st.push(count[c]);
        st.push(count[c + 1] - 1);
        st.push(d + 1);
      }
    }
    for (int r=hi; r >= lo; r--) {
      int c=charAt(a[r],d) + 1;
      while (r >= lo && count[c] - 1 <= r) {
        if (count[c] - 1 == r)         count[c]--;
        r--;
        if (r >= lo)         c=charAt(a[r],d) + 1;
      }
      if (r < lo)       break;
      while (--count[c] != r) {
        exch(a,r,count[c]);
        c=charAt(a[r],d) + 1;
      }
    }
    for (int c=0; c < R + 1; c++)     count[c]=0;
  }
}
