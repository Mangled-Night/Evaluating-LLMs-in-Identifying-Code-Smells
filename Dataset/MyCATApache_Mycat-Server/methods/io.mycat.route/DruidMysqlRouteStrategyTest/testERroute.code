public void testERroute() throws Exception {
  SchemaConfig schema=schemaMap.get("TESTDB");
  String sql="insert into orders (id,name,customer_id) values(1,'testonly',1)";
  RouteResultset rrs=routeStrategy.route(new SystemConfig(),schema,1,sql,null,null,cachePool);
  Assert.assertEquals(1,rrs.getNodes().length);
  Assert.assertEquals(false,rrs.isCacheAble());
  Assert.assertEquals("dn1",rrs.getNodes()[0].getName());
  sql="insert into orders (id,name,customer_id) values(1,'testonly',2000001)";
  rrs=routeStrategy.route(new SystemConfig(),schema,1,sql,null,null,cachePool);
  Assert.assertEquals(false,rrs.isCacheAble());
  Assert.assertEquals(1,rrs.getNodes().length);
  Assert.assertEquals("dn2",rrs.getNodes()[0].getName());
  sql="update orders set id=1 ,name='aaa' , customer_id=2000001";
  String err=null;
  try {
    rrs=routeStrategy.route(new SystemConfig(),schema,1,sql,null,null,cachePool);
  }
 catch (  SQLNonTransientException e) {
    err=e.getMessage();
  }
  Assert.assertEquals(true,err.startsWith("Parent relevant column can't be updated ORDERS->CUSTOMER_ID"));
  sql="update orders set id=1 ,name='aaa' where customer_id=2000001";
  rrs=routeStrategy.route(new SystemConfig(),schema,1,sql,null,null,cachePool);
  Assert.assertEquals(true,rrs.isCacheAble());
  Assert.assertEquals("dn2",rrs.getNodes()[0].getName());
  sql="update orders set id=1 ,name='aaa' where customer_id=-1";
  try {
    rrs=routeStrategy.route(new SystemConfig(),schema,1,sql,null,null,cachePool);
  }
 catch (  Exception e) {
    err=e.getMessage();
  }
  Assert.assertEquals(true,err.startsWith("can't find datanode for sharding column:"));
  sql="select * from orders  where customer_id=2000001";
  rrs=routeStrategy.route(new SystemConfig(),schema,1,sql,null,null,cachePool);
  Assert.assertEquals(true,rrs.isCacheAble());
  Assert.assertEquals("dn2",rrs.getNodes()[0].getName());
  sql="delete from orders  where customer_id=2000001";
  rrs=routeStrategy.route(new SystemConfig(),schema,1,sql,null,null,cachePool);
  Assert.assertEquals("dn2",rrs.getNodes()[0].getName());
  sql="select name as order_name from  orders order by order_name limit 10,5";
  rrs=routeStrategy.route(new SystemConfig(),schema,1,sql,null,null,cachePool);
  MySqlStatementParser parser=new MySqlStatementParser("SELECT name AS order_name FROM orders ORDER BY order_name LIMIT 0,15");
  SQLStatement statement=parser.parseStatement();
}
