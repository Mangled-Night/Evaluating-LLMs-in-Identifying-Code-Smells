private boolean check(EdgeWeightedGraph G){
  double totalWeight=0.0;
  for (  Edge e : edges()) {
    totalWeight+=e.weight();
  }
  if (Math.abs(totalWeight - weight()) > FLOATING_POINT_EPSILON) {
    System.err.printf("Weight of edges does not equal weight(): %f vs. %f\n",totalWeight,weight());
    return false;
  }
  UF uf=new UF(G.V());
  for (  Edge e : edges()) {
    int v=e.either(), w=e.other(v);
    if (uf.find(v) == uf.find(w)) {
      System.err.println("Not a forest");
      return false;
    }
    uf.union(v,w);
  }
  for (  Edge e : G.edges()) {
    int v=e.either(), w=e.other(v);
    if (uf.find(v) != uf.find(w)) {
      System.err.println("Not a spanning forest");
      return false;
    }
  }
  for (  Edge e : edges()) {
    uf=new UF(G.V());
    for (    Edge f : edges()) {
      int x=f.either(), y=f.other(x);
      if (f != e)       uf.union(x,y);
    }
    for (    Edge f : G.edges()) {
      int x=f.either(), y=f.other(x);
      if (uf.find(x) != uf.find(y)) {
        if (f.weight() < e.weight()) {
          System.err.println("Edge " + f + " violates cut optimality conditions");
          return false;
        }
      }
    }
  }
  return true;
}
