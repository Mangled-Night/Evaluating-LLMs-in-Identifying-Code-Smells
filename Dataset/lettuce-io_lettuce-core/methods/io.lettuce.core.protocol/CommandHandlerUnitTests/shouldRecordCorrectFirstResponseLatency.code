@Test void shouldRecordCorrectFirstResponseLatency() throws Exception {
  ChannelPromise channelPromise=new DefaultChannelPromise(channel,ImmediateEventExecutor.INSTANCE);
  channelPromise.setSuccess();
  sut.channelRegistered(context);
  sut.channelActive(context);
  sut.write(context,command,channelPromise);
  Delay.delay(Duration.ofMillis(10));
  sut.channelRead(context,Unpooled.wrappedBuffer("*1\r\n+OK\r\n".getBytes()));
  verify(latencyCollector).recordCommandLatency(any(),any(),eq(CommandType.APPEND),gt(0L),gt(0L));
  sut.channelUnregistered(context);
}
