@Override public void channelInactive(ChannelHandlerContext ctx) throws Exception {
  CommandHandler commandHandler=getCommandHandler(ctx);
  String epid=commandHandler.getEndpoint().getId();
  eventBus.publish(new DisconnectedEvent(getRedisUri(ctx.channel()),epid,commandHandler.getChannelId(),local(ctx),remote(ctx)));
  channels.remove(ctx.channel());
  super.channelInactive(ctx);
}
