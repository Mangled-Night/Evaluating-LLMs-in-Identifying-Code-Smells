/** 
 * MessageIBBOutputStream class implements IBBOutputStream to be used with message stanzas encapsulating the data packets.
 */
private class MessageIBBOutputStream extends IBBOutputStream {
  @Override protected synchronized void writeToXML(  DataPacketExtension data) throws NotConnectedException, InterruptedException {
    Message message=StanzaBuilder.buildMessage().to(remoteJID).addExtension(data).build();
    connection.sendStanza(message);
  }
}
