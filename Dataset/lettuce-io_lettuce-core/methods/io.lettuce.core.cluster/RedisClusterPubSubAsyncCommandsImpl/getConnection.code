@SuppressWarnings("unchecked") protected CompletableFuture<StatefulRedisPubSubConnection<K,V>> getConnection(RedisClusterNode redisClusterNode){
  RedisURI uri=redisClusterNode.getUri();
  AsyncClusterConnectionProvider async=(AsyncClusterConnectionProvider)writer.getClusterConnectionProvider();
  return async.getConnectionAsync(ConnectionIntent.WRITE,uri.getHost(),uri.getPort()).thenApply(it -> (StatefulRedisPubSubConnection<K,V>)it);
}
