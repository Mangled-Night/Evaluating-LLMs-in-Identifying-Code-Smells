/** 
 * Internal Search service Provider.
 */
public static class Provider extends IqProvider<IQ> {
  @Override public IQ parse(  XmlPullParser parser,  int initialDepth,  IqData iqData,  XmlEnvironment xmlEnvironment) throws XmlPullParserException, IOException, SmackParsingException {
    UserSearch search=null;
    SimpleUserSearch simpleUserSearch=new SimpleUserSearch();
    boolean done=false;
    while (!done) {
      XmlPullParser.Event eventType=parser.next();
      if (eventType == XmlPullParser.Event.START_ELEMENT && parser.getName().equals("item")) {
        simpleUserSearch.parseItems(parser);
        return simpleUserSearch;
      }
 else       if (eventType == XmlPullParser.Event.START_ELEMENT && parser.getNamespace().equals("jabber:x:data")) {
        search=new UserSearch();
        PacketParserUtils.addExtensionElement(search,parser,xmlEnvironment);
      }
 else       if (eventType == XmlPullParser.Event.END_ELEMENT) {
        if (parser.getName().equals("query")) {
          done=true;
        }
      }
    }
    if (search != null) {
      return search;
    }
    return simpleUserSearch;
  }
}
