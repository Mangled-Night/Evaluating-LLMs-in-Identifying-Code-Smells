@Override public ConnectionFuture<StatefulRedisConnection<K,V>> apply(ConnectionKey key){
  if (key.nodeId != null) {
    return redisClusterClient.connectPubSubToNodeAsync((RedisCodec)redisCodec,key.nodeId,getSocketAddressSupplier(key));
  }
  return redisClusterClient.connectPubSubToNodeAsync((RedisCodec)redisCodec,key.host + ":" + key.port,getSocketAddressSupplier(key));
}
