public int getActiveCountForSchema(String schema,PhysicalDatasource dataSouce){
  int total=0;
  for (  NIOProcessor processor : MycatServer.getInstance().getProcessors()) {
    for (    BackendConnection con : processor.getBackends().values()) {
      if (con instanceof MySQLConnection) {
        MySQLConnection mysqlCon=(MySQLConnection)con;
        if (mysqlCon.getSchema().equals(schema) && mysqlCon.getPool() == dataSouce && mysqlCon.isBorrowed()) {
          total++;
        }
      }
 else       if (con instanceof JDBCConnection) {
        JDBCConnection jdbcCon=(JDBCConnection)con;
        if (jdbcCon.getSchema().equals(schema) && jdbcCon.getPool() == dataSouce && jdbcCon.isBorrowed()) {
          total++;
        }
      }
    }
  }
  return total;
}
