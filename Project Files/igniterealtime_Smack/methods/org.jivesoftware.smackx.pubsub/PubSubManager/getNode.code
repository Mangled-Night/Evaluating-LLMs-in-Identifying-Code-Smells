/** 
 * Retrieves the requested node, if it exists.  It will throw an exception if it does not.
 * @param id - The unique id of the node
 * @return the node
 * @throws XMPPErrorException The node does not exist
 * @throws NoResponseException if there was no response from the server.
 * @throws NotConnectedException if the XMPP connection is not connected.
 * @throws InterruptedException if the calling thread was interrupted.
 * @throws NotAPubSubNodeException if a involved node is not a PubSub node.
 */
public Node getNode(String id) throws NoResponseException, XMPPErrorException, NotConnectedException, InterruptedException, NotAPubSubNodeException {
  StringUtils.requireNotNullNorEmpty(id,"The node ID can not be null or the empty string");
  Node node=nodeMap.get(id);
  if (node == null) {
    XMPPConnection connection=connection();
    DiscoverInfo info=DiscoverInfo.builder(connection).to(pubSubService).setNode(id).build();
    DiscoverInfo infoReply=connection.sendIqRequestAndWaitForResponse(info);
    if (infoReply.hasIdentity(PubSub.ELEMENT,"leaf")) {
      node=new LeafNode(this,id);
    }
 else     if (infoReply.hasIdentity(PubSub.ELEMENT,"collection")) {
      node=new CollectionNode(this,id);
    }
 else {
      throw new PubSubException.NotAPubSubNodeException(id,infoReply);
    }
    nodeMap.put(id,node);
  }
  return node;
}
