static class PreKeyMessageListener extends MessageListener {
  PreKeyMessageListener(  String expectedMessage,  SimpleResultSyncPoint syncPoint){
    super(expectedMessage,syncPoint);
  }
  PreKeyMessageListener(  String expectedMessage){
    this(expectedMessage,new SimpleResultSyncPoint());
  }
  @Override public void onOmemoMessageReceived(  Stanza stanza,  OmemoMessage.Received received){
    SimpleResultSyncPoint srp=(SimpleResultSyncPoint)syncPoint;
    if (received.isKeyTransportMessage()) {
      return;
    }
    if (received.isPreKeyMessage()) {
      if (received.getBody().equals(expectedMessage)) {
        srp.signal();
      }
 else {
        srp.signalFailure("Received decrypted message was not equal to sent message.");
      }
    }
 else {
      srp.signalFailure("Received message was not a PreKeyMessage.");
    }
  }
}
