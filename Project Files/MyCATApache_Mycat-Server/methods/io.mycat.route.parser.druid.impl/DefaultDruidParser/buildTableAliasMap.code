private Map<String,String> buildTableAliasMap(SchemaConfig schema,MycatSchemaStatVisitor visitor){
  if (visitor.getAliasMap() == null) {
    return null;
  }
  Map<String,String> tableAliasMap=new HashMap<>();
  for (  Map.Entry<String,String> entry : visitor.getAliasMap().entrySet()) {
    String key=entry.getKey();
    String value=entry.getValue();
    if (key != null) {
      int pos=key.indexOf(".");
      if (pos > 0) {
        key=key.substring(pos + 1);
      }
    }
    if (value != null) {
      int pos=value.indexOf(".");
      if (pos > 0) {
        value=value.substring(pos + 1);
      }
    }
    if (key != null && key.charAt(0) == '`') {
      key=key.substring(1,key.length() - 1);
    }
    if (value != null && value.charAt(0) == '`') {
      value=value.substring(1,value.length() - 1);
    }
    if (key != null) {
      int pos=key.indexOf(".");
      if (pos > 0) {
        String schemaInSQL=key.substring(0,pos);
        if (schemaInSQL.equalsIgnoreCase(schema.getName())) {
          key=key.substring(pos + 1);
        }
      }
      String upperkey=key.toUpperCase();
      if (!tableAliasMap.containsKey(upperkey)) {
        tableAliasMap.put(upperkey,value);
      }
    }
  }
  ctx.addTables(visitor.getTables(),schema.getName());
  ctx.setTableAliasMap(visitor.getAliasMap());
  return tableAliasMap;
}
