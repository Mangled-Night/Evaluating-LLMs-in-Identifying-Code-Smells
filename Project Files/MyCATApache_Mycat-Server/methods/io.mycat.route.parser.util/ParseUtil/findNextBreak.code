public static int findNextBreak(String sql){
  return findNextBreak(sql,false);
}
/** 
 * @param sql
 * @param inProcedure
 * @return
 */
private static int findNextBreak(String sql,boolean inProcedure){
  boolean inApostrophe=false;
  boolean procedureBegin=false;
  String bodyLeft=null;
  for (int i=0; i < sql.length(); i++) {
    char c=sql.charAt(i);
switch (c) {
case '\\':
      i++;
    break;
case '\'':
case '\"':
  if (!inApostrophe) {
    inApostrophe=true;
    bodyLeft=String.valueOf(c);
  }
 else {
    String rightTest=String.valueOf(c);
    if (rightTest.equals(bodyLeft)) {
      inApostrophe=false;
    }
  }
break;
case ';':
if (!inApostrophe && !procedureBegin) {
return i;
}
break;
case 'p':
case 'P':
if (!inApostrophe) {
i=getProcedureEndPos(sql,i);
}
break;
case 'B':
if (inProcedure && !inApostrophe && isBegin(sql,i)) {
procedureBegin=true;
i=i + 4;
}
break;
case 'E':
if (!inApostrophe && procedureBegin && isEnd(sql,i)) {
procedureBegin=false;
i=i + 2;
}
break;
default :
}
}
return sql.length() - 1;
}
