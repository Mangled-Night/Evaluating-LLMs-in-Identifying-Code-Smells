private static Map<String,MycatNodeConfig> loadNode(Element root,int port){
  Map<String,MycatNodeConfig> nodes=new HashMap<String,MycatNodeConfig>();
  NodeList list=root.getElementsByTagName("node");
  Set<String> hostSet=new HashSet<String>();
  for (int i=0, n=list.getLength(); i < n; i++) {
    Node node=list.item(i);
    if (node instanceof Element) {
      Element element=(Element)node;
      String name=element.getAttribute("name").trim();
      if (nodes.containsKey(name)) {
        throw new ConfigException("node name duplicated :" + name);
      }
      Map<String,Object> props=ConfigUtil.loadElements(element);
      String host=(String)props.get("host");
      if (null == host || "".equals(host)) {
        throw new ConfigException("host empty in node: " + name);
      }
      if (hostSet.contains(host)) {
        throw new ConfigException("node host duplicated :" + host);
      }
      String wei=(String)props.get("weight");
      if (null == wei || "".equals(wei)) {
        throw new ConfigException("weight should not be null in host:" + host);
      }
      int weight=Integer.parseInt(wei);
      if (weight <= 0) {
        throw new ConfigException("weight should be > 0 in host:" + host + " weight:"+ weight);
      }
      MycatNodeConfig conf=new MycatNodeConfig(name,host,port,weight);
      nodes.put(name,conf);
      hostSet.add(host);
    }
  }
  return nodes;
}
