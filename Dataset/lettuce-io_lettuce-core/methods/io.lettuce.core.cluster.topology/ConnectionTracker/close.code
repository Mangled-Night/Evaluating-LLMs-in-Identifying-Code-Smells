@SuppressWarnings("rawtypes") public CompletableFuture<Void> close(){
  CompletableFuture[] futures=connections.values().stream().map(it -> it.thenCompose(StatefulConnection::closeAsync).exceptionally(ignore -> null)).toArray(CompletableFuture[]::new);
  return CompletableFuture.allOf(futures);
}
