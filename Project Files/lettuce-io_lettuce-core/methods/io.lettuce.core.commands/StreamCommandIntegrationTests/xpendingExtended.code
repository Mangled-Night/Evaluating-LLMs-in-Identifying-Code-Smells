@Test void xpendingExtended(){
  redis.xgroupCreate(StreamOffset.latest(key),"group",XGroupCreateArgs.Builder.mkstream());
  String id=redis.xadd(key,Collections.singletonMap("key","value"));
  redis.xreadgroup(Consumer.from("group","consumer1"),StreamOffset.lastConsumed(key));
  List<PendingMessage> pendingMessages=redis.xpending(key,"group",Range.unbounded(),Limit.unlimited());
  assertThat(pendingMessages).hasSize(1);
  PendingMessage message=pendingMessages.get(0);
  assertThat(message.getId()).isEqualTo(id);
  assertThat(message.getConsumer()).isEqualTo("consumer1");
  assertThat(message.getRedeliveryCount()).isEqualTo(1);
}
