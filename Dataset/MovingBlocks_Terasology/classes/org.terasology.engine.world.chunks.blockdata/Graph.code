/** 
 * Undirected graphs with string-labelled vertices. Used to represent the overlaps between requested extra-data fields.
 */
private static class Graph {
  private String[] verts;
  private Map<String,Set<String>> edges;
  private Graph(  String[] verts,  Map<String,Set<String>> edges){
    this.verts=verts;
    this.edges=edges;
  }
  Graph(  String[] verts){
    this.verts=verts.clone();
    this.edges=new HashMap<>();
    for (    String vert : verts) {
      edges.put(vert,new HashSet());
    }
  }
  public int size(){
    return verts.length;
  }
  public String getVert(  int i){
    return verts[i];
  }
  public Set<String> getEdges(  String v){
    return Collections.unmodifiableSet(edges.get(v));
  }
  public Graph addEdge(  String s0,  String s1){
    edges.get(s0).add(s1);
    edges.get(s1).add(s0);
    return this;
  }
  public Graph removeEdge(  String s0,  String s1){
    edges.get(s0).remove(s1);
    edges.get(s1).remove(s0);
    return this;
  }
  public Graph ntract(  String s0,  String s1){
    int v0=-1;
    int v1=-1;
    for (int i=0; i < verts.length; i++) {
      if (verts[i].equals(s0)) {
        v0=i;
      }
      if (verts[i].equals(s1)) {
        v1=i;
      }
    }
    String[] newVerts=new String[verts.length - 1];
    System.arraycopy(verts,0,newVerts,0,v1);
    System.arraycopy(verts,v1 + 1,newVerts,v1,verts.length - v1 - 1);
    Map<String,Set<String>> newEdges=new HashMap<>();
    for (    String s : verts) {
      newEdges.put(s,new HashSet<>(edges.get(s)));
    }
    newEdges.remove(s1);
    Set<String> e0=newEdges.get(s0);
    Set<String> e1=edges.get(s1);
    for (    String s2 : verts) {
      if (e0.contains(s2) && !e1.contains(s2)) {
        e0.remove(s2);
        newEdges.get(s2).remove(s0);
      }
      if (e1.contains(s2)) {
        newEdges.get(s2).remove(s1);
      }
    }
    return new Graph(newVerts,newEdges);
  }
  public String toString(){
    String result="Graph:";
    for (int i=0; i < verts.length; i++) {
      result+=" (" + verts[i] + " ->";
      for (      String v : edges.get(verts[i])) {
        result+=" " + v;
      }
      result+=")";
    }
    return result;
  }
}
