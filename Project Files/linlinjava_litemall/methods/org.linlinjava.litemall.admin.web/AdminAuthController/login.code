@PostMapping("/login") public Object login(@RequestBody String body,HttpServletRequest request){
  String username=JacksonUtil.parseString(body,"username");
  String password=JacksonUtil.parseString(body,"password");
  if (StringUtils.isEmpty(username) || StringUtils.isEmpty(password)) {
    return ResponseUtil.badArgument();
  }
  Subject currentUser=SecurityUtils.getSubject();
  try {
    currentUser.login(new UsernamePasswordToken(username,password));
  }
 catch (  UnknownAccountException uae) {
    logHelper.logAuthFail("登录","用户帐号或密码不正确");
    return ResponseUtil.fail(ADMIN_INVALID_ACCOUNT,"用户帐号或密码不正确",doKaptcha(request));
  }
catch (  LockedAccountException lae) {
    logHelper.logAuthFail("登录","用户帐号已锁定不可用");
    return ResponseUtil.fail(ADMIN_INVALID_ACCOUNT,"用户帐号已锁定不可用");
  }
catch (  AuthenticationException ae) {
    logHelper.logAuthFail("登录","认证失败");
    return ResponseUtil.fail(ADMIN_INVALID_ACCOUNT,"认证失败");
  }
  currentUser=SecurityUtils.getSubject();
  LitemallAdmin admin=(LitemallAdmin)currentUser.getPrincipal();
  admin.setLastLoginIp(IpUtil.getIpAddr(request));
  admin.setLastLoginTime(LocalDateTime.now());
  adminService.updateById(admin);
  logHelper.logAuthSucceed("登录");
  Map<String,Object> adminInfo=new HashMap<String,Object>();
  adminInfo.put("nickName",admin.getUsername());
  adminInfo.put("avatar",admin.getAvatar());
  Map<Object,Object> result=new HashMap<Object,Object>();
  result.put("token",currentUser.getSession().getId());
  result.put("adminInfo",adminInfo);
  return ResponseUtil.ok(result);
}
