private static class PrefabHandler implements JsonSerializer<EntityData.Prefab>, JsonDeserializer<EntityData.Prefab> {
  @Override public JsonElement serialize(  EntityData.Prefab src,  Type typeOfSrc,  JsonSerializationContext context){
    JsonObject result=new JsonObject();
    if (src.hasName()) {
      result.addProperty("name",src.getName());
    }
    if (src.hasParentName()) {
      result.addProperty("parent",src.getParentName());
    }
    if (src.hasPersisted()) {
      result.addProperty("persisted",src.getPersisted());
    }
    if (src.hasAlwaysRelevant()) {
      result.addProperty("alwaysRelevant",src.getAlwaysRelevant());
    }
    if (src.getRemovedComponentCount() > 0) {
      result.add("removedComponents",context.serialize(src.getRemovedComponentList()));
    }
    for (    EntityData.Component component : src.getComponentList()) {
      result.add(component.getType(),context.serialize(component));
    }
    return result;
  }
  @Override public EntityData.Prefab deserialize(  JsonElement json,  Type typeOfT,  JsonDeserializationContext context) throws JsonParseException {
    EntityData.Prefab.Builder prefab=EntityData.Prefab.newBuilder();
    JsonObject jsonObject=json.getAsJsonObject();
    for (    Map.Entry<String,JsonElement> entry : jsonObject.entrySet()) {
      String name=entry.getKey().toLowerCase(Locale.ENGLISH);
switch (name) {
case "name":
        if (entry.getValue().isJsonPrimitive()) {
          prefab.setName(entry.getValue().getAsString());
        }
      break;
case "parent":
    if (entry.getValue().isJsonPrimitive()) {
      prefab.setParentName(entry.getValue().getAsString());
    }
  break;
case "removedcomponents":
if (entry.getValue().isJsonPrimitive()) {
  prefab.addRemovedComponent(entry.getValue().getAsString());
}
 else if (entry.getValue().isJsonArray()) {
  for (  JsonElement element : entry.getValue().getAsJsonArray()) {
    prefab.addRemovedComponent(element.getAsString());
  }
}
break;
case "persisted":
prefab.setPersisted(entry.getValue().getAsBoolean());
break;
case "alwaysrelevant":
prefab.setAlwaysRelevant(entry.getValue().getAsBoolean());
break;
default :
if (entry.getValue().isJsonObject()) {
EntityData.Component.Builder component=context.deserialize(entry.getValue(),EntityData.Component.Builder.class);
component.setType(entry.getKey());
prefab.addComponent(component);
}
}
}
return prefab.build();
}
}
