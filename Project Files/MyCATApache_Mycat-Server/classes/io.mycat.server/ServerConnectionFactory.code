/** 
 * @author mycat
 */
public class ServerConnectionFactory extends FrontendConnectionFactory {
  @Override protected FrontendConnection getConnection(  NetworkChannel channel) throws IOException {
    SystemConfig sys=MycatServer.getInstance().getConfig().getSystem();
    ServerConnection c=new ServerConnection(channel);
    MycatServer.getInstance().getConfig().setSocketParams(c,true);
    c.setAuthTimeout(sys.getAuthTimeout());
    c.setPrivileges(MycatPrivileges.instance());
    c.setQueryHandler(new ServerQueryHandler(c));
    c.setLoadDataInfileHandler(new ServerLoadDataInfileHandler(c));
    c.setPrepareHandler(new ServerPrepareHandler(c,sys.getMaxPreparedStmtCount()));
    c.setTxIsolation(sys.getTxIsolation());
    c.setSession2(new NonBlockingSession(c));
    return c;
  }
}
