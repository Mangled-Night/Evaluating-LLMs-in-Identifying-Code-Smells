private void cancelCommands(String message,Iterable<? extends RedisCommand<?,?,?>> toCancel,Consumer<RedisCommand<?,?,?>> commandConsumer){
  for (  RedisCommand<?,?,?> cmd : toCancel) {
    if (cmd.getOutput() != null) {
      cmd.getOutput().setError(message);
    }
    commandConsumer.accept(cmd);
  }
}
