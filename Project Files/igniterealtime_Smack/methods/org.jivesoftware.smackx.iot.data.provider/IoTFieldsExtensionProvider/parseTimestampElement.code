public TimestampElement parseTimestampElement(XmlPullParser parser) throws XmlPullParserException, IOException, ParseException {
  final int initialDepth=parser.getDepth();
  final String dateString=parser.getAttributeValue(null,"value");
  Date date=XmppDateTime.parseDate(dateString);
  List<IoTDataField> fields=new ArrayList<>();
  outerloop:   while (true) {
    final XmlPullParser.Event eventType=parser.next();
switch (eventType) {
case START_ELEMENT:
      final String name=parser.getName();
    IoTDataField field=null;
  final String fieldName=parser.getAttributeValue(null,"name");
final String fieldValue=parser.getAttributeValue(null,"value");
switch (name) {
case "int":
{
  int value=Integer.parseInt(fieldValue);
  field=new IoTDataField.IntField(fieldName,value);
}
break;
case "boolean":
{
boolean value=Boolean.parseBoolean(fieldValue);
field=new IoTDataField.BooleanField(fieldName,value);
}
break;
default :
LOGGER.warning("IoT Data field type '" + name + "' not implement yet. Ignoring.");
break;
}
if (field != null) {
fields.add(field);
}
break;
case END_ELEMENT:
if (parser.getDepth() == initialDepth) {
break outerloop;
}
break;
default :
break;
}
}
return new TimestampElement(date,fields);
}
