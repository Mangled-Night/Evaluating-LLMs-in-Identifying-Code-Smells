public RingBuffer(EventFactory<E> eventFactory,Sequencer sequencer){
  this.sequencer=sequencer;
  this.bufferSize=sequencer.getBufferSize();
  if (bufferSize < 1) {
    throw new IllegalArgumentException("bufferSize must not be less than 1");
  }
  if (Integer.bitCount(bufferSize) != 1) {
    throw new IllegalArgumentException("bufferSize must be a power of 2");
  }
  this.indexMask=bufferSize - 1;
  this.entries=new Object[sequencer.getBufferSize() + 2 * BUFFER_PAD];
  fill(eventFactory);
}
