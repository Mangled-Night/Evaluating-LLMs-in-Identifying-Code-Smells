/** 
 * From matches filter test.
 * @author Robin Collier
 */
public class FromMatchesFilterTest {
  private static final Jid BASE_JID1=JidTestUtil.BARE_JID_1;
  private static final EntityFullJid FULL_JID1_R1=JidTestUtil.FULL_JID_1_RESOURCE_1;
  private static final EntityFullJid FULL_JID1_R2=JidTestUtil.FULL_JID_1_RESOURCE_2;
  private static final Jid BASE_JID2=JidTestUtil.BARE_JID_2;
  private static final Jid FULL_JID2=JidTestUtil.FULL_JID_2_RESOURCE_1;
  private static final Jid BASE_JID3=JidTestUtil.DUMMY_AT_EXAMPLE_ORG;
  private static final Jid SERVICE_JID1=JidTestUtil.MUC_EXAMPLE_ORG;
  private static final Jid SERVICE_JID2=JidTestUtil.PUBSUB_EXAMPLE_ORG;
  @Test public void autoCompareMatchingEntityFullJid(){
    FromMatchesFilter filter=FromMatchesFilter.create(FULL_JID1_R1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(FULL_JID1_R1);
    assertTrue(filter.accept(packet));
    packet.setFrom(BASE_JID1);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID1_R2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
  @Test public void autoCompareMatchingBaseJid(){
    FromMatchesFilter filter=FromMatchesFilter.create(BASE_JID1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(BASE_JID1);
    assertTrue(filter.accept(packet));
    packet.setFrom(FULL_JID1_R1);
    assertTrue(filter.accept(packet));
    packet.setFrom(FULL_JID1_R2);
    assertTrue(filter.accept(packet));
    packet.setFrom(BASE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
  @Test public void autoCompareMatchingServiceJid(){
    FromMatchesFilter filter=FromMatchesFilter.create(SERVICE_JID1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(SERVICE_JID1);
    assertTrue(filter.accept(packet));
    packet.setFrom(SERVICE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID1);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID1_R1);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
  @Test public void bareCompareMatchingEntityFullJid(){
    FromMatchesFilter filter=FromMatchesFilter.createBare(FULL_JID1_R1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(BASE_JID1);
    assertTrue(filter.accept(packet));
    packet.setFrom(FULL_JID1_R1);
    assertTrue(filter.accept(packet));
    packet.setFrom(FULL_JID1_R2);
    assertTrue(filter.accept(packet));
    packet.setFrom(BASE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
  @Test public void bareCompareMatchingBaseJid(){
    FromMatchesFilter filter=FromMatchesFilter.createBare(BASE_JID1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(BASE_JID1);
    assertTrue(filter.accept(packet));
    packet.setFrom(FULL_JID1_R1);
    assertTrue(filter.accept(packet));
    packet.setFrom(FULL_JID1_R2);
    assertTrue(filter.accept(packet));
    packet.setFrom(BASE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
  @Test public void bareCompareMatchingServiceJid(){
    FromMatchesFilter filter=FromMatchesFilter.createBare(SERVICE_JID1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(SERVICE_JID1);
    assertTrue(filter.accept(packet));
    packet.setFrom(SERVICE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID1);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID1_R1);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
  @Test public void fullCompareMatchingEntityFullJid(){
    FromMatchesFilter filter=FromMatchesFilter.createFull(FULL_JID1_R1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(FULL_JID1_R1);
    assertTrue(filter.accept(packet));
    packet.setFrom(BASE_JID1);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID1_R2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
  @Test public void fullCompareMatchingBaseJid(){
    FromMatchesFilter filter=FromMatchesFilter.createFull(BASE_JID1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(BASE_JID1);
    assertTrue(filter.accept(packet));
    packet.setFrom(FULL_JID1_R1);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID1_R2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
  @Test public void fullCompareMatchingServiceJid(){
    FromMatchesFilter filter=FromMatchesFilter.createFull(SERVICE_JID1);
    Stanza packet=StanzaBuilder.buildMessage().build();
    packet.setFrom(SERVICE_JID1);
    assertTrue(filter.accept(packet));
    packet.setFrom(SERVICE_JID2);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID1);
    assertFalse(filter.accept(packet));
    packet.setFrom(FULL_JID1_R1);
    assertFalse(filter.accept(packet));
    packet.setFrom(BASE_JID3);
    assertFalse(filter.accept(packet));
  }
}
