/** 
 * Get a MamManager for the MAM archive of the local entity (the "user") of the given connection.
 * @param connection the XMPP connection to get the archive for.
 * @return the instance of MamManager.
 */
public static MamManager getInstanceFor(XMPPConnection connection){
  return getInstanceFor(connection,(Jid)null);
}
/** 
 * Get a MamManager for the MAM archive of the given  {@code MultiUserChat}. Note that not all MUCs support MAM, hence it is recommended to use  {@link #isSupported()} to check if MAM is supported by the MUC.
 * @param multiUserChat the MultiUserChat to retrieve the MamManager for.
 * @return the MamManager for the given MultiUserChat.
 * @since 4.3.0
 */
public static MamManager getInstanceFor(MultiUserChat multiUserChat){
  XMPPConnection connection=multiUserChat.getXmppConnection();
  Jid archiveAddress=multiUserChat.getRoom();
  return getInstanceFor(connection,archiveAddress);
}
public static synchronized MamManager getInstanceFor(XMPPConnection connection,Jid archiveAddress){
  Map<Jid,MamManager> managers=INSTANCES.get(connection);
  if (managers == null) {
    managers=new HashMap<>();
    INSTANCES.put(connection,managers);
  }
  MamManager mamManager=managers.get(archiveAddress);
  if (mamManager == null) {
    mamManager=new MamManager(connection,archiveAddress);
    managers.put(archiveAddress,mamManager);
  }
  return mamManager;
}
