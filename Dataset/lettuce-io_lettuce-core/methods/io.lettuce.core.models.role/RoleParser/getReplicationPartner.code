private static ReplicationPartner getReplicationPartner(Collection<?> segments){
  Iterator<?> iterator=segments.iterator();
  String ip=getStringFromIterator(iterator,"");
  long port=getLongFromIterator(iterator,0);
  long replicationOffset=getLongFromIterator(iterator,0);
  return new ReplicationPartner(HostAndPort.of(ip,Math.toIntExact(port)),replicationOffset);
}
