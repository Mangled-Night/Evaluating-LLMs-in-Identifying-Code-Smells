@Override public CharSequence toXML(org.jivesoftware.smack.packet.XmlEnvironment enclosingNamespace){
  XmlStringBuilder xml=new XmlStringBuilder(this,enclosingNamespace);
  if (condition == null && textElements.isEmpty()) {
    xml.closeEmptyElement();
  }
 else {
    if (condition != null) {
      xml.rightAngleBracket();
      xml.append(condition.toString());
      xml.xmlnsAttribute(StanzaError.ERROR_CONDITION_AND_TEXT_NAMESPACE);
      xml.closeEmptyElement();
    }
    xml.append(textElements);
    xml.closeElement(ELEMENT);
  }
  return xml;
}
