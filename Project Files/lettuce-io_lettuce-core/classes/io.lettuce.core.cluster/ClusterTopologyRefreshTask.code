private static class ClusterTopologyRefreshTask extends AtomicBoolean implements Runnable {
  private static final long serialVersionUID=-1337731371220365694L;
  private final Supplier<CompletionStage<?>> reloadTopologyAsync;
  ClusterTopologyRefreshTask(  Supplier<CompletionStage<?>> reloadTopologyAsync){
    this.reloadTopologyAsync=reloadTopologyAsync;
  }
  public void run(){
    if (compareAndSet(false,true)) {
      doRun();
      return;
    }
    if (logger.isDebugEnabled()) {
      logger.debug("ClusterTopologyRefreshTask already in progress");
    }
  }
  void doRun(){
    if (logger.isDebugEnabled()) {
      logger.debug("ClusterTopologyRefreshTask requesting partitions");
    }
    try {
      reloadTopologyAsync.get().whenComplete((ignore,throwable) -> {
        if (throwable != null) {
          logger.warn("Cannot refresh Redis Cluster topology",throwable);
        }
        set(false);
      }
);
    }
 catch (    Exception e) {
      logger.warn("Cannot refresh Redis Cluster topology",e);
    }
  }
}
