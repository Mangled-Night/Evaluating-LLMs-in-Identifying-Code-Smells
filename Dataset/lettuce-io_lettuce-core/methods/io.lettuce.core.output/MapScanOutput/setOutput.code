@Override protected void setOutput(ByteBuffer bytes){
  if (key == null) {
    key=codec.decodeKey(bytes);
    return;
  }
  V value=(bytes == null) ? null : codec.decodeValue(bytes);
  output.getMap().put(key,value);
  key=null;
}
