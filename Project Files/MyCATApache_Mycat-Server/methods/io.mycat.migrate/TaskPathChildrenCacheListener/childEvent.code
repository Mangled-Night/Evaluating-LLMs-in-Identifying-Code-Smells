@Override public void childEvent(CuratorFramework curatorFramework,PathChildrenCacheEvent event) throws Exception {
switch (event.getType()) {
case CHILD_ADDED:
    if (isTaskErrorOrSucess(event))     break;
  addOrUpdate(event);
String path=event.getData().getPath() + "/_prepare";
if (curatorFramework.checkExists().forPath(path) == null) {
curatorFramework.create().creatingParentsIfNeeded().forPath(path);
}
ZKUtils.addChildPathCache(path,new SwitchPrepareListener());
String commitPath=event.getData().getPath() + "/_commit";
if (curatorFramework.checkExists().forPath(commitPath) == null) {
curatorFramework.create().creatingParentsIfNeeded().forPath(commitPath);
}
ZKUtils.addChildPathCache(commitPath,new SwitchCommitListener());
String cleanPath=event.getData().getPath() + "/_clean";
if (curatorFramework.checkExists().forPath(cleanPath) == null) {
curatorFramework.create().creatingParentsIfNeeded().forPath(cleanPath);
}
ZKUtils.addChildPathCache(cleanPath,new SwitchCleanListener());
LOGGER.info("table CHILD_ADDED: " + event.getData().getPath());
break;
case CHILD_UPDATED:
if (isTaskErrorOrSucess(event)) break;
addOrUpdate(event);
LOGGER.info("CHILD_UPDATED: " + event.getData().getPath());
break;
default :
break;
}
}
