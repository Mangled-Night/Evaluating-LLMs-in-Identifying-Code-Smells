private static RouteResultset getRouteResultset(ServerConnection c,String stmt){
  String db=c.getSchema();
  int sqlType=ServerParse.parse(stmt) & 0xff;
  if (db == null) {
    db=SchemaUtil.detectDefaultDb(stmt,sqlType);
    if (db == null) {
      c.writeErrMessage(ErrorCode.ER_NO_DB_ERROR,"No database selected");
      return null;
    }
  }
  SchemaConfig schema=MycatServer.getInstance().getConfig().getSchemas().get(db);
  if (schema == null) {
    c.writeErrMessage(ErrorCode.ER_BAD_DB_ERROR,"Unknown database '" + db + "'");
    return null;
  }
  try {
    if (ServerParse.INSERT == sqlType && isMycatSeq(stmt,schema)) {
      c.writeErrMessage(ErrorCode.ER_PARSE_ERROR,"insert sql using mycat seq,you must provide primaryKey value for explain");
      return null;
    }
    SystemConfig system=MycatServer.getInstance().getConfig().getSystem();
    return MycatServer.getInstance().getRouterservice().route(system,schema,sqlType,stmt,c.getCharset(),c);
  }
 catch (  Exception e) {
    StringBuilder s=new StringBuilder();
    logger.warn(s.append(c).append(stmt).toString() + " error:" + e);
    String msg=e.getMessage();
    c.writeErrMessage(ErrorCode.ER_PARSE_ERROR,msg == null ? e.getClass().getSimpleName() : msg);
    return null;
  }
}
