/** 
 * Unit tests for  {@link SocketOptions}.
 * @author Mark Paluch
 */
class SocketOptionsUnitTests {
  @Test void testNew(){
    checkAssertions(SocketOptions.create());
  }
  @Test void testBuilder(){
    SocketOptions sut=SocketOptions.builder().connectTimeout(1,TimeUnit.MINUTES).keepAlive(true).tcpNoDelay(false).build();
    assertThat(sut.isKeepAlive()).isTrue();
    assertThat(sut.isTcpNoDelay()).isFalse();
    assertThat(sut.getConnectTimeout()).isEqualTo(Duration.ofMinutes(1));
  }
  @Test void mutateShouldConfigureNewOptions(){
    SocketOptions sut=SocketOptions.builder().connectTimeout(Duration.ofSeconds(1)).keepAlive(true).tcpNoDelay(true).build();
    SocketOptions reconfigured=sut.mutate().tcpNoDelay(false).build();
    assertThat(sut.isKeepAlive()).isTrue();
    assertThat(sut.isTcpNoDelay()).isTrue();
    assertThat(sut.getConnectTimeout()).isEqualTo(Duration.ofSeconds(1));
    assertThat(reconfigured.isTcpNoDelay()).isFalse();
  }
  @Test void shouldConfigureSimpleKeepAlive(){
    SocketOptions sut=SocketOptions.builder().keepAlive(true).build();
    assertThat(sut.isKeepAlive()).isTrue();
    assertThat(sut.isExtendedKeepAlive()).isFalse();
  }
  @Test void shouldConfigureSimpleExtendedAlive(){
    SocketOptions sut=SocketOptions.builder().keepAlive(SocketOptions.KeepAliveOptions.builder().build()).build();
    assertThat(sut.isKeepAlive()).isFalse();
    assertThat(sut.isExtendedKeepAlive()).isTrue();
  }
  @Test void testCopy(){
    checkAssertions(SocketOptions.copyOf(SocketOptions.builder().build()));
  }
  void checkAssertions(  SocketOptions sut){
    assertThat(sut.isKeepAlive()).isFalse();
    assertThat(sut.isTcpNoDelay()).isTrue();
    assertThat(sut.getConnectTimeout()).isEqualTo(Duration.ofSeconds(10));
  }
}
