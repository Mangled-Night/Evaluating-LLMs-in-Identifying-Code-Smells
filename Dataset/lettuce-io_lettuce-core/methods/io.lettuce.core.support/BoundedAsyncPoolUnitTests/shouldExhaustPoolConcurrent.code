@Test void shouldExhaustPoolConcurrent(){
  List<CompletableFuture<String>> progress=new ArrayList<>();
  AsyncObjectFactory<String> IN_PROGRESS=new AsyncObjectFactory<String>(){
    @Override public CompletableFuture<String> create(){
      CompletableFuture<String> future=new CompletableFuture<>();
      progress.add(future);
      return future;
    }
    @Override public CompletableFuture<Void> destroy(    String object){
      destroyed.add(object);
      return CompletableFuture.completedFuture(null);
    }
    @Override public CompletableFuture<Boolean> validate(    String object){
      return CompletableFuture.completedFuture(true);
    }
  }
;
  BoundedAsyncPool<String> pool=new BoundedAsyncPool<>(IN_PROGRESS,BoundedPoolConfig.builder().maxTotal(4).build());
  CompletableFuture<String> object1=pool.acquire();
  CompletableFuture<String> object2=pool.acquire();
  CompletableFuture<String> object3=pool.acquire();
  CompletableFuture<String> object4=pool.acquire();
  CompletableFuture<String> object5=pool.acquire();
  assertThat(pool.getIdle()).isZero();
  assertThat(pool.getObjectCount()).isZero();
  assertThat(pool.getCreationInProgress()).isEqualTo(4);
  assertThat(object5).isCompletedExceptionally();
  progress.forEach(it -> it.complete("foo"));
  assertThat(pool.getIdle()).isZero();
  assertThat(pool.getObjectCount()).isEqualTo(4);
  assertThat(pool.getCreationInProgress()).isZero();
}
