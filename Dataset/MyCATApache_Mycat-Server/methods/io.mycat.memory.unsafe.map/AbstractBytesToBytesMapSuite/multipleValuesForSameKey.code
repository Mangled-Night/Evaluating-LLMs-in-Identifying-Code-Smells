@Test public void multipleValuesForSameKey(){
  BytesToBytesMap map=new BytesToBytesMap(dataNodeMemoryManager,blockManager,serializerManager,1,0.75,1024,false);
  try {
    int i;
    for (i=0; i < 1024; i++) {
      final long[] arr=new long[]{i};
      map.lookup(arr,Platform.LONG_ARRAY_OFFSET,8).append(arr,Platform.LONG_ARRAY_OFFSET,8,arr,Platform.LONG_ARRAY_OFFSET,8);
    }
    assert map.numKeys() == 1024;
    assert map.numValues() == 1024;
    for (i=0; i < 1024; i++) {
      final long[] arr=new long[]{i};
      map.lookup(arr,Platform.LONG_ARRAY_OFFSET,8).append(arr,Platform.LONG_ARRAY_OFFSET,8,arr,Platform.LONG_ARRAY_OFFSET,8);
    }
    assert map.numKeys() == 1024;
    assert map.numValues() == 2048;
    for (i=0; i < 1024; i++) {
      final long[] arr=new long[]{i};
      final BytesToBytesMap.Location loc=map.lookup(arr,Platform.LONG_ARRAY_OFFSET,8);
      assert loc.isDefined();
      assert loc.nextValue();
      assert !loc.nextValue();
    }
    BytesToBytesMap.MapIterator iter=map.iterator();
    for (i=0; i < 2048; i++) {
      assert iter.hasNext();
      final BytesToBytesMap.Location loc=iter.next();
      assert loc.isDefined();
    }
  }
  finally {
    map.free();
  }
}
