/** 
 * Push Notifications Remote Disabling Provider class.
 * @see <a href="http://xmpp.org/extensions/xep-0357.html">XEP-0357: Push
 *      Notifications</a>
 * @author Fernando Ramirez
 */
public class RemoteDisablingProvider extends ExtensionElementProvider<RemoteDisablingExtension> {
  @Override public RemoteDisablingExtension parse(  XmlPullParser parser,  int initialDepth,  XmlEnvironment xmlEnvironment) throws XmlPullParserException, IOException {
    Jid userJid=null;
    String node=parser.getAttributeValue("","node");
    outerloop:     while (true) {
      XmlPullParser.Event eventType=parser.next();
      if (eventType == XmlPullParser.Event.START_ELEMENT) {
        if (parser.getName().equals("affiliation")) {
          userJid=JidCreate.from(parser.getAttributeValue("","jid"));
          String affiliation=parser.getAttributeValue("","affiliation");
          if (affiliation == null || !affiliation.equals("none")) {
            throw new IOException("Invalid affiliation: " + affiliation);
          }
        }
      }
 else       if (eventType == XmlPullParser.Event.END_ELEMENT) {
        if (parser.getDepth() == initialDepth) {
          break outerloop;
        }
      }
    }
    return new RemoteDisablingExtension(node,userJid);
  }
}
