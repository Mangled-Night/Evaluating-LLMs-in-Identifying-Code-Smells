private PhysicalDBPool getPhysicalDBPool(DataHostConfig conf,ConfigLoader configLoader){
  String name=conf.getName();
  String dbType=conf.getDbType();
  String dbDriver=conf.getDbDriver();
  PhysicalDatasource[] writeSources=createDataSource(conf,name,dbType,dbDriver,conf.getWriteHosts(),false);
  Map<Integer,DBHostConfig[]> readHostsMap=conf.getReadHosts();
  Map<Integer,PhysicalDatasource[]> readSourcesMap=new HashMap<Integer,PhysicalDatasource[]>(readHostsMap.size());
  for (  Map.Entry<Integer,DBHostConfig[]> entry : readHostsMap.entrySet()) {
    PhysicalDatasource[] readSources=createDataSource(conf,name,dbType,dbDriver,entry.getValue(),true);
    readSourcesMap.put(entry.getKey(),readSources);
  }
  PhysicalDBPool pool=new PhysicalDBPool(conf.getName(),conf,writeSources,readSourcesMap,conf.getBalance(),conf.getWriteType());
  return pool;
}
