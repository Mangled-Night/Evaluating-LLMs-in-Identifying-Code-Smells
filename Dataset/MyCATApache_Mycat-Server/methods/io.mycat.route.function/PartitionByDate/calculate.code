@Override public Integer calculate(String columnValue){
  try {
    int targetPartition;
    if (bNaturalDay) {
      Calendar curTime=Calendar.getInstance();
      curTime.setTime(formatter.get().parse(columnValue));
      targetPartition=curTime.get(Calendar.DAY_OF_MONTH);
      return targetPartition - 1;
    }
    long targetTime=formatter.get().parse(columnValue).getTime();
    targetPartition=(int)((targetTime - beginDate) / partionTime);
    if (targetTime > endDate && nCount != 0) {
      targetPartition=targetPartition % nCount;
    }
    return targetPartition;
  }
 catch (  ParseException e) {
    throw new IllegalArgumentException(new StringBuilder().append("columnValue:").append(columnValue).append(" Please check if the format satisfied.").toString(),e);
  }
}
