private RouteResultset tryDirectRoute(String sql,String[] lineList){
  RouteResultset rrs=new RouteResultset(sql,ServerParse.INSERT);
  rrs.setLoadData(true);
  if (tableConfig == null && schema.getDataNode() != null) {
    RouteResultsetNode rrNode=new RouteResultsetNode(schema.getDataNode(),ServerParse.INSERT,sql);
    rrNode.setSource(rrs);
    rrs.setNodes(new RouteResultsetNode[]{rrNode});
    return rrs;
  }
 else   if (tableConfig != null && tableConfig.isGlobalTable()) {
    ArrayList<String> dataNodes=tableConfig.getDataNodes();
    RouteResultsetNode[] rrsNodes=new RouteResultsetNode[dataNodes.size()];
    for (int i=0, dataNodesSize=dataNodes.size(); i < dataNodesSize; i++) {
      String dataNode=dataNodes.get(i);
      RouteResultsetNode rrNode=new RouteResultsetNode(dataNode,ServerParse.INSERT,sql);
      rrsNodes[i]=rrNode;
      if (rrs.getDataNodeSlotMap().containsKey(dataNode)) {
        rrsNodes[i].setSlot(rrs.getDataNodeSlotMap().get(dataNode));
      }
      rrsNodes[i].setSource(rrs);
    }
    rrs.setNodes(rrsNodes);
    return rrs;
  }
 else   if (tableConfig != null) {
    DruidShardingParseInfo ctx=new DruidShardingParseInfo();
    ctx.addTable(tableName);
    if (partitionColumnIndex == -1 || partitionColumnIndex >= lineList.length) {
      return null;
    }
 else {
      String value=lineList[partitionColumnIndex];
      RouteCalculateUnit routeCalculateUnit=new RouteCalculateUnit();
      routeCalculateUnit.addShardingExpr(tableName,getPartitionColumn(),parseFieldString(value,loadData.getEnclose()));
      ctx.addRouteCalculateUnit(routeCalculateUnit);
      try {
        SortedSet<RouteResultsetNode> nodeSet=new TreeSet<RouteResultsetNode>();
        for (        RouteCalculateUnit unit : ctx.getRouteCalculateUnits()) {
          RouteResultset rrsTmp=RouterUtil.tryRouteForTables(schema,ctx,unit,rrs,false,tableId2DataNodeCache);
          if (rrsTmp != null) {
            for (            RouteResultsetNode node : rrsTmp.getNodes()) {
              nodeSet.add(node);
            }
          }
        }
        RouteResultsetNode[] nodes=new RouteResultsetNode[nodeSet.size()];
        int i=0;
        for (Iterator<RouteResultsetNode> iterator=nodeSet.iterator(); iterator.hasNext(); ) {
          nodes[i]=(RouteResultsetNode)iterator.next();
          i++;
        }
        rrs.setNodes(nodes);
        return rrs;
      }
 catch (      SQLNonTransientException e) {
        throw new RuntimeException(e);
      }
    }
  }
  return null;
}
