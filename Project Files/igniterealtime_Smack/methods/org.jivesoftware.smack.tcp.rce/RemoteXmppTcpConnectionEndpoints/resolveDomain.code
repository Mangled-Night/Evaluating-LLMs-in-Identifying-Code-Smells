/** 
 * @param domain the domain.
 * @param domainType the XMPP domain type, server or client.
 * @param lookupFailures a list that will be populated with all failures that oocured during lookup.
 * @param dnssecMode the DNSSEC mode.
 * @param dnsResolver the DNS resolver to use.
 * @return a list of resolved host addresses for this domain.
 */
private static List<Rfc6120TcpRemoteConnectionEndpoint> resolveDomain(DnsName domain,DomainType domainType,List<RemoteConnectionEndpointLookupFailure> lookupFailures,DnssecMode dnssecMode,DNSResolver dnsResolver){
  List<Rfc6120TcpRemoteConnectionEndpoint> endpoints=new ArrayList<>();
  DnsName srvDomain=DnsName.from(domainType.srvPrefix,domain);
  Collection<SRV> srvRecords=dnsResolver.lookupSrvRecords(srvDomain,lookupFailures,dnssecMode);
  if (srvRecords != null && !srvRecords.isEmpty()) {
    if (LOGGER.isLoggable(Level.FINE)) {
      String logMessage="Resolved SRV RR for " + srvDomain + ":";
      for (      SRV r : srvRecords)       logMessage+=" " + r;
      LOGGER.fine(logMessage);
    }
    List<SRV> sortedSrvRecords=SrvUtil.sortSrvRecords(srvRecords);
    for (    SRV srv : sortedSrvRecords) {
      List<InetAddress> targetInetAddresses=dnsResolver.lookupHostAddress(srv.target,lookupFailures,dnssecMode);
      if (targetInetAddresses != null) {
        SrvXmppRemoteConnectionEndpoint endpoint=new SrvXmppRemoteConnectionEndpoint(srv,targetInetAddresses);
        endpoints.add(endpoint);
      }
    }
  }
 else {
    LOGGER.info("Could not resolve DNS SRV resource records for " + srvDomain + ". Consider adding those.");
  }
  UInt16 defaultPort;
switch (domainType) {
case client:
    defaultPort=UInt16.from(5222);
  break;
case server:
defaultPort=UInt16.from(5269);
break;
default :
throw new AssertionError();
}
List<InetAddress> hostAddresses=dnsResolver.lookupHostAddress(domain,lookupFailures,dnssecMode);
if (hostAddresses != null) {
for (InetAddress inetAddress : hostAddresses) {
IpTcpRemoteConnectionEndpoint<InternetAddressRR<?>> endpoint=IpTcpRemoteConnectionEndpoint.from(domain,defaultPort,inetAddress);
endpoints.add(endpoint);
}
}
return endpoints;
}
