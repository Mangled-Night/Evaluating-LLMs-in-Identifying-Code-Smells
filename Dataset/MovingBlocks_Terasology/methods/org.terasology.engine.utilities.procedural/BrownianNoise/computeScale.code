private static float computeScale(float[] spectralWeights){
  float sum=0;
  for (  float weight : spectralWeights) {
    sum+=weight;
  }
  return 1.0f / sum;
}
