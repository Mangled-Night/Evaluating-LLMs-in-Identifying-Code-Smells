/** 
 * @author Mark Paluch
 */
class StringClusterReactiveCommandIntegrationTests extends StringCommandIntegrationTests {
  private final StatefulRedisClusterConnection<String,String> connection;
  private final RedisClusterCommands<String,String> redis;
  @Inject StringClusterReactiveCommandIntegrationTests(  StatefulRedisClusterConnection<String,String> connection){
    super(ReactiveSyncInvocationHandler.sync(connection));
    this.connection=connection;
    this.redis=connection.sync();
  }
  @Test void msetnx(){
    redis.set("one","1");
    Map<String,String> map=new LinkedHashMap<>();
    map.put("one","1");
    map.put("two","2");
    assertThat(redis.msetnx(map)).isFalse();
    redis.del("one");
    redis.del("two");
    assertThat(redis.msetnx(map)).isTrue();
    assertThat(redis.get("two")).isEqualTo("2");
  }
  @Test void mget(){
    redis.set(key,value);
    redis.set("key1",value);
    redis.set("key2",value);
    RedisAdvancedClusterReactiveCommands<String,String> reactive=connection.reactive();
    Flux<KeyValue<String,String>> mget=reactive.mget(key,"key1","key2");
    StepVerifier.create(mget.next()).expectNext(KeyValue.just(key,value)).verifyComplete();
  }
}
