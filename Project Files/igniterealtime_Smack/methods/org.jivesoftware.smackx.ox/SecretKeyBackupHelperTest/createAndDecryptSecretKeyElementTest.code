@Test public void createAndDecryptSecretKeyElementTest() throws PGPException, NoSuchAlgorithmException, InvalidAlgorithmParameterException, IOException, MissingUserIdOnKeyException, MissingOpenPgpKeyException, InvalidBackupCodeException {
  FileBasedOpenPgpStore store=new FileBasedOpenPgpStore(basePath);
  PainlessOpenPgpProvider provider=new PainlessOpenPgpProvider(store);
  PGPSecretKeyRing secretKeys=PGPainless.generateKeyRing().simpleEcKeyRing("xmpp:alice@wonderland.lit");
  BareJid jid=JidCreate.bareFrom("alice@wonderland.lit");
  provider.getStore().importSecretKey(jid,secretKeys);
  OpenPgpSecretKeyBackupPassphrase backupCode=SecretKeyBackupHelper.generateBackupPassword();
  SecretkeyElement element=SecretKeyBackupHelper.createSecretkeyElement(provider,jid,Collections.singleton(new OpenPgpV4Fingerprint(secretKeys)),backupCode);
  PGPSecretKeyRing secretKeyRing=SecretKeyBackupHelper.restoreSecretKeyBackup(element,backupCode);
  Assertions.assertArrayEquals(secretKeys.getEncoded(),secretKeyRing.getEncoded());
}
