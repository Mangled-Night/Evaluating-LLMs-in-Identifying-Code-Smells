/** 
 * The  {@code MergeBU} class provides static methods for sorting anarray using <em>bottom-up mergesort</em>. It is non-recursive. <p> This implementation takes &Theta;(<em>n</em> log <em>n</em>) time to sort any array of length <em>n</em> (assuming comparisons take constant time). It makes between ~ &frac12; <em>n</em> log<sub>2</sub> <em>n</em> and ~ 1 <em>n</em> log<sub>2</sub> <em>n</em> compares. <p> This sorting algorithm is stable. It uses &Theta;(<em>n</em>) extra memory (not including the input array). <p> For additional documentation, see <a href="https://algs4.cs.princeton.edu/21elementary">Section 2.1</a> of <i>Algorithms, 4th Edition</i> by Robert Sedgewick and Kevin Wayne.
 * @author Robert Sedgewick
 * @author Kevin Wayne
 */
public class MergeBU {
  private MergeBU(){
  }
  private static void merge(  Comparable[] a,  Comparable[] aux,  int lo,  int mid,  int hi){
    for (int k=lo; k <= hi; k++) {
      aux[k]=a[k];
    }
    int i=lo, j=mid + 1;
    for (int k=lo; k <= hi; k++) {
      if (i > mid)       a[k]=aux[j++];
 else       if (j > hi)       a[k]=aux[i++];
 else       if (less(aux[j],aux[i]))       a[k]=aux[j++];
 else       a[k]=aux[i++];
    }
  }
  /** 
 * Rearranges the array in ascending order, using the natural order.
 * @param a the array to be sorted
 */
  public static void sort(  Comparable[] a){
    int n=a.length;
    Comparable[] aux=new Comparable[n];
    for (int len=1; len < n; len*=2) {
      for (int lo=0; lo < n - len; lo+=len + len) {
        int mid=lo + len - 1;
        int hi=Math.min(lo + len + len - 1,n - 1);
        merge(a,aux,lo,mid,hi);
      }
    }
    assert isSorted(a);
  }
  /** 
 * Helper sorting functions.
 */
  private static boolean less(  Comparable v,  Comparable w){
    return v.compareTo(w) < 0;
  }
  /** 
 * Check if array is sorted - useful for debugging.
 */
  private static boolean isSorted(  Comparable[] a){
    for (int i=1; i < a.length; i++)     if (less(a[i],a[i - 1]))     return false;
    return true;
  }
  private static void show(  Comparable[] a){
    for (int i=0; i < a.length; i++) {
      StdOut.println(a[i]);
    }
  }
  /** 
 * Reads in a sequence of strings from standard input; bottom-up mergesorts them; and prints them to standard output in ascending order.
 * @param args the command-line arguments
 */
  public static void main(  String[] args){
    String[] a=StdIn.readAllStrings();
    MergeBU.sort(a);
    show(a);
  }
}
