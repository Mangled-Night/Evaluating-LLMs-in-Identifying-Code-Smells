public class PartitionByMonthTest {
  @Test public void test(){
    PartitionByMonth partition=new PartitionByMonth();
    partition.setDateFormat("yyyy-MM-dd");
    partition.setsBeginDate("2014-01-01");
    partition.init();
    Assert.assertEquals(true,0 == partition.calculate("2014-01-01"));
    Assert.assertEquals(true,0 == partition.calculate("2014-01-10"));
    Assert.assertEquals(true,0 == partition.calculate("2014-01-31"));
    Assert.assertEquals(true,1 == partition.calculate("2014-02-01"));
    Assert.assertEquals(true,1 == partition.calculate("2014-02-28"));
    Assert.assertEquals(true,2 == partition.calculate("2014-03-1"));
    Assert.assertEquals(true,11 == partition.calculate("2014-12-31"));
    Assert.assertEquals(true,12 == partition.calculate("2015-01-31"));
    Assert.assertEquals(true,23 == partition.calculate("2015-12-31"));
    partition.setDateFormat("yyyy-MM-dd");
    partition.setsBeginDate("2015-01-01");
    partition.setsEndDate("2015-12-01");
    partition.init();
    Assert.assertEquals(true,0 == partition.calculate("2013-01-02"));
    Assert.assertEquals(true,0 == partition.calculate("2014-01-01"));
    Assert.assertEquals(true,0 == partition.calculate("2015-01-10"));
    Assert.assertEquals(true,0 == partition.calculate("2015-01-31"));
    Assert.assertEquals(true,0 == partition.calculate("2016-01-20"));
    Assert.assertEquals(true,1 == partition.calculate("2013-02-02"));
    Assert.assertEquals(true,1 == partition.calculate("2014-02-01"));
    Assert.assertEquals(true,1 == partition.calculate("2015-02-10"));
    Assert.assertEquals(true,1 == partition.calculate("2015-02-28"));
    Assert.assertEquals(true,1 == partition.calculate("2016-02-20"));
    Assert.assertEquals(true,5 == partition.calculate("2013-06-01"));
    Assert.assertEquals(true,5 == partition.calculate("2014-06-01"));
    Assert.assertEquals(true,5 == partition.calculate("2015-06-10"));
    Assert.assertEquals(true,5 == partition.calculate("2015-06-28"));
    Assert.assertEquals(true,5 == partition.calculate("2016-06-20"));
    Assert.assertEquals(true,11 == partition.calculate("2013-12-28"));
    Assert.assertEquals(true,11 == partition.calculate("2014-12-01"));
    Assert.assertEquals(true,11 == partition.calculate("2014-12-31"));
    Assert.assertEquals(true,11 == partition.calculate("2015-12-11"));
    Assert.assertEquals(true,11 == partition.calculate("2016-12-31"));
  }
  /** 
 * 范围对比
 */
  @Test public void sence1CalculateRangeContrastTest(){
    PartitionByMonth partition=new PartitionByMonth();
    partition.setDateFormat("yyyy-MM-dd");
    partition.setsBeginDate("2013-01-01");
    partition.setsEndDate("2013-12-01");
    partition.init();
    PartitionByMonth scene=new PartitionByMonth();
    scene.setDateFormat("yyyy-MM-dd");
    scene.init();
    Assert.assertEquals(Arrays.toString(partition.calculateRange("2014-01-01","2014-04-03")),Arrays.toString(scene.calculateRange("2014-01-01","2014-04-03")));
    Assert.assertEquals(Arrays.toString(partition.calculateRange("2013-01-01","2014-04-03")),Arrays.toString(scene.calculateRange("2013-01-01","2014-04-03")));
    Assert.assertEquals(Arrays.toString(partition.calculateRange("2015-01-01","2014-04-03")),Arrays.toString(scene.calculateRange("2015-01-01","2014-04-03")));
  }
  @Test public void sence1(){
    PartitionByMonth scene=new PartitionByMonth();
    scene.setDateFormat("yyyy-MM-dd");
    scene.init();
    Assert.assertEquals(true,0 == scene.calculate("2014-01-01"));
    Assert.assertEquals(true,0 == scene.calculate("2014-01-10"));
    Assert.assertEquals(true,0 == scene.calculate("2014-01-31"));
    Assert.assertEquals(true,1 == scene.calculate("2014-02-01"));
    Assert.assertEquals(true,1 == scene.calculate("2014-02-28"));
    Assert.assertEquals(true,2 == scene.calculate("2014-03-1"));
    Assert.assertEquals(true,11 == scene.calculate("2014-12-31"));
    Assert.assertEquals(true,0 == scene.calculate("2015-01-31"));
    Assert.assertEquals(true,11 == scene.calculate("2015-12-31"));
  }
}
