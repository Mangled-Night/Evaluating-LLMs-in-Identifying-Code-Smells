private void predict(Particle a,double limit){
  if (a == null)   return;
  for (int i=0; i < particles.length; i++) {
    double dt=a.timeToHit(particles[i]);
    if (t + dt <= limit)     pq.insert(new Event(t + dt,a,particles[i]));
  }
  double dtX=a.timeToHitVerticalWall();
  double dtY=a.timeToHitHorizontalWall();
  if (t + dtX <= limit)   pq.insert(new Event(t + dtX,a,null));
  if (t + dtY <= limit)   pq.insert(new Event(t + dtY,null,a));
}
