/** 
 * Create an OmemoMessage.
 * @param managerGuard initialized OmemoManager
 * @param contactsDevices set of recipient devices
 * @param message message we want to send
 * @return encrypted OmemoMessage
 * @throws InterruptedException if the calling thread was interrupted.
 * @throws UndecidedOmemoIdentityException if the list of recipient devices contains an undecided device.
 * @throws CryptoFailedException if we are lacking some cryptographic algorithms
 * @throws SmackException.NotConnectedException if the XMPP connection is not connected.
 * @throws SmackException.NoResponseException if there was no response from the remote entity.
 * @throws IOException if an I/O error occurred.
 */
OmemoMessage.Sent createOmemoMessage(OmemoManager.LoggedInOmemoManager managerGuard,Set<OmemoDevice> contactsDevices,String message) throws InterruptedException, UndecidedOmemoIdentityException, CryptoFailedException, SmackException.NotConnectedException, SmackException.NoResponseException, IOException {
  byte[] key, iv;
  iv=OmemoMessageBuilder.generateIv();
  try {
    key=OmemoMessageBuilder.generateKey(KEYTYPE,KEYLENGTH);
  }
 catch (  NoSuchAlgorithmException e) {
    throw new CryptoFailedException(e);
  }
  return encrypt(managerGuard,contactsDevices,key,iv,message);
}
