/** 
 * 功能详细描述
 * @author sohudo[http://blog.csdn.net/wind520]
 * @create 2014年12月19日 下午6:50:23 
 * @version 0.0.1
 */
public class MongoStatement implements Statement {
  private MongoConnection _conn;
  private final int _type;
  private final int _concurrency;
  private final int _holdability;
  private int _fetchSize=0;
  private MongoResultSet _last;
  public MongoStatement(  MongoConnection conn,  int type,  int concurrency,  int holdability){
    this._conn=conn;
    this._type=type;
    this._concurrency=concurrency;
    this._holdability=holdability;
    if (this._type != 0) {
      throw new UnsupportedOperationException("type not supported yet");
    }
    if (this._concurrency != 0) {
      throw new UnsupportedOperationException("concurrency not supported yet");
    }
    if (this._holdability != 0) {
      throw new UnsupportedOperationException("holdability not supported yet");
    }
  }
  @Override public <T>T unwrap(  Class<T> iface) throws SQLException {
    throw new UnsupportedOperationException();
  }
  @Override public boolean isWrapperFor(  Class<?> iface) throws SQLException {
    return false;
  }
  @Override public ResultSet executeQuery(  String sql) throws SQLException {
    MongoData mongo=new MongoSQLParser(this._conn.getDB(),sql).query();
    if ((this._fetchSize > 0) && (mongo.getCursor() != null)) {
      mongo.getCursor().batchSize(this._fetchSize);
    }
    this._last=new MongoResultSet(mongo,this._conn.getSchema());
    return this._last;
  }
  @Override public int executeUpdate(  String sql) throws SQLException {
    return new MongoSQLParser(this._conn.getDB(),sql).executeUpdate();
  }
  @Override public void close() throws SQLException {
    this._conn=null;
  }
  @Override public int getMaxFieldSize() throws SQLException {
    return 0;
  }
  @Override public void setMaxFieldSize(  int max) throws SQLException {
  }
  @Override public int getMaxRows() throws SQLException {
    return 0;
  }
  @Override public void setMaxRows(  int max) throws SQLException {
  }
  @Override public void setEscapeProcessing(  boolean enable) throws SQLException {
  }
  @Override public int getQueryTimeout() throws SQLException {
    return 0;
  }
  @Override public void setQueryTimeout(  int seconds) throws SQLException {
  }
  @Override public void cancel() throws SQLException {
  }
  @Override public SQLWarning getWarnings() throws SQLException {
    return null;
  }
  @Override public void clearWarnings() throws SQLException {
  }
  @Override public void setCursorName(  String name) throws SQLException {
  }
  @Override public boolean execute(  String sql) throws SQLException {
    return false;
  }
  @Override public ResultSet getResultSet() throws SQLException {
    return this._last;
  }
  @Override public int getUpdateCount() throws SQLException {
    return 0;
  }
  @Override public boolean getMoreResults() throws SQLException {
    return false;
  }
  @Override public void setFetchDirection(  int direction) throws SQLException {
  }
  @Override public int getFetchDirection() throws SQLException {
    return 0;
  }
  @Override public void setFetchSize(  int rows) throws SQLException {
    this._fetchSize=rows;
  }
  @Override public int getFetchSize() throws SQLException {
    return this._fetchSize;
  }
  @Override public int getResultSetConcurrency() throws SQLException {
    return 0;
  }
  @Override public int getResultSetType() throws SQLException {
    return 0;
  }
  @Override public void addBatch(  String sql) throws SQLException {
    throw new UnsupportedOperationException("batch not supported");
  }
  @Override public void clearBatch() throws SQLException {
    throw new UnsupportedOperationException();
  }
  @Override public int[] executeBatch() throws SQLException {
    throw new UnsupportedOperationException();
  }
  @Override public Connection getConnection() throws SQLException {
    return this._conn;
  }
  @Override public boolean getMoreResults(  int current) throws SQLException {
    return false;
  }
  @Override public ResultSet getGeneratedKeys() throws SQLException {
    return null;
  }
  @Override public int executeUpdate(  String sql,  int autoGeneratedKeys) throws SQLException {
    return executeUpdate(sql);
  }
  @Override public int executeUpdate(  String sql,  int[] columnIndexes) throws SQLException {
    throw new UnsupportedOperationException();
  }
  @Override public int executeUpdate(  String sql,  String[] columnNames) throws SQLException {
    throw new UnsupportedOperationException();
  }
  @Override public boolean execute(  String sql,  int autoGeneratedKeys) throws SQLException {
    throw new UnsupportedOperationException();
  }
  @Override public boolean execute(  String sql,  int[] columnIndexes) throws SQLException {
    throw new UnsupportedOperationException();
  }
  @Override public boolean execute(  String sql,  String[] columnNames) throws SQLException {
    throw new UnsupportedOperationException();
  }
  @Override public int getResultSetHoldability() throws SQLException {
    return 0;
  }
  @Override public boolean isClosed() throws SQLException {
    return this._conn == null;
  }
  @Override public void setPoolable(  boolean poolable) throws SQLException {
  }
  @Override public boolean isPoolable() throws SQLException {
    return false;
  }
  @Override public void closeOnCompletion() throws SQLException {
  }
  @Override public boolean isCloseOnCompletion() throws SQLException {
    return false;
  }
}
