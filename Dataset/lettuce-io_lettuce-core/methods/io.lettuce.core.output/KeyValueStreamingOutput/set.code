@Override public void set(ByteBuffer bytes){
  if (keys == null) {
    if (key == null) {
      key=codec.decodeKey(bytes);
      return;
    }
  }
 else {
    if (keyIterator == null) {
      keyIterator=keys.iterator();
    }
    key=keyIterator.next();
  }
  V value=(bytes == null) ? null : codec.decodeValue(bytes);
  channel.onKeyValue(key,value);
  output=output.longValue() + 1;
  key=null;
}
