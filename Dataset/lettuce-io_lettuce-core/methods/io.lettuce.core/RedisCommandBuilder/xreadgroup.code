public Command<K,V,List<StreamMessage<K,V>>> xreadgroup(Consumer<K> consumer,XReadArgs xReadArgs,StreamOffset<K>... streams){
  LettuceAssert.notNull(streams,"Streams " + MUST_NOT_BE_NULL);
  LettuceAssert.isTrue(streams.length > 0,"Streams " + MUST_NOT_BE_EMPTY);
  LettuceAssert.notNull(consumer,"Consumer " + MUST_NOT_BE_NULL);
  CommandArgs<K,V> args=new CommandArgs<>(codec);
  args.add("GROUP").add(encode(consumer.group)).add(encode(consumer.name));
  if (xReadArgs != null) {
    xReadArgs.build(args);
  }
  args.add("STREAMS");
  for (  StreamOffset<K> stream : streams) {
    args.addKey(stream.name);
  }
  for (  XReadArgs.StreamOffset<K> stream : streams) {
    args.add(stream.offset);
  }
  return createCommand(XREADGROUP,new StreamReadOutput<>(codec),args);
}
