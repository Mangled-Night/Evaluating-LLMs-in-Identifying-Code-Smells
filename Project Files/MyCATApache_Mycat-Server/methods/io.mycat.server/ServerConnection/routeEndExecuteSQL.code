public void routeEndExecuteSQL(String sql,final int type,final SchemaConfig schema){
  RouteResultset rrs=null;
  try {
    rrs=MycatServer.getInstance().getRouterservice().route(MycatServer.getInstance().getConfig().getSystem(),schema,type,sql,this.charset,this);
  }
 catch (  Exception e) {
    StringBuilder s=new StringBuilder();
    LOGGER.warn(s.append(this).append(sql).toString() + " err:" + e.toString(),e);
    String msg=e.getMessage();
    writeErrMessage(ErrorCode.ER_PARSE_ERROR,msg == null ? e.getClass().getSimpleName() : msg);
    return;
  }
  if (rrs != null) {
    boolean executeNow=false;
synchronized (this.executeSqlQueue) {
      executeNow=this.executeSqlQueue.isEmpty();
      this.executeSqlQueue.add(new SqlEntry(sql,type,rrs));
      if (LOGGER.isDebugEnabled()) {
        LOGGER.debug("add queue,executeSqlQueue size {}",executeSqlQueue.size());
      }
    }
    if (executeNow) {
      this.executeSqlId++;
      session.execute(rrs,rrs.isSelectForUpdate() ? ServerParse.UPDATE : type);
    }
  }
}
