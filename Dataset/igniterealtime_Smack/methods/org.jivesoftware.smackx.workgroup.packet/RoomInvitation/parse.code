@Override public RoomInvitation parse(XmlPullParser parser,int initialDepth,XmlEnvironment xmlEnvironment) throws XmlPullParserException, IOException {
  final RoomInvitation invitation=new RoomInvitation();
  invitation.type=Type.valueOf(parser.getAttributeValue("","type"));
  outerloop:   while (true) {
    parser.next();
    if (parser.getEventType() == XmlPullParser.Event.START_ELEMENT) {
      String elementName=parser.getName();
      if ("session".equals(elementName)) {
        invitation.sessionID=parser.getAttributeValue("","id");
      }
 else       if ("invitee".equals(elementName)) {
        String inviteeString=parser.nextText();
        invitation.invitee=JidCreate.from(inviteeString);
      }
 else       if ("inviter".equals(elementName)) {
        String inviterString=parser.nextText();
        invitation.inviter=JidCreate.entityFrom(inviterString);
      }
 else       if ("reason".equals(elementName)) {
        invitation.reason=parser.nextText();
      }
 else       if ("room".equals(elementName)) {
        String roomString=parser.nextText();
        invitation.room=JidCreate.entityBareFrom(roomString);
      }
    }
 else     if (parser.getEventType() == XmlPullParser.Event.END_ELEMENT && parser.getDepth() == initialDepth) {
      break outerloop;
    }
  }
  return invitation;
}
