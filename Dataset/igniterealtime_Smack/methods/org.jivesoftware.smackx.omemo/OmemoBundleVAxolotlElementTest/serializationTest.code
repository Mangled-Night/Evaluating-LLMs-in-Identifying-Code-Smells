@Test public void serializationTest() throws Exception {
  int signedPreKeyId=420;
  String signedPreKeyB64=Base64.encodeToString("SignedPreKey".getBytes(StandardCharsets.UTF_8));
  String signedPreKeySigB64=Base64.encodeToString("SignedPreKeySignature".getBytes(StandardCharsets.UTF_8));
  String identityKeyB64=Base64.encodeToString("IdentityKey".getBytes(StandardCharsets.UTF_8));
  int preKeyId1=220, preKeyId2=284;
  String preKey1B64=Base64.encodeToString("FirstPreKey".getBytes(StandardCharsets.UTF_8)), preKey2B64=Base64.encodeToString("SecondPreKey".getBytes(StandardCharsets.UTF_8));
  HashMap<Integer,String> preKeysB64=new HashMap<>();
  preKeysB64.put(preKeyId1,preKey1B64);
  preKeysB64.put(preKeyId2,preKey2B64);
  OmemoBundleElement_VAxolotl bundle=new OmemoBundleElement_VAxolotl(signedPreKeyId,signedPreKeyB64,signedPreKeySigB64,identityKeyB64,preKeysB64);
  assertEquals("ElementName must match.","bundle",bundle.getElementName());
  assertEquals("Namespace must match.","eu.siacs.conversations.axolotl",bundle.getNamespace());
  String expected="<bundle xmlns='eu.siacs.conversations.axolotl'>" + "<signedPreKeyPublic signedPreKeyId='420'>" + signedPreKeyB64 + "</signedPreKeyPublic>"+ "<signedPreKeySignature>"+ signedPreKeySigB64+ "</signedPreKeySignature>"+ "<identityKey>"+ identityKeyB64+ "</identityKey>"+ "<prekeys>"+ "<preKeyPublic preKeyId='220'>"+ preKey1B64+ "</preKeyPublic>"+ "<preKeyPublic preKeyId='284'>"+ preKey2B64+ "</preKeyPublic>"+ "</prekeys>"+ "</bundle>";
  String actual=bundle.toXML().toString();
  assertEquals("Bundles XML must match.",expected,actual);
  byte[] signedPreKey="SignedPreKey".getBytes(StandardCharsets.UTF_8);
  byte[] signedPreKeySig="SignedPreKeySignature".getBytes(StandardCharsets.UTF_8);
  byte[] identityKey="IdentityKey".getBytes(StandardCharsets.UTF_8);
  byte[] firstPreKey="FirstPreKey".getBytes(StandardCharsets.UTF_8);
  byte[] secondPreKey="SecondPreKey".getBytes(StandardCharsets.UTF_8);
  OmemoBundleElement_VAxolotl parsed=new OmemoBundleVAxolotlProvider().parse(TestUtils.getParser(actual));
  assertTrue("B64-decoded signedPreKey must match.",Arrays.equals(signedPreKey,parsed.getSignedPreKey()));
  assertEquals("SignedPreKeyId must match",signedPreKeyId,parsed.getSignedPreKeyId());
  assertTrue("B64-decoded signedPreKey signature must match.",Arrays.equals(signedPreKeySig,parsed.getSignedPreKeySignature()));
  assertTrue("B64-decoded identityKey must match.",Arrays.equals(identityKey,parsed.getIdentityKey()));
  assertTrue("B64-decoded first preKey must match.",Arrays.equals(firstPreKey,parsed.getPreKey(220)));
  assertTrue("B64-decoded second preKey must match.",Arrays.equals(secondPreKey,parsed.getPreKey(284)));
  assertEquals("toString outputs must match.",bundle.toString(),parsed.toString());
}
