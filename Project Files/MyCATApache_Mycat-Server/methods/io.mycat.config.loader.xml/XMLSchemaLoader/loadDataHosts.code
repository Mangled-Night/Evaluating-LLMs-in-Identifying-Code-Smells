private void loadDataHosts(Element root){
  NodeList list=root.getElementsByTagName("dataHost");
  for (int i=0, n=list.getLength(); i < n; ++i) {
    Element element=(Element)list.item(i);
    String name=element.getAttribute("name");
    if (dataHosts.containsKey(name)) {
      throw new ConfigException("dataHost name " + name + "duplicated!");
    }
    int maxCon=Integer.parseInt(element.getAttribute("maxCon"));
    int minCon=Integer.parseInt(element.getAttribute("minCon"));
    int balance=Integer.parseInt(element.getAttribute("balance"));
    String balanceTypeStr=element.getAttribute("balanceType");
    int balanceType=balanceTypeStr.equals("") ? 0 : Integer.parseInt(balanceTypeStr);
    String switchTypeStr=element.getAttribute("switchType");
    int switchType=switchTypeStr.equals("") ? -1 : Integer.parseInt(switchTypeStr);
    String slaveThresholdStr=element.getAttribute("slaveThreshold");
    int slaveThreshold=slaveThresholdStr.equals("") ? -1 : Integer.parseInt(slaveThresholdStr);
    String tempReadHostAvailableStr=element.getAttribute("tempReadHostAvailable");
    boolean tempReadHostAvailable=!tempReadHostAvailableStr.equals("") && Integer.parseInt(tempReadHostAvailableStr) > 0;
    String writeTypStr=element.getAttribute("writeType");
    int writeType="".equals(writeTypStr) ? PhysicalDBPool.WRITE_ONLYONE_NODE : Integer.parseInt(writeTypStr);
    String dbDriver=element.getAttribute("dbDriver");
    String dbType=element.getAttribute("dbType");
    String filters=element.getAttribute("filters");
    String logTimeStr=element.getAttribute("logTime");
    String slaveIDs=element.getAttribute("slaveIDs");
    String maxRetryCountStr=element.getAttribute("maxRetryCount");
    int maxRetryCount;
    if (StringUtil.isEmpty(maxRetryCountStr)) {
      maxRetryCount=3;
    }
 else {
      maxRetryCount=Integer.valueOf(maxRetryCountStr);
    }
    long logTime="".equals(logTimeStr) ? PhysicalDBPool.LONG_TIME : Long.parseLong(logTimeStr);
    String notSwitch=element.getAttribute("notSwitch");
    if (StringUtil.isEmpty(notSwitch)) {
      notSwitch=DataHostConfig.CAN_SWITCH_DS;
    }
    String heartbeatSQL=element.getElementsByTagName("heartbeat").item(0).getTextContent();
    NodeList connectionInitSqlList=element.getElementsByTagName("connectionInitSql");
    String initConSQL=null;
    if (connectionInitSqlList.getLength() > 0) {
      initConSQL=connectionInitSqlList.item(0).getTextContent();
    }
    NodeList writeNodes=element.getElementsByTagName("writeHost");
    DBHostConfig[] writeDbConfs=new DBHostConfig[writeNodes.getLength()];
    Map<Integer,DBHostConfig[]> readHostsMap=new HashMap<Integer,DBHostConfig[]>(2);
    Set<String> writeHostNameSet=new HashSet<String>(writeNodes.getLength());
    for (int w=0; w < writeDbConfs.length; w++) {
      Element writeNode=(Element)writeNodes.item(w);
      writeDbConfs[w]=createDBHostConf(name,writeNode,dbType,dbDriver,maxCon,minCon,filters,logTime);
      if (writeHostNameSet.contains(writeDbConfs[w].getHostName())) {
        throw new ConfigException("writeHost " + writeDbConfs[w].getHostName() + " duplicated!");
      }
 else {
        writeHostNameSet.add(writeDbConfs[w].getHostName());
      }
      NodeList readNodes=writeNode.getElementsByTagName("readHost");
      if (readNodes.getLength() != 0) {
        DBHostConfig[] readDbConfs=new DBHostConfig[readNodes.getLength()];
        Set<String> readHostNameSet=new HashSet<String>(readNodes.getLength());
        for (int r=0; r < readDbConfs.length; r++) {
          Element readNode=(Element)readNodes.item(r);
          readDbConfs[r]=createDBHostConf(name,readNode,dbType,dbDriver,maxCon,minCon,filters,logTime);
          if (readHostNameSet.contains(readDbConfs[r].getHostName())) {
            throw new ConfigException("readHost " + readDbConfs[r].getHostName() + " duplicated!");
          }
 else {
            readHostNameSet.add(readDbConfs[r].getHostName());
          }
        }
        readHostsMap.put(w,readDbConfs);
      }
    }
    DataHostConfig hostConf=new DataHostConfig(name,dbType,dbDriver,writeDbConfs,readHostsMap,switchType,slaveThreshold,tempReadHostAvailable);
    hostConf.setMaxCon(maxCon);
    hostConf.setMinCon(minCon);
    hostConf.setBalance(balance);
    hostConf.setBalanceType(balanceType);
    hostConf.setWriteType(writeType);
    hostConf.setHearbeatSQL(heartbeatSQL);
    hostConf.setConnectionInitSql(initConSQL);
    hostConf.setFilters(filters);
    hostConf.setLogTime(logTime);
    hostConf.setSlaveIDs(slaveIDs);
    hostConf.setNotSwitch(notSwitch);
    hostConf.setMaxRetryCount(maxRetryCount);
    dataHosts.put(hostConf.getName(),hostConf);
  }
}
