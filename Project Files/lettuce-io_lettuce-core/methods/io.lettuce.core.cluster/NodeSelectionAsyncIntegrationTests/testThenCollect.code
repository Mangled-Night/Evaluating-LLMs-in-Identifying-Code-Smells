@Test void testThenCollect(){
  List<String> expectation=new ArrayList<>();
  for (char c='a'; c < 'z'; c++) {
    String key=new String(new char[]{c,c,c});
    expectation.add(key);
    TestFutures.awaitOrTimeout(commands.set(key,value));
  }
  Collector<List<String>,List<String>,List<String>> collector=Collector.of(ArrayList::new,List::addAll,(a,b) -> a,it -> it);
  CompletableFuture<List<String>> future=commands.masters().commands().keys("*").thenCollect(collector).toCompletableFuture();
  TestFutures.awaitOrTimeout(future);
  List<String> result=future.join();
  assertThat(result).hasSize(expectation.size());
  Collections.sort(expectation);
  Collections.sort(result);
  assertThat(result).isEqualTo(expectation);
}
