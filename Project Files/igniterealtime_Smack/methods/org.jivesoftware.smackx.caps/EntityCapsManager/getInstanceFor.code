public static synchronized EntityCapsManager getInstanceFor(XMPPConnection connection){
  if (SUPPORTED_HASHES.size() <= 0)   throw new IllegalStateException("No supported hashes for EntityCapsManager");
  EntityCapsManager entityCapsManager=instances.get(connection);
  if (entityCapsManager == null) {
    entityCapsManager=new EntityCapsManager(connection);
  }
  return entityCapsManager;
}
