private Node balance(Node h){
  if (isRed(h.right) && !isRed(h.left))   h=rotateLeft(h);
  if (isRed(h.left) && isRed(h.left.left))   h=rotateRight(h);
  if (isRed(h.left) && isRed(h.right))   flipColors(h);
  h.size=size(h.left) + size(h.right) + 1;
  return h;
}
