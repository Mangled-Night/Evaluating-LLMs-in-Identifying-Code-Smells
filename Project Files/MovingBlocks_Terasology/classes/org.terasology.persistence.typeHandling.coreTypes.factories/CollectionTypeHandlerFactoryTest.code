public class CollectionTypeHandlerFactoryTest {
  private final TypeHandlerLibrary typeHandlerLibrary=mock(TypeHandlerLibrary.class);
  private final CollectionTypeHandlerFactory typeHandlerFactory=new CollectionTypeHandlerFactory(new ConstructorLibrary(Maps.newHashMap()));
  private final TypeHandlerContext context=new TypeHandlerContext(typeHandlerLibrary,mock(SerializationSandbox.class));
  @Test public void testList(){
    TypeInfo<List<Integer>> listTypeInfo=new TypeInfo<List<Integer>>(){
    }
;
    Optional<TypeHandler<List<Integer>>> typeHandler=typeHandlerFactory.create(listTypeInfo,context);
    assertTrue(typeHandler.isPresent());
    assertTrue(typeHandler.get() instanceof CollectionTypeHandler);
    verify(typeHandlerLibrary).getTypeHandler(eq(TypeInfo.of(Integer.class).getType()));
  }
  @Test public void testSet(){
    TypeInfo<Set<Integer>> listTypeInfo=new TypeInfo<Set<Integer>>(){
    }
;
    Optional<TypeHandler<Set<Integer>>> typeHandler=typeHandlerFactory.create(listTypeInfo,context);
    assertTrue(typeHandler.isPresent());
    assertTrue(typeHandler.get() instanceof CollectionTypeHandler);
    verify(typeHandlerLibrary).getTypeHandler(eq(TypeInfo.of(Integer.class).getType()));
  }
  @Test public void testQueue(){
    TypeInfo<Queue<Integer>> listTypeInfo=new TypeInfo<Queue<Integer>>(){
    }
;
    Optional<TypeHandler<Queue<Integer>>> typeHandler=typeHandlerFactory.create(listTypeInfo,context);
    assertTrue(typeHandler.isPresent());
    assertTrue(typeHandler.get() instanceof CollectionTypeHandler);
    verify(typeHandlerLibrary).getTypeHandler(eq(TypeInfo.of(Integer.class).getType()));
  }
  @Test public void testNonGenericCollection(){
class IntList extends ArrayList<Integer> {
    }
    Optional<TypeHandler<IntList>> typeHandler=typeHandlerFactory.create(TypeInfo.of(IntList.class),context);
    assertTrue(typeHandler.isPresent());
    assertTrue(typeHandler.get() instanceof CollectionTypeHandler);
    verify(typeHandlerLibrary).getTypeHandler(eq(TypeInfo.of(Integer.class).getType()));
  }
}
