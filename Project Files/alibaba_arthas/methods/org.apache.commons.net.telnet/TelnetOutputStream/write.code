/** 
 * Writes a byte to the stream. <p>
 * @param ch The byte to write.
 * @exception IOException If an error occurs while writing to the underlyingstream.
 */
@Override public void write(int ch) throws IOException {
synchronized (__client) {
    ch&=0xff;
    if (__client._requestedWont(TelnetOption.BINARY)) {
      if (__lastWasCR) {
        if (__convertCRtoCRLF) {
          __client._sendByte('\n');
          if (ch == '\n') {
            __lastWasCR=false;
            return;
          }
        }
 else         if (ch != '\n') {
          __client._sendByte('\0');
        }
      }
switch (ch) {
case '\r':
        __client._sendByte('\r');
      __lastWasCR=true;
    break;
case '\n':
  if (!__lastWasCR) {
    __client._sendByte('\r');
  }
__client._sendByte(ch);
__lastWasCR=false;
break;
case TelnetCommand.IAC:
__client._sendByte(TelnetCommand.IAC);
__client._sendByte(TelnetCommand.IAC);
__lastWasCR=false;
break;
default :
__client._sendByte(ch);
__lastWasCR=false;
break;
}
}
 else if (ch == TelnetCommand.IAC) {
__client._sendByte(ch);
__client._sendByte(TelnetCommand.IAC);
}
 else {
__client._sendByte(ch);
}
}
}
/** 
 * Writes a byte array to the stream. <p>
 * @param buffer  The byte array to write.
 * @exception IOException If an error occurs while writing to the underlyingstream.
 */
@Override public void write(byte buffer[]) throws IOException {
  write(buffer,0,buffer.length);
}
/** 
 * Writes a number of bytes from a byte array to the stream starting from a given offset. <p>
 * @param buffer  The byte array to write.
 * @param offset  The offset into the array at which to start copying data.
 * @param length  The number of bytes to write.
 * @exception IOException If an error occurs while writing to the underlyingstream.
 */
@Override public void write(byte buffer[],int offset,int length) throws IOException {
synchronized (__client) {
    while (length-- > 0) {
      write(buffer[offset++]);
    }
  }
}
