public void run(){
  try {
    SystemConfig sysconfig=MycatServer.getInstance().getConfig().getSystem();
    String sqlInterceptorType=sysconfig.getSqlInterceptorType();
    String sqlInterceptorFile=sysconfig.getSqlInterceptorFile();
    String[] sqlInterceptorTypes=sqlInterceptorType.split(",");
    for (    String type : sqlInterceptorTypes) {
      if (StatisticsSqlInterceptor.parseType(type.toUpperCase()) == sqltype) {
switch (sqltype) {
case ServerParse.SELECT:
          StatisticsSqlInterceptor.appendFile(sqlInterceptorFile,"SELECT:" + sqls + "");
        break;
case ServerParse.UPDATE:
      StatisticsSqlInterceptor.appendFile(sqlInterceptorFile,"UPDATE:" + sqls);
    break;
case ServerParse.INSERT:
  StatisticsSqlInterceptor.appendFile(sqlInterceptorFile,"INSERT:" + sqls);
break;
case ServerParse.DELETE:
StatisticsSqlInterceptor.appendFile(sqlInterceptorFile,"DELETE:" + sqls);
break;
default :
break;
}
}
}
}
 catch (Exception e) {
LOGGER.error("interceptSQL error:" + e.getMessage(),e);
}
}
