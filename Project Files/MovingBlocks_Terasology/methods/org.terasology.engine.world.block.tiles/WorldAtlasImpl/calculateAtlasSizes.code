private void calculateAtlasSizes(){
  tileSize=16;
  tiles.stream().filter(tile -> tile.getImage(0).getWidth() > tileSize).forEach(tile -> tileSize=tile.getImage(0).getWidth());
  atlasSize=1;
  while (atlasSize * atlasSize < numFrames) {
    atlasSize*=2;
  }
  atlasSize=atlasSize * tileSize;
  if (atlasSize > maxAtlasSize) {
    atlasSize=maxAtlasSize;
    int maxTiles=(atlasSize / tileSize) * (atlasSize / tileSize);
    while (maxTiles < numFrames) {
      tileSize>>=1;
      maxTiles=(atlasSize / tileSize) * (atlasSize / tileSize);
    }
  }
}
