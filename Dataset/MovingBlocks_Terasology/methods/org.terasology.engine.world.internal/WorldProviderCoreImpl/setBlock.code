@Override public Block setBlock(Vector3ic worldPos,Block type){
  Vector3i chunkPos=Chunks.toChunkPos(worldPos,new Vector3i());
  Chunk chunk=chunkProvider.getChunk(chunkPos);
  if (chunk != null) {
    Vector3i blockPos=Chunks.toRelative(worldPos,new Vector3i());
    Block oldBlockType=chunk.setBlock(blockPos,type);
    if (oldBlockType != type) {
      BlockChange oldChange=blockChanges.get(worldPos);
      if (oldChange == null) {
        blockChanges.put(new Vector3i(worldPos),new BlockChange(worldPos,oldBlockType,type));
      }
 else {
        oldChange.setTo(type);
      }
      setDirtyChunksNear(worldPos);
      notifyBlockChanged(worldPos,type,oldBlockType);
    }
    return oldBlockType;
  }
  return null;
}
