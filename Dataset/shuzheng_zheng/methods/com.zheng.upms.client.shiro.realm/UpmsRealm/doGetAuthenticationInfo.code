/** 
 * 认证：登录时调用
 * @param authenticationToken
 * @return
 * @throws AuthenticationException
 */
@Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException {
  String username=(String)authenticationToken.getPrincipal();
  String password=new String((char[])authenticationToken.getCredentials());
  String upmsType=PropertiesFileUtil.getInstance("zheng-upms-client").get("zheng.upms.type");
  if ("client".equals(upmsType)) {
    return new SimpleAuthenticationInfo(username,password,getName());
  }
  UpmsUser upmsUser=upmsApiService.selectUpmsUserByUsername(username);
  if (null == upmsUser) {
    throw new UnknownAccountException();
  }
  if (!upmsUser.getPassword().equals(MD5Util.md5(password + upmsUser.getSalt()))) {
    throw new IncorrectCredentialsException();
  }
  if (upmsUser.getLocked() == 1) {
    throw new LockedAccountException();
  }
  return new SimpleAuthenticationInfo(username,password,getName());
}
