@Override public void onQueryResult(QueryResult query){
switch (query.getSqlType()) {
case ServerParse.SELECT:
case ServerParse.UPDATE:
case ServerParse.INSERT:
case ServerParse.DELETE:
case ServerParse.REPLACE:
    String host=query.getHost();
  if (host == null) {
    host="";
  }
String schema=query.getSchema();
String user=query.getUser();
int sqlType=query.getSqlType();
String sql=query.getSql();
long sqlRows=query.getSqlRows();
long netInBytes=query.getNetInBytes();
long netOutBytes=query.getNetOutBytes();
long startTime=query.getStartTime();
long endTime=query.getEndTime();
int resultSetSize=query.getResultSize();
try {
UserStat userStat=userStatMap.get(user,new Callable<UserStat>(){
@Override public UserStat call() throws Exception {
return new UserStat(user);
}
}
);
userStat.update(schema,sqlType,sql,sqlRows,netInBytes,netOutBytes,startTime,endTime,resultSetSize,host);
}
 catch (ExecutionException e) {
LOGGER.error("new UserStat occurs error",e);
}
break;
}
}
