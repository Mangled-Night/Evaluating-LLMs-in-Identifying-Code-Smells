/** 
 * High level API test. This is a simple test to use with an XMPP client and check if the client receives the message 1. User_1 will send an invitation to user_2.
 */
public void testAcceptJingleSession(){
  resetCounter();
  try {
    FixedResolver tr0=new FixedResolver("127.0.0.1",54222);
    FixedTransportManager ftm0=new FixedTransportManager(tr0);
    TestMediaManager tmm0=new TestMediaManager(ftm0);
    tmm0.setPayloads(getTestPayloads1());
    List<JingleMediaManager> trl0=new ArrayList<JingleMediaManager>();
    trl0.add(tmm0);
    FixedResolver tr1=new FixedResolver("127.0.0.1",54567);
    FixedTransportManager ftm1=new FixedTransportManager(tr1);
    TestMediaManager tmm1=new TestMediaManager(ftm1);
    tmm1.setPayloads(getTestPayloads2());
    List<JingleMediaManager> trl1=new ArrayList<JingleMediaManager>();
    trl1.add(tmm1);
    JingleManager man0=new JingleManager(getConnection(0),trl0);
    JingleManager man1=new JingleManager(getConnection(1),trl1);
    man1.addJingleSessionRequestListener(new JingleSessionRequestListener(){
      /** 
 * Called when a new session request is detected
 */
      public void sessionRequested(      final JingleSessionRequest request){
        incCounter();
        System.out.println("Session request detected, from " + request.getFrom() + ": accepting.");
        try {
          JingleSession session1=request.accept();
          session1.startIncoming();
        }
 catch (        Exception e) {
          LOGGER.log(Level.WARNING,"exception",e);
        }
      }
    }
);
    System.out.println("Starting session request, to " + getFullJID(1) + "...");
    JingleSession session0=man0.createOutgoingJingleSession(getFullJID(1));
    session0.startOutgoing();
    Thread.sleep(20000);
    assertTrue(valCounter() > 0);
  }
 catch (  Exception e) {
    LOGGER.log(Level.WARNING,"exception",e);
    fail("An error occurred with Jingle");
  }
}
