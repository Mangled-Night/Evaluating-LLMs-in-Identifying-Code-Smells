/** 
 * Returns a 64-bit integer that can be used as the prefix used in sorting.
 */
public long getPrefix(){
  long p;
  long mask=0;
  if (isLittleEndian) {
    if (numBytes >= 8) {
      p=Platform.getLong(base,offset);
    }
 else     if (numBytes > 4) {
      p=Platform.getLong(base,offset);
      mask=(1L << (8 - numBytes) * 8) - 1;
    }
 else     if (numBytes > 0) {
      p=(long)Platform.getInt(base,offset);
      mask=(1L << (8 - numBytes) * 8) - 1;
    }
 else {
      p=0;
    }
    p=Long.reverseBytes(p);
  }
 else {
    if (numBytes >= 8) {
      p=Platform.getLong(base,offset);
    }
 else     if (numBytes > 4) {
      p=Platform.getLong(base,offset);
      mask=(1L << (8 - numBytes) * 8) - 1;
    }
 else     if (numBytes > 0) {
      p=((long)Platform.getInt(base,offset)) << 32;
      mask=(1L << (8 - numBytes) * 8) - 1;
    }
 else {
      p=0;
    }
  }
  p&=~mask;
  return p;
}
