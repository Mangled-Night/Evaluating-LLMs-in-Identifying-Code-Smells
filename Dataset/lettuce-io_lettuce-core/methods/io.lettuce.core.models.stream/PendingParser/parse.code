/** 
 * Parse the output of the Redis  {@literal XPENDING} reporting a summary on pending messages.
 * @param xpendingOutput output of the Redis {@literal XPENDING}.
 * @return {@link PendingMessages}.
 */
@SuppressWarnings("unchecked") public static PendingMessages parse(List<?> xpendingOutput){
  LettuceAssert.notNull(xpendingOutput,"XPENDING output must not be null");
  LettuceAssert.isTrue(xpendingOutput.size() == 4,"XPENDING output must have exactly four output elements");
  Long count=(Long)xpendingOutput.get(0);
  String from=(String)xpendingOutput.get(1);
  String to=(String)xpendingOutput.get(2);
  Range<String> messageIdRange=Range.create(from,to);
  Collection<Object> consumerMessageCounts=(Collection)xpendingOutput.get(3);
  Map<String,Long> counts=new LinkedHashMap<>();
  for (  Object element : consumerMessageCounts) {
    LettuceAssert.isTrue(element instanceof List,"Consumer message counts must be a List");
    List<Object> messageCount=(List)element;
    counts.put((String)messageCount.get(0),(Long)messageCount.get(1));
  }
  return new PendingMessages(count,messageIdRange,Collections.unmodifiableMap(counts));
}
