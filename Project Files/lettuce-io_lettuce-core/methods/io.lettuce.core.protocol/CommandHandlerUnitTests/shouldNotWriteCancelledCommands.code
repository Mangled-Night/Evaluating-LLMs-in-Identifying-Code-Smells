@Test void shouldNotWriteCancelledCommands() throws Exception {
  command.cancel();
  sut.write(context,Collections.singleton(command),promise);
  verifyNoInteractions(context);
  assertThat(stack).isEmpty();
  verify(promise).trySuccess();
}
