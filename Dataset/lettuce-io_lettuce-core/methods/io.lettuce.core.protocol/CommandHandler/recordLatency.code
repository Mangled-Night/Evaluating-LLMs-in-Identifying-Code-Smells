private void recordLatency(WithLatency withLatency,ProtocolKeyword commandType){
  if (withLatency != null && latencyMetricsEnabled && channel != null && remote() != null) {
    long firstResponseLatency=withLatency.getFirstResponse() - withLatency.getSent();
    long completionLatency=nanoTime() - withLatency.getSent();
    commandLatencyRecorder.recordCommandLatency(local(),remote(),commandType,firstResponseLatency,completionLatency);
  }
}
